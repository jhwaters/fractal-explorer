{"version":3,"sources":["store/ui/types.ts","fractals/formatting.ts","fractals/algorithm/types.ts","containers/Theme.tsx","components/Katex.tsx","components/TypographyWithMath.tsx","components/StyledSelect.tsx","components/CustomColor.tsx","components/DownUpButtons.tsx","components/NumberIncrementer.tsx","components/ComplexIncrementer.tsx","components/SettingsContainer.tsx","components/ColorPreview.tsx","components/ComplexNumberInput.tsx","containers/Settings/SettingsMenu.tsx","components/NumberInput.tsx","containers/Bottombar.tsx","containers/Settings/AlgorithmSettings.tsx","containers/Settings/ColorSettings.tsx","containers/Settings/ViewSettings.tsx","containers/Settings/JSONInterface.tsx","containers/Settings/index.ts","containers/Canvas/Canvas.tsx","containers/Canvas/index.ts","containers/Controls/ControlPanel.tsx","containers/Gallery/Gallery.tsx","containers/Capture/Capture.tsx","containers/Capture/index.ts","containers/Controls/Zoom.tsx","containers/Controls/ParamControls.tsx","containers/Controls/Iterator.tsx","containers/Controls/Controls.tsx","containers/Controls/index.ts","containers/Gallery/index.ts","containers/Display.tsx","containers/Controls/InfoButton.tsx","containers/Controls/Recenter.tsx","containers/TopBar.tsx","containers/Info.tsx","containers/Waiting.tsx","containers/App.tsx","containers/Root.tsx","serviceWorker.ts","index.tsx","console/drawer/abstract.ts","console/drawer/animation.ts","console/drawer/connected.ts","console/drawer/zip.ts","console/drawer/disconnected.ts","console/magic.js","console/console.ts","console/index.js","fractals/index.ts","store/fractal/types.ts","fractals/math/real.ts","fractals/json/index.ts","fractals/json/json2.ts","fractals/json/json1.ts","store/fractal/algorithm/actions.ts","store/fractal/color/actions.ts","store/fractal/view/actions.ts","store/fractal/actions.ts","fractals/math/complex.ts","defaults.ts","fractals/color/colorScale.ts","fractals/color/schemes.ts","fractals/color/index.ts","store/fractal/view/types.ts","fractals/FractalDrawer.ts","store/gallery/types.ts","store/fractal/drawState.ts","store/fractal/algorithm/reducer.ts","store/fractal/color/reducer.ts","store/fractal/reducer.ts","store/ui/reducer.ts","store/gallery/reducer.ts","store/reducer.ts","store/index.ts","fractals/math/polar.ts","store/fractal/algorithm/types.ts","store/ui/actions.ts","store/gallery/actions.ts","store/actions.ts","containers/Canvas/Canvas.module.css","fractals/algorithm/mixers/base.ts","fractals/algorithm/escapeTime.ts","fractals/algorithm/mixers/escape.ts","fractals/algorithm/mixers/julia.ts","fractals/math/util.ts","fractals/math/polynomial.ts","fractals/math/fractals.ts","fractals/algorithm/mixers/controls.ts","fractals/algorithm/burningship.ts","fractals/algorithm/julias.ts","fractals/algorithm/magnet.ts","fractals/algorithm/mandelbox.ts","fractals/algorithm/mandelbrot.ts","fractals/algorithm/phoenix.ts","fractals/algorithm/testing.ts","fractals/algorithm/index.ts","store/fractal/color/types.ts","store/fractal/view/reducer.ts"],"names":["Nav","Modal","StretchMode","SET_MODAL","SET_NAV","SET_STRETCH","UPDATE_UI","ADD_COLOR_SCHEME","num","n","sign","fixed","toFixed","toString","complex","a","b","opts","ControlType","Theme","props","state","type","dark","this","setState","setDark","window","matchMedia","matches","addListener","x","theme","palette","darkPalette","lightPalette","createMuiTheme","CssBaseline","children","React","Component","defaultProps","primary","blue","secondary","pink","lightGreen","amber","MuiAppBar","color","MuiBackdrop","invisible","MuiTextField","variant","size","fullWidth","margin","styles","createStyles","root","whiteSpace","Katex","ref","createRef","current","katex","render","math","displayMode","renderMath","classes","className","createElement","PureComponent","withStyles","RenderStringOrMath","data","TextWithMath","Array","isArray","Typography","map","Select","width","TextField","Option","padding","MenuItem","OptionLabel","fontSize","TypographyWithMath","CustomColor","changeName","evt","name","target","value","changeNum","setNum","changeColor","i","colors","addColor","removeColor","save","onSave","onClose","validName","takenNames","forEach","k","toLowerCase","Math","max","length","push","slice","Grid","item","xs","onChange","style","borderRadius","InputLabel","Box","label","inputProps","p","height","scheme","reverse","skew","container","m","renderColorInput","alignSelf","onDown","disableDown","onUp","Button","disabled","onClick","position","marginTop","marginBottom","textAlign","bottom","userSelect","text","top","disableUp","downIcon","Icon","upIcon","rest","ButtonGroup","IconButton","NumberIncrementer","onClickDown","setValue","incrementDown","onClickUp","incrementUp","v","controlProps","min","step","undefined","params","fmt","ComplexIncrementer","onAngleDown","angleDown","onAngleUp","angleUp","onRadiusDown","radiusDown","onRadiusUp","radiusUp","toPolar","fromPolar","re","im","stepRadius","radius","stepAngle","angle","pol","RotateRight","RotateLeft","boxShadow","ColorPreview","docolors","canvas","context","getContext","orientation","cm","colorScale","fillStyle","fillRect","grid","strokeLinecap","fill","major","strokeWidth","strokeOpacity","minor","marker","ComplexNumberInput","GRID","round","getValueAtClick","onDoubleClick","r","pow","precision","stepRect","angles","stepX","stepY","max_radius","circle","cx","cy","hline","vline","rect_minor","polar_minor","rad","PI","cos","sin","RECT","MINOR","MAJOR","POLAR","makegrid","svg","rect","getBoundingClientRect","y","nativeEvent","clientX","clientY","clickX","clickY","d","vectorEffect","markerRadius","viewBox","join","stroke","gridColor","rectGrid","polarGrid","markerColor","Menu","NumberInput","s","isEmpty","isNaN","onBlur","emptyValue","borderTop","divider","StyledBottomNav","BottomNavigation","connect","ui","nav","galleryBadge","dispatch","setNav","BottomNavigationAction","Params","icon","Tune","Explore","Capture","Gallery","Badge","badgeContent","AlgorithmSettings","selectMethod","methodName","method","methodList","newParams","apply","setAlgorithm","reset","SettingsContainer","select","Object","keys","key","fractal","algorithm","recenter","redraw","ColorSettings","openCustomPopup","customPopup","closeCustomPopup","changeReverse","setCurrent","checked","changeSkew","console","log","selectScheme","setScheme","hasChanged","schemeName","saveScheme","addScheme","updateColor","schemeList","revert","sort","FormControlLabel","control","Switch","edge","FormControl","shrink","Slider","Popover","open","colorSchemeList","updates","recolor","addColorScheme","ViewSettings","centerStep","w","h","ppu","pixelCount","updateView","setCX","setCY","setW","setH","setPPU","setPixelCount","spacing","maxWidth","view","update","JSONTextField","fontFamily","JSONInterface","onCopyJson","navigator","clipboard","writeText","currentJson","onCopyLink","currentURL","onChangeJson","parsedJson","jsonToState","JSON","parse","jsonInput","urlToJson","split","onUploadJson","uploadData","selectText","Link","href","InputProps","onFocusCapture","readOnly","endAdornment","InputAdornment","title","Upload","stateToJson","stringify","jsonToUrl","StyledMenuItem","StyledLabel","ListItemText","StyledSwipeableDrawer","paper","display","flexDirection","SwipeableDrawer","SettingsDrawer","openMenu","setModal","openAlgorithm","menu","Algorithm","openColor","Color","openView","View","openJSON","closeAll","None","closePopup","openPopup","popup","labelStyle","listStyle","onOpen","List","ListItemIcon","Functions","Palette","Code","Divider","paddingTop","paddingBottom","Back","ListItem","left","right","version","SettingsMenu","modal","Canvas","drawer","canvasRef","centerOnClick","setCenter","offsetX","offsetY","stretch","Contain","ww","hh","imageH","imageW","dx","dy","FractalDrawer","fullResolution","draw","putOnCanvas","finishDrawing","drawState","DrawState","Draw","objectFit","outerClasses","Outer","outerstyle","visible","Stretch","Cover","id","canvasStretch","finish","Outside","backgroundColor","background","default","Paper","Inside","flexFlow","alignItems","justifyContent","Toolbar","ControlPanel","Popup","elevation","CropContainer","cropPixels","shouldRedraw","aspect","swapWH","getImage","cvs","document","getElementById","image","toDataURL","onCropChange","crop","onCropComplete","area","areaPixels","onZoomChange","zoom","capture","determineView","setData","saveImage","finishCapture","startCapture","captureSize","prevProps","setTimeout","scaleDown","rx","ry","xscale","linearScale","yscale","newview","toURL","url","floor","Date","now","getTime","addToGallery","SwapHoriz","Fab","AddAPhoto","startWaiting","zoomIn","zoomOut","factor","ZoomOut","ZoomIn","ParamControls","paramUpdater","param","onCall","startIcon","Random","Number","renderNumberIncrementer","Complex","renderComplexIncrementer","Call","renderCall","controls","renderControl","updateParams","iter","Controls","Iterator","StyledGridList","GridList","StyledGridListTile","maxHeight","tile","GridListTile","StyledIconButton","ImageTile","cols","src","alt","GridListTileBar","actionIcon","onView","ViewImage","close","openDelete","Delete","onDelete","deleteImage","onDownload","download","click","onLoad","loadJson","viewer","cellHeight","images","index","Save","linkUrl","marginLeft","gallery","uploadJson","useStyles","makeStyles","overflow","flexGrow","Display","KatexButton","textTransform","formula","Info","Recenter","toolbar","disableMenu","rootClass","AppBar","marginRight","science","toPrecision","fractalinfo","describe","rounder","log10","centerx","centery","domainx","abs","domainy","marginThreshold","typography","progress","outline","waiting","CircularProgress","App","Settings","Root","store","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","error","require","uploadUrl","search","ReactDOM","URL","process","origin","addEventListener","fetch","headers","response","contentType","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker","Base","frames","center","incl","ms","getParam","x0","y0","a0","atan2","r0","sqrt","setAngle","a1","x1","y1","animate","getParams","COLORSCHEMES","_updateColor","rangeGen","start","stop","includeStart","promiseGenerator","gen","f","next","done","Promise","resolve","animator","inclusive","Connected","reduxStore","autodraw","reduxAction","action","getState","getFractal","ALLFRACTALS","Abstract","Zipper","zip","count","JSZip","String","padStart","file","filename","generateAsync","blob","createObjectURL","body","append","remove","revokeObjectURL","Disconnected","fractalState","zipper","json","toBlob","addFile","getAlgorithm","getColor","getView","recenterPPU","parseState","magic","volatility","rounds","c0","setParam","rand","random","randC","rotator","rotateParam","xmid","ymid","new","hidden","logDrawTime","args","fractalex","calc","range","UPDATE_FRACTAL","TAU","asin","exp","col","alg","stateToJson2","sc","Rainbow","sk","rv","pp","jsonToState1","result","jsonToState2","u","URLSearchParams","btoa","jsonToUrl1","par","entries","jsonToUrl2","atob","urlToJson1","al","co","vw","me","pa","fromEntries","entry","filter","ent","rev","urlToJson2","UPDATE_PARAMS","payload","SET_ALGORITHM","UPDATE_COLOR","UPDATE_VIEW","RECENTER","ZOOM_IN","ZOOM_OUT","z","add","addReal","addPolar","subt","mult","multReal","div","abs2","powFloat","P","powInt","powReal","pow2","pow3","pow4","pow5","pow6","pow7","pow8","powN","sinh","divReal","colorSchemeName","canvasSize","interpolator","piecewise","interpolateLab","exponent","domain","scale","scalePow","D3_SCHEMES_1","Cool","Cubehelix","Greys","Inferno","Magma","Plasma","Sinebow","Spectral","Viridis","Warm","D3_SCHEMES_2","Blues","BrBG","BuGn","BuPu","GnBu","Greens","OrRd","Oranges","PRGn","PiYG","PuBu","PuBuGn","PuOr","PuRd","Purples","RdBu","RdGy","RdPu","RdYlBu","RdYlGn","Reds","YlGn","YlGnBu","YlOrBr","YlOrRd","ALL_SCHEMES","Paint","Ink","pixels","isRect","ctx","cmap","ImageData","t0","performance","makeCMap","makeImage","t1","cs","parseInt","g","xrange","yrange","c","putImageData","ADD_TO_GALLERY","MASS_ADD_TO_GALLERY","DELETE_IMAGE","FINISH_DRAWING","reducer","initialState","reducer1","combineReducers","UPDATE_ALGORITHM","rw","rh","createStore","module","exports","bound","iterations","b2","z0","DefaultEscapeParams","bd","calculate","func","escapeTime","zz","describeEscapeFunction","escape","baseFractalInterface","lz0","latexZ0","latexF","replace","juliaLabel","juliaCalc","esc","julia","isInt","coeffs","allAreInts","BS","burningship","bs","cc","mandelbox","aa","f1","recip","f2","ab2","lookback","zp","z1","phoenix","po","number","absabs","BurningShip","mix","BurningShipMandelbox","box1","box2","box3","mbox","ctrl","randomC","JuliaControls","Julia","Julia2Term","poly","polynomial","JuliaExp","JuliaSinh","JuliaBurningShip","Magnet1","Magnet2","a3","b3","ab","mandelboxBlatex","describeMandelbox","mandelboxClatex","MandelboxRandom","MandelboxControls","Mandelbox","Mandelcorner","Mandelbrot","Phoenix","_","PhoenixBurningShip","px","Test1","m1","m2","m3","bx","Bs","BsMbx","JlBs","Jl1","Jl2","JlExp","JlSinh","Mg1","Mg2","Mbx","Md","MbxBs","Ph","PhBs"],"mappings":"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","file":"static/js/main.7916b92e.chunk.js","sourcesContent":["import { ALLFRACTALS, COLORSCHEMES } from '../../fractals';\nimport { ColorScheme as CS } from '../../fractals/color/types';\n\nexport type ColorScheme = CS\n\nexport const SET_MODAL = 'UI_SET_MODAL'\nexport const SET_NAV = 'UI_SET_NAV'\nexport const SET_STRETCH = 'UI_SET_STRETCH'\nexport const UPDATE_UI = 'UI_UPDATE'\nexport const ADD_COLOR_SCHEME = 'UI_ADD_COLOR_SCHEME'\n\nexport enum Nav {\n  Params,\n  Explore,\n  Capture,\n  Gallery,\n}\n\nexport enum Modal {\n  None,\n  Menu,\n  Info,\n  FullResolution,\n}\n\nexport enum StretchMode {\n  None,\n  Contain,\n  Cover,\n}\n\nexport interface UIState {\n  nav: Nav\n  modal: Modal\n  canvasStretch: StretchMode\n  galleryBadge: number\n  methodList: typeof ALLFRACTALS\n  colorSchemeList: typeof COLORSCHEMES\n  waiting: boolean\n}\n\nexport type UpdateUI = {\n  type: typeof UPDATE_UI\n  payload: Partial<UIState>\n}\n\nexport type SetModal = {\n  type: typeof SET_MODAL\n  payload: Modal\n}\n\nexport type SetNav = {\n  type: typeof SET_NAV\n  payload: Nav\n}\n\nexport type SetStretch = {\n  type: typeof SET_STRETCH\n  payload: StretchMode\n}\n\nexport type AddColorScheme = {\n  type: typeof ADD_COLOR_SCHEME\n  payload: {\n    name: string\n    scheme: ColorScheme\n  }\n}\n\nexport type UIAction = UpdateUI | SetModal | SetNav | SetStretch | AddColorScheme","\ntype NumberOpts = {\n  fixed?: number\n  round?: number\n  sign?: boolean\n}\n\nexport function num(n: number, {\n  sign,\n  fixed=4\n}: NumberOpts={}): string {\n  if (sign && !(n < 0)) {\n    return '+' + num(n, {fixed})\n  }\n  if (fixed) {\n    return (+(n.toFixed(fixed))).toString()\n  }\n  return n.toString()\n}\n\nexport function complex([a, b]: [number,number], opts: NumberOpts={}) {\n  return num(a,opts) + num(b,{...opts,sign:true}) + 'i'\n}\n\n\n\nexport function rounder(p: number) {\n  const d = Math.pow(10, p);\n  return (n: number) => Math.round(n * d) / d;\n}\n\n\n\nexport function science(n: number, p: number=4) {\n  const a = n.toPrecision(4);\n  const b = a.split('e')\n  if (b.length === 1) {\n    return a;\n  } else {\n    return b[0] + '\\\\times 10^{' + b[1] + '}'\n  }\n}","import { Complex as _Complex } from '../math/types';\nimport { StringWithMath as SWM } from '../../components/TypographyWithMath';\n\nexport type Complex = _Complex\n\nexport type StringWithMath = SWM\n\nexport type PixelCalculator = (x: number, y: number) => number\n\nexport type Params = {[k: string]: any}\n\nexport enum ControlType {\n  Call,\n  Number,\n  Complex,\n  Boolean,\n}\n\nexport interface ControlCall {\n  type: ControlType.Call\n  label?: string\n  icon?: string\n  onCall: () => Params\n}\n\nexport interface ControlNumber {\n  type: ControlType.Number\n  label: string\n  param: string\n  step: number\n  min?: number\n  max?: number\n}\n\nexport interface ControlComplex {\n  type: ControlType.Complex\n  label: string\n  param: string\n  stepRadius: number\n  stepAngle: number\n}\n\nexport interface ControlBoolean {\n  type: ControlType.Boolean\n  label: string\n  param: string\n}\n\nexport type ControlProps = ControlCall | ControlNumber | ControlComplex | ControlBoolean\n\n\nexport interface FractalInterface<T> {\n  label: StringWithMath\n  calc: (params: T) => (x: number, y: number) => number\n  range: (params: T) => [number, number]\n  describe: (params: T) => StringWithMath\n  newParams: () => T\n  controls: ControlProps[]\n}\n\nexport type Vector = [number, number]\n\n","import React from 'react';\nimport {\n  ThemeProvider as Provider, \n  createMuiTheme, \n} from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport {amber, pink, blue, lightGreen} from '@material-ui/core/colors';\n\n\ntype Props = {\n  type: 'light' | 'dark' | 'detect'\n  lightPalette?: any\n  darkPalette?: any\n  theme: any\n}\n\nclass Theme extends React.Component<Props> {\n  state: {type: 'light' | 'dark'}\n\n  static defaultProps = {\n    type: 'detect',\n\n    lightPalette: {\n      primary: blue,\n      secondary: pink,\n    },\n\n    darkPalette: {\n      primary: lightGreen,\n      secondary: amber,\n    },\n\n    theme: {\n      props: {\n        MuiAppBar: {color: 'inherit'},\n        MuiBackdrop: {\n          invisible: true\n        },\n        MuiTextField: {\n          variant: 'outlined',\n          size: 'small',\n          fullWidth: true,\n          margin: 'normal',\n        },\n      },\n    }\n  }\n\n  constructor(props: React.PropsWithChildren<Props>) {\n    super(props);\n    this.state = {\n      type: this.props.type === 'detect' ? 'light' : this.props.type\n    }\n  }\n\n  setDark(dark: boolean) {\n    this.setState({type: dark ? 'dark' : 'light'})\n  }\n\n  componentDidMount() {\n    if (this.props.type === 'detect') {\n      this.setDark(window.matchMedia(\"(prefers-color-scheme:dark)\").matches)\n      window.matchMedia(\"(prefers-color-scheme:dark)\").addListener(x => {\n        this.setDark(x.matches)\n      })\n    }\n  }\n\n  render() {\n    const theme = {\n      ...this.props.theme,\n      palette: {\n        ...this.props.theme.palette,\n        ...this.state,\n        ...(this.state.type === 'dark' ? this.props.darkPalette : this.props.lightPalette)\n      }\n    }\n    return (\n      <Provider theme={createMuiTheme(theme)}>\n        <CssBaseline/>\n        {this.props.children}\n      </Provider>\n    )\n  }\n}\n\nexport default Theme;","import React from 'react'\nimport katex from 'katex'\nimport { withStyles, createStyles, WithStyles } from '@material-ui/core/styles';\nimport 'katex/dist/katex.css';\n\n\nconst styles = createStyles({\n  root: {\n    whiteSpace: 'nowrap',\n  }\n})\n\nexport interface KatexProps {\n  math: string\n  displayMode?: boolean\n  className?: string\n  style?: React.CSSProperties\n}\n\ninterface Props extends KatexProps, WithStyles<typeof styles> {}\n\nclass Katex extends React.PureComponent<Props> {\n  ref: React.RefObject<HTMLSpanElement>\n\n  constructor(props: Props) {\n    super(props);\n    this.ref = React.createRef();\n  }\n\n  renderMath() {\n    if (this.ref.current) {\n      katex.render(this.props.math, this.ref.current, {\n        displayMode: this.props.displayMode\n      })\n    }\n  }\n\n  componentDidMount() {\n    this.renderMath()\n  }\n\n  componentDidUpdate() {\n    this.renderMath()\n  }\n\n  render() {\n    const { classes, className } = this.props;\n    return React.createElement('span', {\n      ref: this.ref,\n      className: className ? classes.root + ' ' + className : classes.root,\n    })\n  }\n}\n\nexport default withStyles(styles)(Katex)","import React from 'react';\nimport Katex, { KatexProps } from './Katex';\nimport Typography, {TypographyProps} from '@material-ui/core/Typography';\n\n\nexport type StringOrMath = string | KatexProps\n\nconst RenderStringOrMath = (data: StringOrMath) => {\n  if (typeof data === 'string') {\n    return data;\n  } else {\n    return React.createElement(Katex, data);\n  }\n}\n\nexport type StringWithMath = StringOrMath | StringOrMath[]\n\nexport interface TypographyWithMathProps extends TypographyProps {\n  data: StringWithMath\n  className?: string\n}\n\nconst TextWithMath = ({data, ...props}: TypographyWithMathProps) => {\n  if (Array.isArray(data)) {\n    return React.createElement(Typography, props, ...data.map(RenderStringOrMath))\n  }\n  if (typeof data === 'string') {\n    return React.createElement(Typography, props, data);\n  }\n  return React.createElement(Typography, props, React.createElement(Katex, data));\n}\n\nexport default TextWithMath","import MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\nimport TypographyWithMath from './TypographyWithMath';\nimport { withStyles, Theme } from '@material-ui/core/styles';\n\n\nexport const Select = withStyles((theme: Theme) => ({\n  root: {\n    width: '200px',\n  },\n}))(TextField)\n\nexport const Option = withStyles((theme: Theme) => ({\n  root: {\n    padding: '0.5em',\n  }\n}))(MenuItem)\n\n\nexport const OptionLabel = withStyles((theme: Theme) => ({\n  root: {\n    fontSize: '0.8em',\n  }\n}))(TypographyWithMath)\n","import React from 'react';\nimport { ColorPreview, DownUpButtons } from '.';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport TextField from '@material-ui/core/TextField';\n\n\ntype Props = {\n  takenNames: string[],\n  onSave: (name: string, colors: string[]) => void;\n  onClose: () => void;\n}\n\ntype State = {\n  name: string,\n  num: number,\n  colors: string[],\n}\n\nclass CustomColor extends React.Component<Props> {\n  state: State\n\n  static defaultProps = {\n    takenNames: [],\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      name: '',\n      num: 2,\n      colors: ['#FF0055', '#0055FF'],\n    }\n  }\n\n  changeName = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    const name = evt.target.value;\n    this.setState({name});\n  }\n\n  setNum(n: number) {\n    const num = Math.max(2, n)\n    let colors = [...this.state.colors];\n    if (num > colors.length) {\n      const x = colors[colors.length-1];\n      while (colors.length < num) {\n        colors.push(x);\n      }\n    } else {\n      colors = colors.slice(0,num);\n    }\n    this.setState({num, colors});\n  }\n\n  changeNum = (evt: React.ChangeEvent<HTMLInputElement>) => this.setNum(+evt.target.value)\n\n  changeColor = (i: number) => {\n    return (evt: React.ChangeEvent<HTMLInputElement>) => {\n      const colors = [...this.state.colors];\n      colors[i] = evt.target.value;\n      this.setState({colors});\n    }\n  }\n\n  addColor = () => this.setNum(this.state.num + 1);\n  removeColor = () => this.setNum(this.state.num - 1);\n\n  save = () => {\n    this.props.onSave(this.state.name, this.state.colors);\n    this.props.onClose();\n  }\n\n  validName = () => {\n    if (this.state.name === '') {\n      return false;\n    }\n    this.props.takenNames.forEach(k => {\n      if (k.toLowerCase() === this.state.name.toLowerCase()) {\n        return false;\n      }\n    })\n    return true;\n  }\n\n  renderColorInput(i: number) {\n    if (i < this.state.colors.length) {\n      return (\n        <Grid item xs={1}>\n          <input type=\"color\"\n            value={this.state.colors[i]}\n            onChange={this.changeColor(i)}\n            style={{width: '40px', borderRadius: 0, padding: 0}}\n          />\n        </Grid>\n      )\n    }\n    return null;\n  }\n\n  render() {\n    return (\n      <>\n\n        <InputLabel>New Colorscheme</InputLabel>\n\n        <Box>\n        <TextField\n              label=\"Name\"\n              variant=\"filled\"\n              value={this.state.name}\n              onChange={this.changeName}\n              inputProps={{type: 'text'}}\n            />\n        </Box>\n        <Box p={1}>\n          <ColorPreview\n            style={{width: '100%', height: '4mm'}}\n            scheme={this.state.colors}\n            reverse={false}\n            skew={0}\n            width={100}\n            height={10}\n          />\n        </Box>\n        <Box>\n          <Grid container>\n            {this.state.colors.map((color: string, i: number) => (\n              <Box m={0.5}>{this.renderColorInput(i)}</Box>\n            ))}\n          </Grid>\n          <Box m={1}>\n            <DownUpButtons\n              variant=\"contained\"\n              style={{alignSelf: 'center'}}\n              onDown={this.removeColor}\n              disableDown={this.state.colors.length < 3}\n              onUp={this.addColor}\n            />\n          </Box>\n          <Box>\n          <Button \n              fullWidth color=\"primary\"\n              disabled={!this.validName()}\n              onClick={this.save}\n            >Save</Button>\n          </Box>\n        </Box>\n      </>\n    )\n  }\n}\n\nexport default CustomColor","import React from 'react';\nimport Box from '@material-ui/core/Box';\nimport ButtonGroup, { ButtonGroupProps } from '@material-ui/core/ButtonGroup';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport { createStyles, withStyles, WithStyles, Theme } from '@material-ui/core/styles';\nimport SvgIcon from '@material-ui/core/SvgIcon';\nimport * as Icon from './icons'\n\n\nconst styles = ({palette}: Theme) => createStyles({\n  container: {\n    position: 'relative',\n    marginTop: '5px',\n    marginBottom: '5px',\n  },\n  label: {\n    textAlign: 'center',\n    position: 'absolute',\n    bottom: '-5px',\n    width: '100%',\n    userSelect: 'none',\n    color: palette.text.secondary,\n  },\n  value: {\n    textAlign: 'center',\n    position: 'absolute',\n    top: '-5px',\n    width: '100%',\n    userSelect: 'none',\n    color: palette.text.secondary,\n  }\n});\n\n\nexport interface DownUpButtonsProps extends WithStyles<typeof styles>, Omit<ButtonGroupProps, 'classes'> {\n  [k: string]: any\n  onUp?: () => void\n  onDown?: () => void\n  disableUp?: boolean\n  disableDown?: boolean\n  value?: string\n  label?: string\n  fontSize?: \"small\" | \"default\" | \"large\" | \"inherit\"\n  iconDown?: typeof SvgIcon\n  iconUp?: typeof SvgIcon\n}\n\n\nconst DownUpButtons = ({label, value, classes, onUp, onDown, fontSize, \n  disableUp, disableDown, downIcon=Icon.Minus, upIcon=Icon.Plus,\n  ...rest\n}: DownUpButtonsProps) => (\n\n  <Box className={classes.container}>\n      {label ? (\n        <Typography variant=\"caption\" className={classes.label}>\n          {label}\n        </Typography>\n      ) : null}\n      {value ? (\n        <Typography variant=\"caption\" className={classes.value}>\n          {value}\n        </Typography>\n      ) : null}\n    <ButtonGroup {...rest}>\n      <IconButton\n        onClick={onDown}\n        disabled={disableDown}\n      >{React.createElement(downIcon, {fontSize})}</IconButton> \n      <IconButton\n        onClick={onUp}\n        disabled={disableUp}\n      >{React.createElement(upIcon, {fontSize})}</IconButton>\n    </ButtonGroup>\n  </Box>\n)\n\nexport default withStyles(styles)(DownUpButtons)","import React from 'react';\nimport { ControlNumber } from '../fractals/algorithm/types'\nimport DownUpButtons, { DownUpButtonsProps } from './DownUpButtons';\nimport * as fmt from '../fractals/formatting';\n\ninterface NewProps {\n  controlProps: ControlNumber\n  value: number\n  onChange: (x: number) => void\n}\n\ninterface Props extends NewProps, Omit<DownUpButtonsProps, 'label' | 'onDown' | 'onUp'> {}\n\nclass NumberIncrementer extends React.Component<Props> {\n\n  setValue(v: number) {\n    this.props.onChange(v)\n  }\n\n  incrementDown() {\n    const {min, step} = this.props.controlProps;\n    const v = this.props.value - step;\n    if (min !== undefined) {\n      return Math.max(min, v)\n    }\n    return v;\n  }\n\n  incrementUp() {\n    const {max, step} = this.props.controlProps;\n    const v = this.props.value + step;\n    if (max !== undefined) {\n      return Math.min(max, v)\n    }\n    return v;\n  }\n\n  onClickDown = () => {\n    this.setValue(this.incrementDown())\n  }\n\n  onClickUp = () => {\n    this.setValue(this.incrementUp())\n  }\n\n\n  render() {\n    const {controlProps, params, onChange, ...rest} = this.props;\n    return (\n      <DownUpButtons\n        {...rest}\n        value={fmt.num(this.props.value)}\n        label={controlProps.label}\n        onDown={this.onClickDown}\n        onUp={this.onClickUp}\n      />\n    )\n  }\n}\n\nexport default NumberIncrementer\n","import React from 'react';\nimport { ControlComplex } from '../fractals/algorithm/types'\nimport DownUpButtons, { DownUpButtonsProps } from './DownUpButtons';\nimport {\n  complex,\n  fromPolar,\n  toPolar,\n} from '../fractals/math/complex';\nimport { Polar } from '../fractals/math/types';\nimport { Icon } from '.';\nimport * as fmt from '../fractals/formatting';\n\n//const round = (n: number) => Math.round(n * 100000) / 100000\n\ntype Vec = [number, number]\n\ninterface NewProps {\n  controlProps: ControlComplex\n  value: Vec\n  onChange: (x: Vec) => void\n}\n\ninterface Props extends NewProps, Omit<DownUpButtonsProps,'onChange'> {}\n\nclass ComplexIncrementer extends React.Component<Props> {\n\n  setValue(v: Vec) {\n    this.props.onChange(v)\n  }\n\n  toPolar() {\n    return toPolar(complex(this.props.value[0], this.props.value[1]))\n  }\n\n  fromPolar(v: Polar): Vec {\n    const a = fromPolar(v);\n    return [a.re, a.im];\n  }\n\n  radiusDown(): Vec {\n    const {stepRadius} = this.props.controlProps;\n    const p = this.toPolar();\n    return this.fromPolar({...p, radius: p.radius-stepRadius})\n  }\n\n  radiusUp(): Vec {\n    const {stepRadius} = this.props.controlProps;\n    const p = this.toPolar();\n    return this.fromPolar({...p, radius: p.radius+stepRadius})\n  }\n\n  angleDown(): Vec {\n    const {stepAngle} = this.props.controlProps;\n    const p = this.toPolar();\n    return this.fromPolar({...p, angle: p.angle-stepAngle})\n  }\n\n  angleUp(): Vec {\n    const {stepAngle} = this.props.controlProps;\n    const p = this.toPolar();\n    return this.fromPolar({...p, angle: p.angle+stepAngle})\n  }\n\n\n  onAngleDown = () => {\n    this.setValue(this.angleDown())\n  }\n\n  onAngleUp = () => {\n    this.setValue(this.angleUp())\n  }\n\n  onRadiusDown = () => {\n    this.setValue(this.radiusDown())\n  }\n\n  onRadiusUp = () => {\n    this.setValue(this.radiusUp())\n  }\n\n\n  render() {\n    const {controlProps, onChange, ...rest} = this.props;\n    const pol = this.toPolar();\n    return (\n      <>\n      <DownUpButtons\n        {...rest}\n        //label={controlProps.label + ': θ'}\n        value={fmt.num(pol.angle)}\n        label={controlProps.label + ': angle'}\n        onDown={this.onAngleDown}\n        onUp={this.onAngleUp}\n        downIcon={Icon.RotateRight}\n        upIcon={Icon.RotateLeft}\n      />\n      <DownUpButtons\n        {...rest}\n        value={fmt.num(pol.radius)}\n        label={controlProps.label + ': radius'}\n        onDown={this.onRadiusDown}\n        onUp={this.onRadiusUp}\n      />\n      </>\n    )\n  }\n}\n\nexport default ComplexIncrementer\n","import Box from '@material-ui/core/Box';\nimport { withStyles, Theme, createStyles } from '@material-ui/core/styles';\n\n\nconst styles = createStyles((theme: Theme) => ({\n  root: {\n    height: '100%',\n  }\n}));\n\n\nexport default withStyles(styles)(Box)","import React from 'react';\nimport { ColorScheme } from '../fractals/color/types';\nimport { colorScale } from '../fractals/color';\nimport { withStyles, WithStyles, createStyles } from '@material-ui/core/styles';\n//import { CSSProperties } from '@material-ui/core'\n\n\nexport interface ColorPreviewProps {\n  width: number\n  height: number\n  orientation: string\n  scheme: ColorScheme\n  reverse: boolean\n  skew: number\n  style?: React.CSSProperties\n}\n\nconst styles = createStyles({\n  root: {\n    borderRadius: '8px',\n    boxShadow: '2px 2px 4px rgba(0,0,0,0.5)',\n  }\n})\n\ninterface Props extends ColorPreviewProps, WithStyles<typeof styles> {}\n\nclass ColorPreview extends React.Component<Props> {\n  ref: React.RefObject<HTMLCanvasElement>\n\n  static defaultProps = {\n    width: 400,\n    height: 10,\n    orientation: 'horizontal',\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.ref = React.createRef();\n  }\n\n  componentDidMount() {\n    this.docolors();\n  }\n\n  componentDidUpdate() {\n    this.docolors();\n  }\n\n  docolors() {\n    const canvas = this.ref.current;\n    if (canvas) {\n      const context = canvas.getContext('2d');\n      if (context) {\n        const { scheme, reverse, skew, width, height, orientation } = this.props;\n        if (orientation === 'horizontal') {\n          const cm = colorScale({scheme, reverse, skew})([0,width]);\n          let i = width + 1;\n          while (i--) {\n            context.fillStyle = cm(i);\n            context.fillRect(i, 0, 1, height);\n          }\n        } else {\n          const cm = colorScale({scheme, reverse, skew})([height,0]);\n          let i = height + 1;\n          while (i--) {\n            context.fillStyle = cm(i);\n            context.fillRect(0, i, width, 1);\n          }\n        }\n      }\n    }\n  }\n\n  render() {\n    return (\n      <canvas ref={this.ref} \n        width={this.props.width} \n        height={this.props.height} \n        style={this.props.style}\n        className={this.props.classes.root}\n      />\n    )\n  }\n}\n\nexport default withStyles(styles)(ColorPreview)","import React from 'react';\nimport { withStyles, createStyles, WithStyles } from '@material-ui/core/styles';\n\n\nexport interface ComplexNumberInputProps {\n  value: [number, number],\n  max: number,\n  onClick?: (v: [number, number]) => void,\n  onDoubleClick?: (v: [number, number]) => any,\n  size: number,\n  precision: number,\n  stepRect: number,\n  stepRadius: number,\n  stepAngle: number,\n  angles?: number[],\n  style?: React.CSSProperties,\n  markerColor: string,\n  gridColor?: string,\n  textColor?: string,\n}\n\n\nconst styles = createStyles({\n  root: {\n    padding: '0px',\n    userSelect: 'none',\n  },\n  \n  grid: {\n    strokeLinecap: 'square',\n    fill: 'none',\n  },\n  \n  major: {\n    strokeWidth: 0.5,\n    strokeOpacity: 1,\n  },\n  \n  minor: {\n    strokeWidth: 0.5,\n    strokeOpacity: 0.3,\n  },\n  \n  marker: {\n    strokeWidth: 0,\n  },\n});\n\n\ninterface Props extends ComplexNumberInputProps, WithStyles<typeof styles> {}\n\nclass ComplexNumberInput extends React.Component<Props> {\n  ref: React.RefObject<SVGSVGElement>\n  GRID: {\n    RECT?: {MAJOR?: string, MINOR?: string},\n    POLAR?: {MAJOR?: string, MINOR?: string},\n  }\n  round: (n: number) => number\n\n  static defaultProps = {\n    size: 100,\n    precision: 3,\n    stepAngle: 30,\n    stepRadius: 0.2,\n    stepRect: 0.2,\n\n    markerColor: 'blue',\n    //gridColor: 'black',\n  }\n\n  constructor(props: React.PropsWithChildren<Props>) {\n    super(props);\n    this.ref = React.createRef();\n    const r = Math.pow(10, props.precision);\n    this.round = (n: number) => Math.round(n*r) / r;\n    const {max, stepRadius, stepRect, stepAngle, angles} = this.props;\n    this.GRID = makegrid({max, stepRadius, stepAngle, angles, stepX: stepRect, stepY: stepRect});\n  }\n\n  getValueAtClick(evt: any): [number, number] | undefined {\n    const svg = this.ref.current;\n    if (svg) {\n      const rect = svg.getBoundingClientRect();\n      const {x, y} = rect;\n      const {clientX, clientY} = evt.nativeEvent;\n      const clickX = ((clientX - x) / this.props.size - 0.5) * 2*this.props.max;\n      const clickY = -((clientY - y) / this.props.size - 0.5) * 2*this.props.max;\n      return [this.round(clickX), this.round(clickY)];\n    }\n  }\n\n  onClick = (evt: any) => {\n    if (this.props.onClick) {\n      const p = this.getValueAtClick(evt);\n      if (p) this.props.onClick(p);\n    }\n  }\n\n  onDoubleClick = (evt: any) => {\n    if (this.props.onDoubleClick) {\n      const p = this.getValueAtClick(evt);\n      if (p) this.props.onDoubleClick(p);\n    }\n  }\n\n  polarGrid() {\n    if (this.GRID.POLAR) {\n      return (\n        <>\n        {this.GRID.POLAR.MINOR ? (\n          <path d={this.GRID.POLAR.MINOR} \n            className={this.props.classes.minor} \n            vectorEffect=\"non-scaling-stroke\"/>\n        ) : null}\n        {this.GRID.POLAR.MAJOR ? (\n          <path d={this.GRID.POLAR.MAJOR} \n            className={this.props.classes.major} \n            vectorEffect=\"non-scaling-stroke\"/>\n        ) : null}\n        </>\n      )\n    }\n    return null;\n  }\n\n  rectGrid() {\n    if (this.GRID.RECT) {\n      return (\n        <>\n        {this.GRID.RECT.MINOR ? (\n          <path d={this.GRID.RECT.MINOR} \n            className={this.props.classes.minor} \n            vectorEffect=\"non-scaling-stroke\"/>\n        ) : null}\n        {this.GRID.RECT.MAJOR ? (\n          <path d={this.GRID.RECT.MAJOR} \n            className={this.props.classes.major} \n            vectorEffect=\"non-scaling-stroke\"/>\n        ) : null}\n        </>\n      )\n    }\n    return null;\n  }\n  \n  render() {\n    const markerRadius = this.props.max / 24;\n    const viewBox = [-this.props.max, -this.props.max, 2*this.props.max, 2*this.props.max]\n    return (\n      <svg \n        ref={this.ref}\n        onClick={this.onClick}\n        onDoubleClick={this.onDoubleClick}\n        viewBox={viewBox.join(' ')}\n        className={this.props.classes.root}\n        style={{...this.props.style, width: this.props.size, height: this.props.size}}\n      >\n        <g className={this.props.classes.grid}\n          style={{stroke: this.props.gridColor}}\n        >\n          {this.rectGrid()}\n          {this.polarGrid()}\n        </g>\n        <circle \n          cx={this.props.value[0]}\n          cy={-this.props.value[1]}\n          r={markerRadius} \n          className={this.props.classes.marker}\n          style={{\n            stroke: this.props.markerColor,\n            fill: this.props.markerColor,\n          }}\n        />\n      </svg>\n    )\n  }\n}\n\n\nexport default withStyles(styles)(ComplexNumberInput)\n\n\nfunction makegrid({max, stepX, stepY, stepRadius, stepAngle, angles}: {\n  max: number,\n  stepX: number,\n  stepY: number,\n  stepAngle: number,\n  stepRadius: number,\n  angles?: number[],\n}) {\n  const max_radius = max * 1.5;\n\n  function circle(cx: number, cy: number, r: number) {\n    return (\n      'M' + cx+r + ',' + cy + \n      'A' + r + ',' + r + ',0,1,0,' + cx + ',' + cy + r +\n      'A' + r + ',' + r + ',0,0,0,' + cx + r + ',' + cy\n    )\n  }\n\n  function hline(v: number) {\n    return 'M' + (-max) + ',' + v + 'H' + max;\n  }\n\n  function vline(v: number) {\n    return 'M' + v + ',' + (-max) + 'V' + max;\n  }\n  \n  let rect_minor = ''\n  let i = 0;\n  while (i <= max) {\n    rect_minor += vline(i) + vline(-i);\n    i += stepX;\n  }\n\n  i = 0;\n  while (i <= max) {\n    rect_minor += hline(i) + hline(-i);\n    i += stepY;\n  }\n  \n  let polar_minor = '';\n  \n  if (angles) {\n    angles.forEach(a => {\n      const rad = a * Math.PI / 180;\n      polar_minor += 'M0,0L' + max_radius * Math.cos(rad) + ',' + max_radius * Math.sin(rad);\n    })\n  } else {\n    i = 0;\n    while (i < 360) {\n      const rad = i * Math.PI / 180;\n      polar_minor += 'M0,0L' + max_radius * Math.cos(rad) + ',' + max_radius * Math.sin(rad);\n      i += stepAngle;\n    }\n  }\n\n  i = stepRadius;\n  while (i <= max_radius) {\n    polar_minor += circle(0, 0, i);\n    i += stepRadius;\n  }\n\n  return {\n    RECT: {MINOR: rect_minor, MAJOR: hline(0) + vline(0)},\n    POLAR: {MINOR: polar_minor, MAJOR: circle(0, 0, 1)},\n  }\n  \n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { Modal } from '../../store/ui/types';\nimport { setModal } from '../../store/actions'\nimport AlgorithmSettings from './AlgorithmSettings';\nimport ColorSettings from './ColorSettings';\nimport ViewSettings from './ViewSettings';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Box from '@material-ui/core/Box';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Divider from '@material-ui/core/Divider';\nimport Typography from '@material-ui/core/Typography';\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer';\nimport JSONInterface from './JSONInterface';\nimport { withStyles } from '@material-ui/core/styles';\nimport { Icon } from '../../components';\nimport { version } from '../../../package.json';\n\ntype Props = {\n  open: boolean\n  setModal: (modal: Modal) => void\n}\n\nconst StyledMenuItem = withStyles({\n  root: {\n    padding: '1em',\n  }\n})(MenuItem)\n\nconst StyledLabel = withStyles({\n  root: {\n    padding: 0,\n    margin: 0,\n  }\n})(ListItemText)\n\n\nconst StyledSwipeableDrawer = withStyles({\n  paper: {\n    display: 'flex',\n    flexDirection: 'row',\n    height: '100%',\n    maxWidth: '90vw',\n  }\n})(SwipeableDrawer)\n\nenum Menu {\n  None,\n  Algorithm,\n  Color,\n  View,\n  JSON,\n}\n\nclass SettingsDrawer extends React.Component<Props> {\n  state: {\n    menu: Menu,\n    popup: boolean,\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      menu: Menu.None,\n      popup: false,\n    }\n  }\n\n\n\n  openMenu = () => this.props.setModal(Modal.Menu);\n  openAlgorithm = () => this.setState({menu: Menu.Algorithm});\n  openColor = () => this.setState({menu: Menu.Color});\n  openView = () => this.setState({menu: Menu.View});\n  openJSON = () => this.setState({menu: Menu.JSON});\n\n  closeAll = () => {\n    this.setState({menu: Menu.None});\n    this.closePopup();\n    this.props.setModal(Modal.None);\n  }\n\n  openPopup = () => this.setState({popup: true})\n  closePopup = () => this.setState({popup: false})\n\n  render() {\n    const labelStyle = this.state.menu === Menu.None ? {} : {display: 'none'};\n    const listStyle = this.state.menu === Menu.None ? {} : {width: '4em'}\n    return (\n      <StyledSwipeableDrawer\n        open={this.props.open}\n        onOpen={this.openMenu}\n        onClose={this.closeAll}\n      >\n        <List style={listStyle}>\n          <StyledMenuItem onClick={this.openAlgorithm}>\n            <ListItemIcon><Icon.Functions/></ListItemIcon>\n            <StyledLabel style={labelStyle}>Algorithm</StyledLabel>\n          </StyledMenuItem>\n          <StyledMenuItem onClick={this.openColor}>\n            <ListItemIcon><Icon.Palette/></ListItemIcon>\n            <StyledLabel style={labelStyle}>Colors</StyledLabel>\n          </StyledMenuItem>\n          <StyledMenuItem onClick={this.openView}>\n            <ListItemIcon><Icon.View/></ListItemIcon>\n            <StyledLabel style={labelStyle}>View</StyledLabel>\n          </StyledMenuItem>\n          <StyledMenuItem onClick={this.openJSON}>\n            <ListItemIcon><Icon.Code/></ListItemIcon>\n            <StyledLabel style={labelStyle}>Serialize</StyledLabel>\n          </StyledMenuItem>\n          <Divider/>\n          <StyledMenuItem onClick={this.closeAll} style={{paddingTop: '2em', paddingBottom: '2em'}}>\n            <ListItemIcon><Icon.Back/></ListItemIcon>\n            <StyledLabel style={labelStyle}>Close</StyledLabel>\n          </StyledMenuItem>\n          <ListItem style={{position: 'absolute', bottom: '0', left: '0', right: '0'}}>\n            <Typography style={labelStyle} variant=\"caption\">{version}</Typography>\n          </ListItem>\n        </List>\n        <Box>\n          {this.state.menu === Menu.Algorithm ? (\n            <AlgorithmSettings \n              //onClose={this.closeAll}\n            />\n          ) : this.state.menu === Menu.Color ? (\n            <ColorSettings\n              //onClose={this.closeAll}\n            />\n          ) : this.state.menu === Menu.View ? (\n            <ViewSettings\n              //onClose={this.closeAll}\n            />\n          ) : this.state.menu === Menu.JSON ? (\n            <JSONInterface/>\n          ) : null}\n        </Box>\n        \n      </StyledSwipeableDrawer>\n    )\n  }\n}\n\nexport default connect(\n  (state: State) => ({\n    open: state.ui.modal === Modal.Menu,\n  }),\n  (dispatch: Dispatch) => ({\n    setModal: (modal: Modal) => dispatch(setModal(modal))\n  })\n)(SettingsDrawer)","import React from 'react';\nimport TextField, { \n  StandardTextFieldProps,\n  FilledTextFieldProps,\n  OutlinedTextFieldProps,\n} from '@material-ui/core/TextField';\n\n\ninterface NewProps {\n  value?: number\n  step?: number\n  min?: number\n  max?: number\n  emptyValue?: number\n}\n\ninterface StandardNumberInputProps\n  extends NewProps, Omit<StandardTextFieldProps, 'value' | 'type'> {}\n\ninterface FilledNumberInputProps\n  extends NewProps, Omit<FilledTextFieldProps, 'value' | 'type'> {}\n\ninterface OutlinedNumberInputProps\n  extends NewProps, Omit<OutlinedTextFieldProps, 'value' | 'type'> {}\n\ntype NumberInputProps = \n  StandardNumberInputProps | \n  FilledNumberInputProps | \n  OutlinedNumberInputProps;\n\n\nclass NumberInput extends React.Component<NumberInputProps> {\n  state: {isEmpty: boolean}\n\n  constructor(props: NumberInputProps) {\n    super(props);\n    this.state = {\n      isEmpty: false\n    }\n  }\n\n  onChange = (evt: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const s = evt.target.value;\n    if (s === '') {\n      this.setState({isEmpty: true})\n    } else {\n      this.setState({isEmpty: false})\n    }\n    if (this.props.onChange) {\n      if (!isNaN(+s)) {\n        this.props.onChange(evt)\n      }\n    }\n  }\n\n  onBlur = (evt: React.FocusEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    if (this.props.onBlur) {\n      this.props.onBlur(evt);\n    }\n    this.setState({isEmpty: false});\n  }\n\n\n  render() {\n    const {step, min, max, inputProps, onChange, onBlur, value='', emptyValue=0, ...rest} = this.props;\n    return React.createElement(TextField, {\n      type: 'number',\n      value: value ? +value : this.state.isEmpty ? '' : emptyValue,\n      inputProps: {step, min, max, ...inputProps},\n      onChange: this.onChange,\n      onBlur: this.onBlur,\n      ...rest, \n    })\n  }\n}\n\n\nexport default NumberInput","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../store/types';\nimport { Nav } from '../store/ui/types';\nimport { setNav } from '../store/actions';\nimport BottomNavigation, { BottomNavigationProps } from '@material-ui/core/BottomNavigation';\nimport BottomNavigationAction from '@material-ui/core/BottomNavigationAction';\nimport Badge from '@material-ui/core/Badge';\nimport { withStyles, createStyles, Theme } from '@material-ui/core/styles';\nimport { Icon } from '../components';\n\n\nconst styles = createStyles(({palette}: Theme) => ({\n  root: {\n    position: 'absolute',\n    //top: 'auto',\n    bottom: 0,\n    width: '100%',\n    borderTop: '1px solid ' + palette.divider,\n  },\n}))\n\nconst StyledBottomNav = withStyles(styles)(BottomNavigation)\n\nconst BottomNav = (p: BottomNavigationProps & {galleryBadge: number}) => {\n  const {galleryBadge, ...props} = p;\n  return (\n    <StyledBottomNav {...props}>\n      \n      <BottomNavigationAction\n        value={Nav.Params}\n        label=\"Parameters\"\n        icon={<Icon.Tune/>}\n      />\n      <BottomNavigationAction\n        value={Nav.Explore}\n        label=\"Explore\"\n        icon={<Icon.Explore/>}\n      />\n      <BottomNavigationAction\n        value={Nav.Capture}\n        label=\"Capture\"\n        icon={<Icon.Capture/>}\n      />\n      <BottomNavigationAction\n        value={Nav.Gallery}\n        label=\"Saved\"\n        icon={\n          <Badge badgeContent={galleryBadge} color=\"primary\">\n            <Icon.Gallery/>\n          </Badge>\n        }\n      />\n    </StyledBottomNav>\n  )\n};\n\nexport default connect(\n  (state: State) => ({\n    value: state.ui.nav,\n    galleryBadge: state.ui.galleryBadge,\n  }),\n  (dispatch: Dispatch) => ({\n    onChange: (evt: any, x: Nav) => dispatch(setNav(x)),\n  })\n)(BottomNav)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State as AppState, Dispatch } from '../../store/types';\nimport { Method } from '../../store/fractal/algorithm/types';\nimport { setAlgorithm, recenter, redraw } from '../../store/actions';\nimport {\n  SettingsContainer, \n  Select,\n  Option,\n  OptionLabel,\n} from '../../components';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\n\n\ntype Props = {\n  methodName: string\n  params: object\n  methodList: {[k: string]: Method<any>}\n  setAlgorithm: <T extends object>(methodName: string, method: Method<T>, params?: T) => void\n  onClose?: () => void\n}\n\n\ninterface State {\n  methodName: string,\n  method: Method<any>\n  params: object,\n}\n\nclass AlgorithmSettings extends React.Component<Props> {\n  state: State\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      methodName: props.methodName,\n      method: props.methodList[props.methodName],\n      params: {...props.params},\n    };\n  }\n\n  selectMethod = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    const methodName = evt.target.value;\n    const method = this.props.methodList[methodName]\n    this.setState({methodName, method, params: method.newParams()});\n  }\n\n  apply = () => {\n    const {methodName, method, params} = this.state;\n    this.props.setAlgorithm(methodName, method, params)\n    if (this.props.onClose) {\n      this.props.onClose();\n    }\n  }\n\n  reset = () => {\n    const {methodName, params} = this.props;\n    this.setState({\n      methodName,\n      method: this.props.methodList[methodName],\n      params: {...params},\n    });\n  }\n\n  render() {\n    return (\n      <SettingsContainer>\n        <Box m={1}>\n          <Box m={1}>\n            <Select select\n              label=\"Method\"\n              value={this.state.methodName}\n              onChange={this.selectMethod}\n            >\n              {Object.keys(this.props.methodList).map(k => {\n                return (\n                  <Option key={k} value={k}>\n                    <OptionLabel\n                      data={this.props.methodList[k].label}\n                    />\n                  </Option>\n                )\n              })}\n            </Select>\n          </Box>\n          <Box m={1}>\n            <ButtonGroup fullWidth color=\"primary\" orientation=\"vertical\">\n              <Button fullWidth onClick={this.apply}>Apply</Button>\n              <Button fullWidth onClick={this.reset}>Reset</Button>\n            </ButtonGroup>\n          </Box>\n        </Box>\n      </SettingsContainer>\n    )\n  }\n}\n\nexport default connect(\n  (state: AppState) => ({\n    methodName: state.fractal.algorithm.methodName,\n    methodList: state.ui.methodList,\n    params: state.fractal.algorithm.params,\n  }),\n  (dispatch: Dispatch) => ({\n    setAlgorithm: function<T>(methodName: string, method: Method<T>, params?: T) {\n      dispatch(setAlgorithm(methodName, method, params))\n      dispatch(recenter())\n      dispatch(redraw())\n    },\n  })\n)(AlgorithmSettings)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State as AppState } from '../../store/types';\nimport { ColorState, ColorScheme } from '../../store/fractal/color/types';\nimport { updateColor, recolor, addColorScheme } from '../../store/actions';\nimport {\n  ColorPreview,\n  SettingsContainer,\n  Select,\n  Option,\n  OptionLabel,\n  CustomColor,\n} from '../../components';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Popover from '@material-ui/core/Popover';\nimport Slider from '@material-ui/core/Slider';\nimport Switch from '@material-ui/core/Switch';\n\n\ninterface Colors {\n  schemeName: string\n  reverse: boolean\n  skew: number\n}\n\n\ntype Props = {\n  current: Colors\n  updateColor: (update: Partial<ColorState>) => void\n  addScheme: (name: string, scheme: string[]) => void\n  onClose?: () => void\n  schemeList: {[k: string]: ColorScheme}\n}\n\n\ntype Evt = React.ChangeEvent<HTMLInputElement>\n\nclass ColorSettings extends React.Component<Props> {\n  state: {\n    current: Colors\n    customPopup: boolean\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      current: {\n        schemeName: props.current.schemeName,\n        reverse: props.current.reverse,\n        skew: props.current.skew,\n      },\n      customPopup: false,\n    }\n  }\n\n  openCustomPopup = () => this.setState({customPopup: true})\n  closeCustomPopup = () => this.setState({customPopup: false})\n\n  setCurrent(x: Partial<Colors>) {\n    this.setState({...this.state, current: {...this.state.current, ...x}});\n  }\n\n  setScheme(schemeName: string) {\n    this.setCurrent({schemeName});\n  }\n\n  changeReverse = (evt: Evt) => this.setCurrent({reverse: evt.target.checked});\n  changeSkew = (evt: any, skew: number | number[]) => {\n    if (typeof skew === 'number') this.setCurrent({skew});\n    else console.log(skew);\n  }\n\n  selectScheme = (evt: any) => {\n    const scheme = evt.target.value;\n    if (scheme === 'CUSTOM') {\n      this.openCustomPopup();\n    } else {\n      this.setScheme(scheme);\n    }\n  }\n\n  hasChanged = () => {\n    if (this.state.current.schemeName !== this.props.current.schemeName\n      || this.state.current.reverse !== this.props.current.reverse\n      || this.state.current.skew !== this.props.current.skew) {\n      return true;\n    }\n    return false;\n  }\n\n  saveScheme = (k: string, colors: string[]) => {\n    this.props.addScheme(k, colors);\n    this.setScheme(k);\n  }\n\n  apply = () => {\n    this.props.updateColor({\n      schemeName: this.state.current.schemeName,\n      scheme: this.props.schemeList[this.state.current.schemeName],\n      reverse: this.state.current.reverse,\n      skew: this.state.current.skew,\n    });\n    if (this.props.onClose) {\n      this.props.onClose()\n    }\n  }\n\n  revert = () => {\n    this.setState({\n      schemeName: this.props.current.schemeName,\n      reverse: this.props.current.reverse,\n      skew: this.props.current.skew,\n    })\n  }\n\n  render() {\n    return (\n      <>\n        <SettingsContainer>\n          <Box m={1}>\n            <Box m={1}>\n              <Select select\n                label=\"Scheme\"\n                value={this.state.current.schemeName}\n                onChange={this.selectScheme}\n              >\n                <Option value=\"CUSTOM\">\n                  <OptionLabel data=\"CREATE NEW SCHEME\"/>\n                </Option>\n                {Object.keys(this.props.schemeList).sort().map(k => (\n                  <Option key={k} value={k}>\n                    <OptionLabel data={k}/>\n                  </Option>\n                ))}\n              </Select>\n            </Box>\n            <Box m={2}>\n              <FormControlLabel\n                label=\"Reversed\"\n                control={\n                  <Switch checked={this.state.current.reverse}\n                    onChange={this.changeReverse}\n                    edge=\"end\"\n                  />\n                }\n              />\n            </Box>\n\n            <Box m={2}>\n              <FormControl fullWidth>\n                <InputLabel shrink>Skew</InputLabel>\n                <Slider\n                  color=\"secondary\"\n                  value={this.state.current.skew}\n                  onChange={this.changeSkew}\n                  min={-5}\n                  max={5}\n                  step={0.1}\n                />\n              </FormControl>\n            </Box>\n\n            <Box m={1}>\n              <ColorPreview \n                style={{width: '100%', height: '4mm'}}\n                scheme={this.props.schemeList[this.state.current.schemeName]}\n                reverse={this.state.current.reverse}\n                skew={this.state.current.skew}\n                width={100}\n                height={10}\n              />\n            </Box>\n\n            <Box m={1}>\n              <ColorPreview \n                style={{width: '100%', height: '4mm'}}\n                scheme={this.props.schemeList[this.state.current.schemeName]}\n                reverse={this.props.current.reverse}\n                skew={this.props.current.skew}\n                width={100}\n                height={10}\n              />\n              <InputLabel>Current</InputLabel>\n            </Box>\n\n            \n            <ButtonGroup fullWidth color=\"primary\" orientation=\"vertical\">\n              <Button \n                onClick={this.apply}\n                disabled={!this.hasChanged()}\n              >Apply</Button>\n              <Button\n                onClick={this.revert}\n                disabled={!this.hasChanged()}\n              >Reset</Button>\n            </ButtonGroup>\n\n          </Box>\n        </SettingsContainer>\n\n        <Popover\n          open={this.state.customPopup}\n          onClose={this.closeCustomPopup}\n        >\n          <Box m={2}>\n            <CustomColor\n              onSave={this.saveScheme}\n              onClose={this.closeCustomPopup}\n              takenNames={Object.keys(this.props.schemeList)}\n            />\n          </Box>\n        </Popover>\n      </>\n    )\n  }\n}\n\nexport default connect(\n  (state: AppState) => ({\n    current: {...state.fractal.color},\n    schemeList: state.ui.colorSchemeList,\n  }),\n  (dispatch) => ({\n    updateColor: (updates: Partial<ColorState>) => {\n      dispatch(updateColor(updates));\n      dispatch(recolor());\n    },\n    addScheme: (k: string, colors: string[]) => {\n      dispatch(addColorScheme(k, colors));\n    },\n  }),\n)(ColorSettings);","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { ViewState } from '../../store/fractal/view/types';\nimport { updateView, redraw } from '../../store/actions';\nimport { NumberInput, SettingsContainer } from '../../components';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\n\ntype Props = {\n  current: ViewState\n  updateView: (update: Partial<ViewState>) => void\n  onClose?: () => void\n}\n\ntype Evt = React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>\n\nclass ViewSettings extends React.Component<Props> {\n  state: {\n    current: ViewState,\n  }\n  centerStep: number\n\n  constructor(props: Props) {\n    super(props);\n    this.centerStep = 10 / this.props.current.ppu;\n    this.state = {\n      current: {...props.current},\n    }\n  }\n\n  hasChanged = () => {\n    if (this.props.current.cx !== this.state.current.cx) return true;\n    if (this.props.current.cy !== this.state.current.cy) return true;\n    if (this.props.current.w !== this.state.current.w) return true;\n    if (this.props.current.h !== this.state.current.h) return true;\n    if (this.props.current.ppu !== this.state.current.ppu) return true;\n    if (this.props.current.pixelCount !== this.state.current.pixelCount) return true;\n    return false;\n  }\n\n  apply = () => {\n    this.props.updateView(this.state.current);\n    if (this.props.onClose) {\n      this.props.onClose()\n    }\n  }\n\n  revert = () => {\n    this.setState({current: {...this.props.current}});\n  }\n\n  setCurrent(x: Partial<ViewState>) {\n    this.setState({current: {...this.state.current, ...x}});\n  }\n\n  setCX = (evt: Evt) => this.setCurrent({cx: +evt.target.value});\n  setCY = (evt: Evt) => this.setCurrent({cy: +evt.target.value});\n  setW = (evt: Evt) => this.setCurrent({w: +evt.target.value});\n  setH = (evt: Evt) => this.setCurrent({h: +evt.target.value});\n  setPPU = (evt: Evt) => this.setCurrent({ppu: +evt.target.value});\n  setPixelCount = (evt: Evt) => this.setCurrent({pixelCount: +evt.target.value});\n\n\n  render() {\n    return (\n      <SettingsContainer\n      >\n        <Box m={1}>\n        <Box m={1}>\n          <InputLabel>Relative Dimensions</InputLabel>\n          <Grid container spacing={1}>\n            <Grid item xs={6}>\n              <NumberInput\n                fullWidth={false}\n                label=\"Width\"\n                value={+this.state.current.w} \n                onChange={this.setW}\n                step={1}\n                min={1}\n                inputProps={{style: {maxWidth: '5em'}}}\n              />\n            </Grid>\n            <Grid item xs={6}>\n              <NumberInput\n                fullWidth={false}\n                label=\"Height\" \n                value={+this.state.current.h} \n                onChange={this.setH} \n                step={1}\n                min={1}\n                inputProps={{style: {maxWidth: '5em'}}}\n              />\n            </Grid>\n          </Grid>\n\n          <Box>\n            <NumberInput\n              label=\"Pixel count\"\n              value={+this.state.current.pixelCount} \n              onChange={this.setPixelCount} \n              step={10000}\n              min={10000}\n            />\n          </Box>\n\n          <Box>\n            <NumberInput\n              label=\"Center x-coordinate\"\n              value={+this.state.current.cx} \n              onChange={this.setCX} \n              step={this.centerStep}\n            />\n          </Box>\n\n          <Box>\n            <NumberInput\n              label=\"Center y-coordinate\"\n              value={+this.state.current.cy} \n              onChange={this.setCY} \n              step={this.centerStep}\n            />\n          </Box>\n\n          <Box>\n            <NumberInput\n              label=\"Scale (pixels per unit)\"\n              value={+this.state.current.ppu} \n              onChange={this.setPPU} \n              step={10}\n              min={0}\n            />\n          </Box>\n\n          <ButtonGroup fullWidth color=\"primary\" orientation=\"vertical\">\n            <Button \n              onClick={this.apply}\n              disabled={!this.hasChanged()}\n            >Apply</Button>\n            <Button\n              onClick={this.revert}\n              disabled={!this.hasChanged()}\n            >Reset</Button>\n\n          </ButtonGroup>\n        </Box>\n      </Box>\n      </SettingsContainer>\n    )\n  }\n  \n}\n\nexport default connect(\n  (state: State) => ({\n    current: state.fractal.view,\n  }),\n  (dispatch: Dispatch) => ({\n    updateView: (update: Partial<ViewState>) => {\n      dispatch(updateView(update));\n      dispatch(redraw());\n    },\n  })\n)(ViewSettings)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { uploadData, redraw } from '../../store/actions';\nimport TextField from '@material-ui/core/TextField';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport { Icon } from '../../components';\nimport { withStyles } from '@material-ui/core/styles';\nimport { stateToJson, jsonToState, jsonToUrl, AppState, urlToJson } from '../../fractals/json';\nimport Link from '@material-ui/core/Link';\n\n\nconst JSONTextField = withStyles({\n  root: {\n    maxWidth: '240px',\n    '& textarea, input': {\n      fontFamily: 'roboto mono, monospace',\n      //'&[readonly]': {fontSize: '0.7em'},\n    },\n  },\n})(TextField)\n\n\ninterface Props {\n  currentJson: string,\n  currentURL: string,\n  uploadData: (data: AppState) => void,\n}\n\nclass JSONInterface extends React.Component<Props> {\n  state: {\n    jsonInput: string\n    parsedJson: AppState | undefined\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      jsonInput: '',\n      parsedJson: undefined,\n    }\n  }\n\n  onCopyJson = () => {\n    navigator.clipboard.writeText(this.props.currentJson);\n  }\n\n  onCopyLink = () => {\n    navigator.clipboard.writeText(this.props.currentURL);\n  }\n\n  onChangeJson = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    try {\n      const parsedJson = jsonToState(JSON.parse(evt.target.value));\n      this.setState({\n        jsonInput: evt.target.value,\n        parsedJson,\n      })\n    } catch {\n      try {\n        const data = urlToJson(evt.target.value.split('?').slice(-1)[0]);\n        if (data) {\n          const parsedJson = jsonToState(data);\n          this.setState({\n            jsonInput: evt.target.value,\n            parsedJson,\n          })\n        } else {\n          this.setState({jsonInput: evt.target.value, parsedJson: undefined});\n        }\n      } catch {\n        this.setState({jsonInput: evt.target.value, parsedJson: undefined});\n      }\n    }\n  }\n\n  onUploadJson = () => {\n    if (this.state.parsedJson) {\n      this.props.uploadData(this.state.parsedJson);\n    }\n  }\n\n  selectText = (evt: any) => {\n    evt.target.select();\n  }\n\n  render() {\n    return (\n      <Box m={2}>\n        <Box>\n          <Link \n            variant=\"body1\"\n            href={this.props.currentURL}>\n            Link to Current Fractal\n          </Link>\n        </Box>\n        <Box>\n          <JSONTextField\n            label=\"Current JSON\"\n            value={this.props.currentJson}\n            InputProps={{\n              onFocusCapture: this.selectText,\n              readOnly: true,\n            }}\n          />\n        </Box>\n        <Box>\n          <JSONTextField \n            label=\"Load from URL or JSON\"\n            onChange={this.onChangeJson}\n            value={this.state.jsonInput}\n            InputProps={{\n              endAdornment: (\n                <InputAdornment position=\"end\">\n                  <IconButton onClick={this.onUploadJson} disabled={!this.state.parsedJson} title=\"load data into viewer\">\n                    <Icon.Upload/>\n                  </IconButton>\n                </InputAdornment>\n              )\n            }}\n            />\n        </Box>\n\n      </Box>\n    )\n  }\n}\n\n\n\nexport default connect(\n  (state: State) => {\n    const data = stateToJson(state.fractal);\n    return ({\n      currentJson: JSON.stringify(data),\n      currentURL: jsonToUrl(data),\n    });\n  },\n  (dispatch: Dispatch) => ({\n    uploadData: (data: AppState) => {\n      dispatch(uploadData(data));\n      dispatch(redraw());\n    },\n  })\n)(JSONInterface)","import SettingsMenu from './SettingsMenu'\n\nexport default SettingsMenu","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State as AppState, Dispatch } from '../../store/types';\nimport { FractalState, DrawState } from '../../store/fractal/types';\nimport { setCenter, redraw, finish } from '../../store/actions';\nimport { StretchMode, Nav } from '../../store/ui/types';\nimport { FractalDrawer } from '../../fractals';\nimport Box from '@material-ui/core/Box';\nimport styles from './Canvas.module.css';\n\n\ntype Props = {\n  visible: boolean\n  fractal: FractalState\n  stretch: StretchMode\n  setCenter: (x: number, y: number) => void\n  finishDrawing: () => void\n}\n\nclass Canvas extends React.Component<Props> {\n  drawer: FractalDrawer\n  canvasRef: React.RefObject<HTMLCanvasElement>\n\n  constructor(props: Props) {\n    super(props);\n    this.drawer = new FractalDrawer();\n    this.drawer.fullResolution = false;\n    this.canvasRef = React.createRef();\n  }\n\n  get canvas() {\n    return this.canvasRef.current as HTMLCanvasElement\n  }\n\n  draw() {\n    this.drawer.draw(this.props.fractal);\n    this.drawer.putOnCanvas(this.canvas)\n    this.props.finishDrawing()\n  }\n\n  componentDidMount() {\n    if (this.canvas) {\n      this.draw()\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.props.fractal.drawState === DrawState.Draw) {\n      this.draw()\n    }\n    else if (this.props.fractal.drawState === DrawState.Color) {\n      // cant recolor without recalculating anymore\n      this.draw();\n    }\n  }\n\n  centerOnClick = (evt: any) => {\n    if (this.props.setCenter) {\n      if (this.canvas) {\n        const {h, w, ppu, cx, cy} = this.props.fractal.view;\n        let {width, height} = this.canvas.getBoundingClientRect();\n        let {offsetX, offsetY} = evt.nativeEvent;\n\n        if (this.props.stretch === StretchMode.Contain) {\n          const ww = width / w;\n          const hh = height / h;\n          if (hh > ww) {\n            const imageH = h * ww;\n            offsetY -= (height - imageH) / 2\n            height = imageH\n          } else if (ww > hh) {\n            const imageW = w * hh;\n            offsetX -= (width - imageW) / 2\n            width = imageW\n          }\n        }\n\n        const pixel_x = Math.round((offsetX / width) * w);\n        const pixel_y = Math.round((offsetY / height) * h);\n        const dx = (pixel_x - (w / 2)) / ppu;\n        const dy = (pixel_y - (h / 2)) / ppu;\n        this.props.setCenter(cx + dx, cy - dy);\n      }\n    }\n  }\n\n  render() {\n    const outerClasses = [styles.Outer]\n    let objectFit: 'contain' | 'cover' | undefined\n    const outerstyle = this.props.visible ? {} : {display: 'none'}\n    switch (this.props.stretch) {\n      case StretchMode.Contain:\n        objectFit = 'contain';\n        outerClasses.push(styles.Stretch);\n        break;\n      case StretchMode.Cover:\n        objectFit = 'cover';\n        outerClasses.push(styles.Stretch);\n        break;\n    }\n\n    return (\n      <Box m={0} className={outerClasses.join(' ')} style={outerstyle}>\n\n          <canvas\n            id=\"fractal-preview-canvas\"\n            className={styles.Canvas}\n            ref={this.canvasRef}\n            onDoubleClick={this.centerOnClick}\n            style={{objectFit}}\n          />\n      </Box>\n    )\n  }\n}\n\n\nexport default connect(\n  (state: AppState) => ({\n    visible: (state.ui.nav === Nav.Params || state.ui.nav === Nav.Explore),\n    fractal: state.fractal,\n    stretch: state.ui.canvasStretch,\n  }),\n  (dispatch: Dispatch) => ({\n    setCenter: (x: number, y: number) => {\n      dispatch(setCenter(x, y));\n      dispatch(redraw());\n    },\n    finishDrawing: () => dispatch(finish()),\n  })\n)(Canvas)","import Canvas from './Canvas';\n\n\nexport default Canvas;","import React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport { withStyles, Theme } from '@material-ui/core/styles';\nimport Toolbar from '@material-ui/core/Toolbar';\n\ntype Props = {\n  visible: boolean\n}\n\nconst Outside = withStyles((theme: Theme) => ({\n  root: {\n    //position: 'absolute',\n    bottom: '0',\n    width: '100%',\n    backgroundColor: theme.palette.background.default + '99',\n  }\n}))(Paper);\n\nconst Inside = withStyles({\n  root: {\n    display: 'flex',\n    flexFlow: 'row wrap',\n    alignItems: 'center',\n    justifyContent: 'space-around',\n    paddingBottom: '0.7em',\n    paddingTop: '0.3em',\n  }\n})(Toolbar)\n\n\nfunction ControlPanel(props: React.PropsWithChildren<Props>) {\n\n  return (\n    <Outside elevation={0} style={props.visible ? {} : {display: 'none'}}>\n      <Inside>\n        {props.children}\n      </Inside>\n    </Outside>\n  )\n}\n\nexport default ControlPanel","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { Nav } from '../../store/ui/types';\nimport { GalleryState } from '../../store/gallery/types';\nimport { deleteImage, uploadJson, redraw, setNav } from '../../store/actions';\nimport GridList from '@material-ui/core/GridList';\nimport GridListTile from '@material-ui/core/GridListTile';\nimport GridListTileBar from '@material-ui/core/GridListTileBar';\nimport Box from '@material-ui/core/Box';\nimport { Icon } from '../../components';\nimport IconButton from '@material-ui/core/IconButton';\nimport Popover from '@material-ui/core/Popover';\nimport { withStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Link from '@material-ui/core/Link';\nimport { jsonToUrl, JsonState } from '../../fractals/json';\n\nconst StyledGridList = withStyles({\n  root: {\n    padding: '3px',\n    paddingTop: '20px',\n  },\n})(GridList)\n\nconst StyledGridListTile = withStyles({\n  root: {\n    maxWidth: '200px',\n    maxHeight: '200px',\n    margin: '1mm',\n  },\n  tile: {\n    width: '200px',\n    height: '200px',\n  },\n})(GridListTile);\n\nconst StyledIconButton = withStyles({\n  root: {\n    color: 'rgba(255,255,255,0.5)',\n    '& :hover': {\n      color: 'rgba(255,255,255,1)',\n    }\n  }\n})(IconButton)\n\n\ninterface TileProps {\n  title: string,\n  url: string,\n  onView: () => void,\n}\n\nfunction ImageTile(props: TileProps) {\n  const title = props.title;\n  return (\n    <StyledGridListTile key={title} cols={1}>\n      <img \n        src={props.url}\n        alt={title} \n        style={{objectFit: 'cover'}}/>\n      <GridListTileBar\n        title={title}\n        actionIcon={\n          <>\n            <StyledIconButton onClick={props.onView}>\n              <Icon.ViewImage/>\n            </StyledIconButton>\n          </>\n        }\n      />\n    </StyledGridListTile>\n  )\n}\n\n\ninterface Props {\n  images: GalleryState\n  visible: boolean\n  deleteImage: (url: string | null) => void\n  loadJson: (data: JsonState) => void\n}\n\n\nenum Popup {\n  None,\n  Delete,\n  JSON,\n  Link,\n}\n\n\nclass Gallery extends React.Component<Props> {\n  state: {\n    current: {\n      url: string,\n      title: string,\n      data: JsonState,\n    } | null,\n    popup: Popup\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      current: null,\n      popup: Popup.None,\n    };\n  }\n\n  close = () => {\n    this.setState({current: null, popup: Popup.None});\n  }\n  \n  closePopup = () => {\n    this.setState({popup: Popup.None})\n  }\n\n  openDelete = () => {\n    this.setState({popup: Popup.Delete})\n  }\n\n  onDelete = () => {\n    if (this.state.current) {\n      this.props.deleteImage(this.state.current.url);\n      this.close();\n    }\n  }\n\n  onDownload = () => {\n    if (this.state.current) {\n      const a = document.createElement('a')\n      a.download = this.state.current.title + '.png';\n      a.href = this.state.current.url;\n      a.click();\n    }\n  }\n\n  onLoad = () => {\n    if (this.state.current) {\n      this.props.loadJson(this.state.current.data);\n      this.close();\n    }\n  }\n\n  linkUrl() {\n    if (this.state.current) {\n      return jsonToUrl(this.state.current.data);\n    }\n  }\n\n  viewer = (tile: {url: string, data: JsonState, title: string}) => () => {\n    this.setState({current: tile});\n  }\n\n  render() {\n\n    return (\n      <>\n      <StyledGridList \n        cellHeight={180} \n        style={this.props.visible ? {} : {display: 'none'}}\n      >\n        {this.props.images.map((tile, index) => {\n          return React.createElement(ImageTile, {\n            ...tile,\n            key: tile.url,\n            onView: this.viewer(tile),\n          });\n        })}\n      </StyledGridList>\n      <Popover\n        open={this.state.current !== null}\n        onClose={this.close}>\n        <Box style={{position: 'relative'}}>\n          <Toolbar>\n            <IconButton onClick={this.close} title=\"close\" edge=\"start\">\n              <Icon.Back/>\n            </IconButton>\n            <IconButton onClick={this.openDelete} title=\"delete image\">\n              <Icon.Delete/>\n            </IconButton>\n            <IconButton onClick={this.onLoad} title=\"load in fractal viewer\">\n              <Icon.Upload/>\n            </IconButton>\n            <IconButton onClick={this.onDownload} title=\"download image\">\n              <Icon.Save/>\n            </IconButton>\n            <Link href={this.linkUrl()} variant=\"subtitle1\" style={{marginLeft: '1em'}}>Direct Link</Link>\n          </Toolbar>\n          <img \n            alt=\"fractal\"\n            src={this.state.current?.url || ''}\n            style={{\n              objectFit: 'contain', \n              maxWidth: '100%', \n              maxHeight: '100%'\n            }}/>\n          \n        </Box>\n        <Popover\n          open={this.state.popup === Popup.Delete}\n          onClose={this.close}\n        >\n          <Box m={2}>\n            <Typography>Delete this image?</Typography>\n            <ButtonGroup color=\"primary\" variant=\"outlined\">\n              <Button onClick={this.onDelete}>Yes</Button>\n              <Button onClick={this.closePopup}>No</Button>\n            </ButtonGroup>\n          </Box>\n        </Popover>\n      </Popover>\n\n      </>\n    )\n  }\n}\n\n\nexport default connect(\n  (state: State) => ({\n    visible: state.ui.nav === Nav.Gallery,\n    images: state.gallery,\n  }),\n  (dispatch: Dispatch) => ({\n    deleteImage: (url: string | null) => {\n      if (url) dispatch(deleteImage(url));\n    },\n    loadJson: (data: JsonState) => {\n      dispatch(uploadJson(data));\n      dispatch(redraw());\n      dispatch(setNav(Nav.Explore))\n    }\n  })\n)(Gallery)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { FractalState, DrawState } from '../../store/fractal/types';\nimport { capture, finish, addToGallery, startWaiting } from '../../store/actions';\nimport { Nav } from '../../store/ui/types';\nimport Cropper from 'react-easy-crop';\nimport Box from '@material-ui/core/Box';\nimport { withStyles } from '@material-ui/core/styles';\nimport ControlPanel from '../Controls/ControlPanel';\nimport IconButton from '@material-ui/core/IconButton';\nimport FractalDrawer, { linearScale, scaleDown, DrawerView } from '../../fractals/FractalDrawer';\nimport { stateToJson, JsonState } from '../../fractals/json';\nimport { Icon, NumberInput } from '../../components';\nimport { captureSize } from '../../defaults';\nimport Fab from '@material-ui/core/Fab';\n\nconst CropContainer = withStyles({\n  root: {\n    position: 'relative',\n    display: 'flex',\n    height: '100%',\n    width: '100%',\n  }\n})(Box);\n\ninterface Crop {x: number, y: number}\ninterface Area extends Crop {width: number, height: number}\n\ninterface CropperProps {\n  crop: Crop\n  zoom: number\n}\n\ninterface Props {\n  visible: boolean\n  fractal: FractalState\n  addToGallery: (image: string, data: JsonState, title: string) => void\n  startCapture: () => void\n  finishCapture: () => void\n}\n\n\nclass Capture extends React.Component<Props> {\n  state: CropperProps & {\n    image: string | null,\n    w: number,\n    h: number,\n  }\n  cropPixels: Area\n  drawer: FractalDrawer\n  data: JsonState\n  shouldRedraw: boolean\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      ...captureSize,\n      crop: {x: 0, y: 0},\n      zoom: 1,\n      image: null,\n    }\n    this.cropPixels = {x: 0, y: 0, width: captureSize.w, height: captureSize.h}\n    this.drawer = new FractalDrawer();\n    this.drawer.fullResolution = true;\n    this.data = stateToJson(props.fractal);\n    this.shouldRedraw = false;\n  }\n\n  setW = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    const w = +evt.target.value;\n    this.setState({w, aspect: w / this.state.h});\n  }\n\n  setH = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    const h = +evt.target.value;\n    this.setState({h, aspect: this.state.w / h});\n  }\n\n  swapWH = () => {\n    this.setState({\n      w: this.state.h,\n      h: this.state.w,\n    })\n  }\n\n  getImage = () => {\n    const cvs = document.getElementById('fractal-preview-canvas') as HTMLCanvasElement;\n    if (cvs) {\n      const image =  cvs.toDataURL();\n      this.setState({ image })\n    }\n  }\n\n  onCropChange = (crop: Crop) => this.setState({crop});\n  onCropComplete = (area: Area, areaPixels: Area) => {\n    this.cropPixels = areaPixels;\n  }\n  onZoomChange = (zoom: number) => this.setState({zoom});\n\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.visible) {\n      if (!prevProps.visible || (this.shouldRedraw && this.props.fractal.drawState === DrawState.None)) {\n        this.getImage();\n        this.shouldRedraw = false;\n      }\n      else if (this.props.fractal.drawState === DrawState.Draw || this.props.fractal.drawState === DrawState.Color) {\n        this.shouldRedraw = true;\n      }\n    }\n    if (this.props.fractal.drawState === DrawState.Capture) {\n      setTimeout(this.capture, 500);\n    }\n  }\n\n  determineView(): DrawerView {\n    const {cx, cy, w, h, ppu} = {...this.props.fractal.view, ...scaleDown(this.props.fractal.view)};\n    const rx = w / ppu / 2;\n    const ry = h / ppu / 2;\n    const xscale = linearScale([0, w], [cx - rx, cx + rx]);\n    const yscale = linearScale([h, 0], [cy - ry, cy + ry]);\n\n    const {x, y, width, height} = this.cropPixels;\n\n    return {\n      x: [xscale(x), xscale(x+width)] as [number,number],\n      y: [yscale(y), yscale(y+height)] as [number,number],\n      w: this.state.w,\n      h: this.state.h,\n    }\n  }\n\n  setData(view: any) {\n    const newview = {\n      cx: (view.x[0] + view.x[1]) / 2,\n      cy: (view.y[0] + view.y[1]) / 2,\n      w: view.w,\n      h: view.h,\n      ppu: Math.round(view.w / (view.x[1] - view.x[0]))\n    };\n\n    this.data = stateToJson({\n      ...this.props.fractal,\n      view: {...this.props.fractal.view, ...newview},\n    })\n  }\n\n\n  saveImage() {\n    this.drawer.toURL(url => {\n      const title = 'fract' + Math.floor((Date.now() - new Date(2020,0,25).getTime())/1000).toString(16)\n      this.props.addToGallery(url, this.data, title);\n    })\n  }\n\n  capture = () => {\n    const view = this.determineView();\n    this.drawer.draw({\n      ...this.props.fractal,\n      view,\n    })\n    this.setData(view);\n    this.saveImage();\n    this.props.finishCapture();\n  }\n\n  onClick = () => {\n    this.props.startCapture();\n  }\n\n  render() {    \n    return (\n      <>\n      <CropContainer style={this.props.visible ? {} : {display: 'none'}} >\n        <Cropper\n          image={this.state.image || ''}\n          crop={this.state.crop}\n          zoom={this.state.zoom}\n          aspect={this.state.w / this.state.h}\n          onCropChange={this.onCropChange}\n          onCropComplete={this.onCropComplete}\n          onZoomChange={this.onZoomChange}\n        />\n      </CropContainer>\n      <ControlPanel visible={this.props.visible}>\n\n          <Box>\n            <NumberInput\n              value={this.state.w}\n              label=\"width\"\n              onChange={this.setW}\n              min={0}\n              step={10}\n              inputProps={{style: {maxWidth: '4em'}}}\n            />\n          </Box>\n\n          <IconButton onClick={this.swapWH} title=\"swap width and height\">\n            <Icon.SwapHoriz />\n          </IconButton>\n\n          <Box>\n            <NumberInput\n              value={this.state.h}\n              label=\"height\"\n              onChange={this.setH}\n              min={0}\n              step={10}\n              inputProps={{style: {maxWidth: '4em'}}}\n            />\n          </Box>\n\n          <Fab onClick={this.onClick} color=\"primary\" title=\"render selected area\">\n            <Icon.AddAPhoto/>\n          </Fab>\n\n      </ControlPanel>\n      </>\n    )\n  }\n}\n\n\nexport default connect(\n  (state: State) => ({\n    visible: state.ui.nav === Nav.Capture,\n    fractal: state.fractal,\n  }),\n  (dispatch: Dispatch) => ({\n    addToGallery: (image:string, data: JsonState, title: string) => dispatch(addToGallery(image, data, title)),\n    startCapture: () => {\n      dispatch(startWaiting());\n      dispatch(capture());\n    },\n    finishCapture: () => dispatch(finish()),\n  }),\n)(Capture);","import Capture from './Capture';\n\nexport default Capture;","import React from 'react';\nimport { connect } from 'react-redux';\nimport { zoomIn, zoomOut, redraw } from '../../store/actions';\nimport DownUpButtons, { DownUpButtonsProps } from '../../components/DownUpButtons';\nimport { Icon } from '../../components';\n\ninterface NewProps {\n  factor?: number\n  label?: string\n  fontSize?: 'small' | 'default' | 'large' | 'inherit'\n  zoomIn: (n: number) => void\n  zoomOut: (n: number) => void\n}\n\ninterface Props extends NewProps, Omit<DownUpButtonsProps, 'onUp' | 'onDown'> {}\n\nconst Zoom = ({factor=2, zoomIn, zoomOut, ...rest}: Props) => {\n  const zin = () => zoomIn(factor);\n  const zout = () => zoomOut(factor);\n  \n  return (\n    <DownUpButtons \n      {...rest}\n      onUp={zin} \n      onDown={zout} \n      downIcon={Icon.ZoomOut} \n      upIcon={Icon.ZoomIn}\n    />\n  )\n}\n\n\n\nexport default connect(\n  null,\n  (dispatch: any) => ({\n    zoomIn: (n: number) => {\n      dispatch(zoomIn(n));\n      dispatch(redraw());\n    },\n    zoomOut: (n: number) => {\n      dispatch(zoomOut(n));\n      dispatch(redraw());\n    }\n  })\n)(Zoom)","import React from 'react';\nimport { connect } from 'react-redux';\nimport {\n  NumberIncrementer,\n  ComplexIncrementer,\n } from '../../components';\nimport {\n  ControlProps, ControlType, Params, \n  ControlNumber, ControlComplex, ControlCall,\n} from '../../fractals/algorithm/types'\nimport Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\nimport { Icon } from '../../components';\nimport { State, Dispatch } from '../../store/types';\nimport { fractal } from '../../fractals';\nimport { updateParams, redraw } from '../../store/actions';\n\n\ninterface Props {\n  controls: ControlProps[]\n  params: Params\n  onChange: (x: Params) => void\n}\n\nclass ParamControls extends React.Component<Props> {\n\n  paramUpdater = (k: string) => {\n    return (v: any) => {\n      //console.log(\"setting \" + k + ' => ' + v);\n      this.props.onChange({[k]: v});\n    }\n  }\n\n  renderNumberIncrementer(x: ControlNumber) {\n    const {param} = x;\n    return (\n      <NumberIncrementer\n        key={'number-'+param}\n        controlProps={x}\n        value={this.props.params[param]}\n        onChange={this.paramUpdater(param)}\n      />\n    )\n  }\n\n  renderComplexIncrementer(x: ControlComplex) {\n    const {param} = x;\n    return (\n      <ComplexIncrementer\n        key={'complex-'+param}\n        controlProps={x}\n        value={this.props.params[param]}\n        onChange={this.paramUpdater(param)}\n      />\n    )\n  }\n\n  renderCall(x: ControlCall) {\n    const {icon, label} = x;\n    if (label && icon === 'Random') {\n      return (\n        <Button\n          key={'action-'+label}\n          variant=\"outlined\"\n          color=\"inherit\"\n          size=\"small\"\n          onClick={() => this.props.onChange(x.onCall())}\n          startIcon={<Icon.Random/>}\n        >{x.label}</Button>\n      )\n    }\n    if (!label && icon === 'Random') {\n      return (\n        <IconButton key={'action-'+icon} onClick={() => this.props.onChange(x.onCall())}>\n          <Icon.Random/>\n        </IconButton>\n      )\n    }\n    if (label) {\n      return (\n        <Button\n          key={'action-'+label}\n          variant=\"outlined\"\n          size=\"small\"\n          onClick={() => this.props.onChange(x.onCall())}\n        >{x.label}</Button>\n      )\n    }\n  }\n\n  renderControl(x: ControlProps) {\n    if (x.type === ControlType.Number) {\n      return this.renderNumberIncrementer(x);\n    }\n    if (x.type === ControlType.Complex) {\n      return this.renderComplexIncrementer(x);\n    }\n    if (x.type === ControlType.Call) {\n      return this.renderCall(x);\n    }\n    return null;\n  }\n\n\n  render() {\n    return (\n      <>\n        {this.props.controls.map(x => this.renderControl(x))}\n      </>\n    )\n  }\n}\n\nexport default connect(\n  (state: State) => ({\n    controls: [...fractal(state.fractal.algorithm).controls],\n    params: {...state.fractal.algorithm.params},\n  }),\n  (dispatch: Dispatch) => ({\n    onChange: (x: Params) => {\n      dispatch(updateParams(x));\n      dispatch(redraw());\n    },\n  })\n)(ParamControls)","import { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { ControlType, ControlNumber } from '../../fractals/algorithm/types';\nimport { redraw, updateParams } from '../../store/actions';\nimport { NumberIncrementer}  from '../../components';\n\nexport default connect(\n  (state: State) => ({\n    value: state.fractal.algorithm.params.iter,\n    controlProps: {\n      type: ControlType.Number,\n      param: 'iter',\n      label: 'iterations',\n      step: 2,\n      min: 0,\n    } as ControlNumber\n  }),\n  (dispatch: Dispatch) => ({\n    onChange: (iter: number) => {\n      dispatch(updateParams({iter}));\n      dispatch(redraw());\n    }\n  })\n)(NumberIncrementer)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State } from '../../store/types'; \nimport { Nav } from '../../store/ui/types';\nimport Zoom from './Zoom';\nimport ParamControls from './ParamControls';\nimport Iterator from './Iterator';\nimport ControlPanel from './ControlPanel';\n\ntype Props = {\n  nav: Nav,\n}\n\nclass Controls extends React.Component<Props> {\n\n  render() {\n    return (\n      <>\n        <ControlPanel visible={this.props.nav === Nav.Params}>\n          <ParamControls/>\n        </ControlPanel>\n        <ControlPanel visible={this.props.nav === Nav.Explore}>\n          <Iterator fontSize=\"large\"/>\n          <Zoom factor={2} fontSize=\"large\" label=\"Zoom\"/>\n        </ControlPanel>\n      </>\n    )\n  }\n}\n\nexport default connect(\n  (state: State) => ({nav: state.ui.nav}),\n)(Controls)","import Controls from './Controls';\n\nexport default Controls;","import Gallery from './Gallery';\n\nexport default Gallery;","import React from 'react'\nimport Canvas from './Canvas';\nimport Capture from './Capture';\nimport Controls from './Controls';\nimport Box from '@material-ui/core/Box';\nimport Gallery from './Gallery';\nimport { makeStyles } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles({\n  root: {\n    position: 'absolute',\n    overflow: 'clip',\n    display: 'flex',\n    flexDirection: 'column',\n    flexGrow: 1,\n    top: '50px',\n    bottom: '55px',\n    width: '100%',\n    //paddingTop: '50px'\n  }\n});\n\nexport default function Display() {\n  const classes = useStyles();\n\n  return (\n    <Box className={classes.root}>\n      <Canvas/>\n      <Capture/>\n      <Gallery/>\n      <Controls/>\n    </Box>\n  )\n};","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State as AppState, Dispatch } from '../../store/types';\nimport { setModal } from '../../store/actions';\nimport { Modal } from '../../store/ui/types';\nimport { TypographyWithMath } from '../../components';\nimport Button, { ButtonProps } from '@material-ui/core/Button';\nimport { withStyles } from '@material-ui/core/styles';\nimport { fractal } from '../../fractals';\n\n\nconst KatexButton = withStyles({\n  label: {textTransform: 'none'},\n})(Button)\n\nconst InfoButton = ({formula, ...rest}: {\n  formula: string | {math: string} | (string | {math: string})[]\n} & ButtonProps) => (\n  <KatexButton {...rest}>\n    <TypographyWithMath data={formula}/>\n  </KatexButton>\n)\n\nexport default connect(\n  (state: AppState) => {\n    const formula = fractal(state.fractal.algorithm).label;\n    return {\n      disabled: state.ui.modal === Modal.Info,\n      formula,\n    }\n  },\n  (dispatch: Dispatch) => ({\n    onClick: () => dispatch(setModal(Modal.Info))\n  })\n)(InfoButton)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Dispatch } from '../../store/types';\nimport { recenter, redraw } from '../../store/actions';\nimport IconButton, { IconButtonProps } from '@material-ui/core/IconButton';\nimport { Icon } from '../../components';\n\nconst RecenterButton = (props: IconButtonProps) => (\n  <IconButton {...props} title=\"recenter image at origin\">\n    <Icon.Recenter/>\n  </IconButton>\n)\n\nexport default connect(\n  null,\n  (dispatch: Dispatch) => ({\n    onClick: () => {\n      dispatch(recenter());\n      dispatch(redraw());\n    }\n  }),\n)(RecenterButton)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../store/types';\nimport { setModal } from '../store/actions';\nimport { Modal, Nav } from '../store/ui/types';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport { Icon } from '../components'\nimport InfoButton from './Controls/InfoButton';\nimport RecenterButton from './Controls/Recenter';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles({\n  toolbar: {\n    justifyContent: 'flex-start',\n  },\n  gallery: {\n    flexGrow: 1,\n    textAlign: 'center',\n  },\n  formula: {},\n  recenter: {},\n  Params: {\n    '& $gallery': {display: 'none'},\n  },\n  Explore: {\n    '& $gallery': {display: 'none'},\n  },\n  Capture: {\n    '& $gallery': {display: 'none'},\n    '& $recenter': {display: 'none'}\n  },\n  Gallery: {\n    '& $formula': {display: 'none'},\n    '& $recenter': {display: 'none'},\n  },\n})\n\n\nfunction TopBar(props: {\n  nav: Nav,\n  disableMenu: boolean,\n  openMenu: () => void,\n}) {\n  const classes = useStyles();\n  const rootClass = \n    props.nav === Nav.Params ? 'Params' : \n    props.nav === Nav.Explore ? 'Explore' :\n    props.nav === Nav.Capture ? 'Capture' :\n    'Gallery';\n  return (\n    <AppBar position=\"static\" elevation={0}>\n      <Toolbar className={classes.toolbar + ' ' + classes[rootClass]}>\n        <IconButton onClick={props.openMenu} edge=\"start\">\n          <Icon.Menu/>\n        </IconButton>\n        <InfoButton \n          className={classes.formula} \n          title=\"algorithm information\"\n          style={{marginLeft: 'auto', marginRight: 'auto'}}\n        />\n        <Typography className={classes.gallery}>Saved Fractals</Typography>\n        <RecenterButton className={classes.recenter}/>\n      </Toolbar>\n    </AppBar>\n  );\n}\n\nexport default connect(\n  (state: State) => ({\n    nav: state.ui.nav,\n    disableMenu: state.ui.modal === Modal.Menu,\n  }),\n  (dispatch: Dispatch) => ({\n    openMenu: () => dispatch(setModal(Modal.Menu)),\n  }),\n)(TopBar);","import React from 'react';\nimport { connect } from 'react-redux';\nimport Katex from '../components/Katex';\nimport { State as AppState, Dispatch } from '../store/types';\nimport { setModal } from '../store/actions';\nimport { Modal } from '../store/ui/types';\nimport { AlgorithmState } from '../store/fractal/algorithm/types';\nimport { TypographyWithMath } from '../components';\nimport Box from '@material-ui/core/Box';\nimport Paper from '@material-ui/core/Paper';\nimport Popover from '@material-ui/core/Popover';\nimport Typography from '@material-ui/core/Typography';\nimport { fractal } from '../fractals';\nimport { withStyles, createStyles, WithStyles, Theme } from '@material-ui/core/styles';\n\n\nconst styles = createStyles((theme: Theme) => ({\n  text: {\n    fontSize: '1em',\n  }\n}))\n\n\nfunction rounder(p: number) {\n  const d = Math.pow(10, p);\n  return (n: number) => Math.round(n * d) / d;\n}\n\nfunction science(n: number, p: number=4) {\n  const a = n.toPrecision(4);\n  const b = a.split('e')\n  if (b.length === 1) {\n    return a;\n  } else {\n    return b[0] + '\\\\times 10^{' + b[1] + '}'\n  }\n}\n\ninterface Props {\n  visible: boolean\n  anchorEl?: HTMLElement\n  onClose: () => void\n  cx: number\n  cy: number\n  rx: number\n  ry: number\n  algorithm: AlgorithmState<object>\n}\n\ninterface PP extends Props, WithStyles<typeof styles> {}\n\n\nconst FractalInfo = (props: PP) => {\n\n  const {algorithm} = props;\n  const fractalinfo = fractal(algorithm).describe;\n\n  const round = rounder(3-Math.floor(Math.log10(props.rx)))\n\n  const cx = round(props.cx)\n  const cy = round(props.cy)\n\n  const rx = science(Math.abs(props.rx))\n  const ry = science(Math.abs(props.ry))\n\n  const centerx = 'x_c = ' + cx\n  const centery = 'y_c = ' + cy\n  const domainx = '|x - x_c| \\\\leq ' + rx \n  const domainy = '|y - y_c| \\\\leq ' + ry \n\n  const classes = props.classes as {text: string};\n\n  return (\n    <Popover\n      open={props.visible}\n      onClose={props.onClose}\n      marginThreshold={10}\n    >\n      <Paper >\n        <Box p={2} onClick={props.onClose}>\n          <TypographyWithMath data={fractalinfo} className={classes.text}/>\n          <Typography style={{marginTop: '1em'}} className={classes.text}>\n            The currently displayed portion of this fractal is centered\n            at <Katex math=\"(x_c, y_c)\"/>, where\n          </Typography>\n          <Katex math={centerx + '\\\\text{ and }' + centery} displayMode={true} className={classes.text}/>\n          <Typography className={classes.text}>\n            and plotted over <Katex math=\"(x, y)\"/> such that \n          </Typography>\n          <Katex math={domainx + '\\\\text{ and }' + domainy} displayMode={true} className={classes.text}/>\n        </Box>\n      </Paper>\n    </Popover>\n  )\n}\n\nexport default connect(\n  (state: AppState) => {\n    const {cx, cy, ppu, w, h} = state.fractal.view;\n    const rx = w/ppu/2, ry = h/ppu/2;\n    return {\n      visible: state.ui.modal === Modal.Info,\n      cx: cx,\n      cy: cy,\n      rx: rx,\n      ry: ry,\n      algorithm: state.fractal.algorithm,\n    }\n  },\n  (dispatch: Dispatch) => ({\n    onClose: () => dispatch(setModal(Modal.None))\n  })\n)(withStyles(styles)(FractalInfo))","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State } from '../store/types';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Modal from '@material-ui/core/Modal';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  typography: {\n    color: 'white',\n  },\n  progress: {\n    outline: 'none',\n  }\n})\n\ninterface Props {\n  open: boolean\n}\n\nfunction Waiting({open}: Props) {\n  const classes = useStyles();\n  return (\n    <Modal open={open} className={classes.root}>\n      <>\n      <CircularProgress className={classes.progress}/>\n      <Typography className={classes.typography}>Rendering Image</Typography>\n      </>\n    </Modal>\n  )\n}\n\nexport default connect(\n  (state: State) => ({open: state.ui.waiting}),\n)(Waiting);","import React from 'react';\nimport BottomBar from './Bottombar';\nimport Settings from './Settings';\nimport Display from './Display';\nimport TopBar from './TopBar';\nimport Info from './Info';\nimport Waiting from './Waiting';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    height: '100%',\n    flexDirection: 'column',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    position: 'absolute',\n    overflow: 'hidden',\n    justifyContent: 'space-between',\n  }\n}))\n\n\nexport default function App() {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <Waiting/>\n      <Display/>\n      <TopBar />\n      <Settings />\n      <Info />\n      <BottomBar />\n    </div>\n  )\n}","import React from 'react';\nimport { Provider } from 'react-redux';\nimport Theme from './Theme';\nimport { Store } from 'redux';\nimport App from './App';\nimport { State as AppState, Action as AppAction } from '../store/types';\n\ntype Props = {\n  store: Store<Partial<AppState>, AppAction>\n}\n\nexport default class Root extends React.Component<Props> {\n  render() {\n    const { store } = this.props;\n    return (\n      <Provider store={store}>\n        <Theme>\n          <App/>\n        </Theme>\n      </Provider>\n    )\n  }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Root from './containers/Root';\nimport store from './store';\nimport { uploadUrl } from './store/fractal/actions';\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\nrequire('./console');\n\n\nstore.dispatch(uploadUrl(window.location.search));\n\nReactDOM.render(<Root store={store} />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n\nserviceWorker.register();","import { FractalCommands, Params } from './types';\nimport { JsonState } from '../../fractals/json';\nimport { ColorState } from '../../store/fractal/color/types';\nimport { ViewState } from '../../store/fractal/view/types';\nimport { COLORSCHEMES } from '../../fractals';\n\nabstract class Base implements FractalCommands {\n  abstract updateParams(p: Params): void\n  abstract setParam(k: string, v: any): void\n  abstract getParams(): Params\n  abstract redraw(): void\n  abstract setMethod(methodName: string): void\n  abstract getMethod(): string\n  abstract loadJson(data: JsonState): void\n  abstract recenter(): void\n  abstract zoom(factor: number): void\n  abstract setCenter(x: number, y: number): void\n  abstract _updateColor(color: Partial<ColorState>): void\n  abstract _updateView(view: Partial<ViewState>): void\n  abstract animate(start: number, stop: number, frames?: number, opts?: {\n    incl?: boolean,\n    ms?: number,\n  }): (f: (n: number) => Params) => any\n\n  rotateParam(k: string, {\n    frames=30, \n    center=[0,0],\n    angle=Math.PI*2,\n    incl=true,\n    ms=0\n  }: {\n    frames?: number,\n    center?: [number,number],\n    angle?: number,\n    incl?: boolean,\n    ms?: number,\n  }={}) {\n    const [x0, y0]: [number, number] = this.getParam(k);\n    const [cx, cy] = center;\n    const dx = x0 - cx;\n    const dy = y0 - cy;\n    const a0 = Math.atan2(dy, dx);\n    const r0 = Math.sqrt(dx*dx + dy*dy);\n    function setAngle(rad: number) {\n      const a1 = a0 + rad;\n      const x1 = cx + r0 * Math.cos(a1);\n      const y1 = cy + r0 * Math.sin(a1);\n      return {[k]: [x1, y1]}\n    }\n    return this.animate(0, angle, frames, {incl, ms})(setAngle)\n  }\n\n  getParam(k: string) {\n    return this.getParams()[k];\n  }\n\n  setColorScheme(schemeName: string, opts?: {skew?: number, reverse?: boolean}) {\n    const scheme = COLORSCHEMES[schemeName];\n    if (scheme) {\n      this._updateColor({\n        scheme,\n        schemeName,\n        ...opts,\n      });\n    } else {\n      console.error('unknown schemeName:', schemeName)\n    }\n  }\n\n}\n\nexport default Base","\nfunction* rangeGen(start: number, stop: number, frames: number, includeStart: boolean=true): Generator<number,void> {\n  const d = stop - start;\n  if (includeStart) {\n    for (let i = 0; i < frames; i++) {\n      yield start + d*(i / (frames-1))\n    }\n  } else {\n    for (let i = 1; i <= frames; i++) {\n      yield start + d*(i / frames)\n    }\n  }\n}\n\n\nexport function promiseGenerator<T>(gen: Generator<T>, f: (x: T) => void, ms: number) {\n  const x = gen.next();\n  if (x.done) {\n    return new Promise(resolve => { resolve(x) })\n  } else {\n    f(x.value)\n    return new Promise(resolve => {\n      setTimeout(() => resolve(promiseGenerator(gen, f, ms)), ms)\n    })\n  }\n}\n\nexport function animator(start: number, stop: number, frames: number=10, inclusive: boolean=true) {\n  return (f: (n: number) => void, ms: number=0) => {\n    return promiseGenerator(rangeGen(start, stop, frames, inclusive), f, ms);\n  }\n}\n","import reduxStore from '../../store';\nimport * as reduxAction from '../../store/actions';\nimport { Action } from '../../store/types';\nimport { FractalState } from '../../store/fractal/types';\nimport { ColorState } from '../../store/fractal/color/types';\nimport { ViewState } from '../../store/fractal/view/types';\nimport { JsonState } from '../../fractals/json';\nimport { ALLFRACTALS } from '../../fractals'; \nimport { FractalCommands, Params } from './types'\nimport Abstract from './abstract';\nimport { animator } from './animation';\n\nclass Connected extends Abstract implements FractalCommands {\n  protected store: typeof reduxStore\n  protected autodraw: boolean\n\n  constructor(store: typeof reduxStore=reduxStore, autodraw: boolean=false) {\n    super();\n    this.store = store;\n    this.autodraw = autodraw\n  }\n\n  static new(autodraw: boolean=false) {\n    return new Connected(reduxStore, autodraw);\n  }\n\n  loadJson(data: JsonState) {\n    this.dispatch(reduxAction.uploadJson(data))\n    return this;\n  }\n\n  animate(start: number, stop: number, frames: number=0, {\n    incl=true,\n    ms=0,\n  }: {\n    incl?: boolean,\n    ms?: number,\n  }={}) {\n    if (frames === 0) {\n      frames = stop - start + 1;\n    }\n    return (param: (n: number) => Params) => {\n      const autodraw = this.autodraw;\n      this.autodraw = true;\n      return animator(start, stop, frames, incl)((n: number) => {\n        this.updateParams(param(n))\n      }, ms).then(() => {\n        this.autodraw = autodraw;\n        return this;\n      });\n    }\n  }\n\n  dispatch(action: Action) {\n    this.store.dispatch(action)\n    if (this.autodraw) {\n      this.redraw();\n    }\n  }\n\n  redraw() {\n    this.store.dispatch(reduxAction.redraw())\n  }\n\n  getFractal(): FractalState {\n    return this.store.getState().fractal;\n  }\n\n  getAlgorithm() {\n    return this.getFractal().algorithm;\n  }\n\n  getColor() {\n    return this.getFractal().color;\n  }\n\n  getView() {\n    return this.getFractal().view;\n  }\n\n  // Algorithm\n\n  getMethod() {\n    return this.getFractal().algorithm.methodName;\n  }\n\n  getParams() {\n    return this.getFractal().algorithm.params;\n  }\n\n  getParam(k: string) {\n    return this.getParams()[k]\n  }\n\n  setMethod(methodName: string) {\n    const method = ALLFRACTALS[methodName];\n    if (method) {\n      this.dispatch(reduxAction.setAlgorithm(methodName, method));\n    } else {\n      console.error('unknown methodName:', methodName)\n    }\n  }\n\n  updateParams(p: Params) {\n    this.dispatch(reduxAction.updateParams(p));\n  }\n\n  setParam(k: string, v: any) {\n    this.dispatch(reduxAction.updateParams({[k]: v}));\n  }\n\n  // Color\n\n  _updateColor(color: Partial<ColorState>) {\n    this.dispatch(reduxAction.updateColor(color));\n  }\n\n  // View\n\n  _updateView(view: Partial<ViewState>) {\n    this.dispatch(reduxAction.updateView(view));\n  }\n\n  recenter() {\n    this.dispatch(reduxAction.recenter());\n  }\n\n  setCenter(x: number, y: number) {\n    this.dispatch(reduxAction.setCenter(x, y));\n  }\n\n  zoom(factor: number) {\n    this.dispatch(reduxAction.zoomIn(factor));\n  }\n}\n\nexport default Connected","import JSZip from 'jszip';\n\nclass Zipper {\n  zip: JSZip\n  count: number\n\n  constructor() {\n    this.zip = new JSZip();\n    this.count = 0\n    \n  }\n\n  addFile(data: Blob) {\n    const name = 'img' + String(this.count++).padStart(4, '0') + '.png'\n    this.zip.file(name, data);\n  }\n\n  download(filename: string) {\n    this.zip.generateAsync({type: 'blob'}).then(blob => {\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = filename;\n      a.style.display = 'none';\n      document.body.append(a);\n      a.click();\n      setTimeout(() => {\n        a.remove();\n        URL.revokeObjectURL(url);\n      }, 1000)\n    })\n  }\n}\n\nexport default Zipper;","import reduxStore from '../../store';\nimport { addToGallery } from '../../store/actions';\nimport { FractalState } from '../../store/fractal/types';\nimport { recenterPPU } from '../../store/fractal/view/reducer';\nimport { JsonState, jsonToState, stateToJson, jsonToUrl } from '../../fractals/json';\nimport { ColorState } from '../../store/fractal/color/types';\nimport { ViewState } from '../../store/fractal/view/types';\nimport { ALLFRACTALS } from '../../fractals'; \nimport { FractalCommands, Params } from './types'\nimport { FractalDrawer } from '../../fractals'\nimport Abstract from './abstract';\nimport { animator } from './animation';\nimport Zipper from './zip';\n\ninterface Fractal extends Omit<FractalState,'drawState'|'view'> {\n  view: {\n    cx: number\n    cy: number\n    w: number\n    h: number\n    ppu: number\n  }\n}\n\nclass Disconnected extends Abstract implements FractalCommands {\n  fractal: Fractal\n  drawer: FractalDrawer\n  zipper: Zipper\n\n  constructor(fractalState: Fractal) {\n    super();\n    this.fractal = fractalState;\n    this.drawer = new FractalDrawer();\n    this.zipper = new Zipper();\n  }\n\n  private static parseState(fractal: Fractal | FractalState) {\n    return {\n      algorithm: {...fractal.algorithm},\n      color: {...fractal.color},\n      view: {...fractal.view},\n    }\n  }\n\n  static fromState(fractal: Fractal | FractalState) {\n    return new Disconnected(Disconnected.parseState(fractal));\n  }\n\n  static new() {\n    return new Disconnected(reduxStore.getState().fractal);\n  }\n\n  json() {\n    return stateToJson(this.fractal)\n  }\n\n  url() {\n    return jsonToUrl(this.json())\n  }\n\n  clear() {\n    this.zipper = new Zipper();\n  }\n\n  loadJson(data: JsonState) {\n    const fractal = jsonToState(data);\n    if (fractal) {\n      this.fractal.algorithm = {...this.fractal.algorithm, ...fractal.algorithm}\n      this.fractal.color = {...this.fractal.color, ...fractal.color}\n      this.fractal.view = {...this.fractal.view, ...fractal.view}\n    }\n    return this;\n  }\n\n  animate(start: number, stop: number, frames: number=0, {\n    incl=true,\n    ms=0,\n  }: {\n    incl?: boolean,\n    ms?: number,\n  }={}) {\n    if (frames === 0) {\n      frames = stop - start;\n    }\n    return (param: (n: number) => Params) => {\n      return animator(start, stop, frames, incl)((n: number) => {\n        this.updateParams(param(n));\n        this.redraw();\n        this.drawer.toBlob(blob => {\n          if (blob) {\n            this.zipper.addFile(blob)\n          }\n        });\n      }, ms).then(() => this);\n    }\n  }\n\n  download(filename: string) {\n    this.drawer.toURL(url => {\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = filename;\n      document.body.append(a);\n      a.click();\n      setTimeout(() => {\n        a.remove();\n        URL.revokeObjectURL(url);\n      }, 100);\n    })\n  }\n\n  saveToGallery() {\n    this.redraw();\n    this.drawer.toURL(url => {\n      const title = 'fract' + Math.floor((Date.now() - new Date(2020,0,25).getTime())).toString(16)\n      reduxStore.dispatch(addToGallery(url, stateToJson(this.getFractal()), title));\n    })\n  }\n\n  getFractal(): Omit<FractalState,'drawState'> {\n    return ({\n      algorithm: this.getAlgorithm(),\n      color: this.getColor(),\n      view: this.getView(),\n    });\n  }\n\n  getAlgorithm() {\n    return this.fractal.algorithm;\n  }\n\n  getColor() {\n    return this.fractal.color;\n  }\n\n  getView() {\n    return {\n      ...this.fractal.view,\n      pixelCount: this.fractal.view.w * this.fractal.view.h,\n    }\n  }\n\n  redraw() {\n    this.drawer.draw(this.getFractal())\n  }\n\n  getMethod() {\n    return this.fractal.algorithm.methodName;\n  }\n\n  getParams() {\n    return this.fractal.algorithm.params;\n  }\n\n  getParam(k: string) {\n    return this.getParams()[k]\n  }\n\n  setMethod(methodName: string) {\n    const method = ALLFRACTALS[methodName];\n    if (method) {\n      this.fractal.algorithm.method = method;\n      this.fractal.algorithm.methodName = methodName;\n    } else {\n      console.error('unknown methodName:', methodName)\n    }\n  }\n\n  updateParams(p: Params) {\n    this.fractal.algorithm.params = {...this.fractal.algorithm.params, ...p}\n  }\n\n  setParam(k: string, v: any) {\n    this.fractal.algorithm.params[k] = v;\n  }\n\n\n  // Color\n\n  _updateColor(color: Partial<ColorState>) {\n    this.fractal.color = {...this.fractal.color, ...color};\n  }\n\n\n\n  // View\n\n  _updateView(view: Partial<ViewState>) {\n    this.fractal.view = {...this.fractal.view, ...view};\n  }\n\n  recenter() {\n    this.fractal.view.cx = 0;\n    this.fractal.view.cy = 0;\n    this.fractal.view.ppu = recenterPPU(this.fractal.view);\n  }\n\n  setCenter(x: number, y: number) {\n    this.fractal.view.cx = x;\n    this.fractal.view.cy = y;\n  }\n\n  zoom(factor: number) {\n    this.fractal.view.ppu *= factor;\n  }\n}\n\nexport default Disconnected","\nexport function magic(drawer, {\n  volatility=0.4,\n  frames=30, \n  rounds=3,\n  ms=0,\n  param='c',\n}={}) {\n  const c0 = drawer.getParam(param);\n  if (c0 && Array.isArray(c0)) {\n    const [x0, y0] = c0;\n    \n    let x = x0, y = y0;\n    drawer.setParam('c', [x, y])\n    const rand = () => volatility*(0.5-Math.random())\n    const randC = () => {\n      [x, y] = [x + rand(), x + rand()];\n      return [x, y];\n    }\n  \n    let i = 0;\n    const rotator = () => {    \n      i++\n      if (i <= rounds) {\n        console.log('round', i);\n        const angle = ((Math.random() * Math.PI) + Math.PI)/2;\n        return drawer.rotateParam('c', {frames, center: randC(), angle, incl: false, ms}).then(rotator);\n      } else {\n        console.log('returning')\n        const [x1, y1] = drawer.getParam('c');\n        const xmid = (x0 + x1)/2;\n        const ymid = (y0 + y1)/2;\n        return drawer.rotateParam('c', {frames, center: [xmid, ymid], angle: Math.PI, ms})\n      }\n    };\n  \n    return rotator();\n  } else {\n    console.error('magic failed - does the fractal have a complex parameter \"' + param + '\"?')\n  }\n}","import {\n  Connected,\n  Disconnected,\n} from './drawer';\nimport { magic } from './magic';\nimport FractalDrawer from '../fractals/FractalDrawer';\n\n\nexport default {\n  controller: Connected.new(true),\n\n  hidden: () => Disconnected.new(),\n  \n  get logDrawTime() {\n    return FractalDrawer.logDrawTime;\n  },\n\n  set logDrawTime(x: boolean) {\n    FractalDrawer.logDrawTime = x;\n  },\n\n  magic: function(...args: any[]) {\n    if (args.length) {\n      if ('getParam' in args[0] && 'setParam' in args[0] && 'rotateParam' in args[0]) {\n        return magic(...args);\n      }\n    }\n    return magic(this.controller, ...args);\n  },\n}","import fractalex from './console';\n\nwindow.fractalex = fractalex;","import FractalDrawer from './FractalDrawer';\nimport { ALLFRACTALS } from './algorithm';\nimport { Algorithm } from './types';\nimport { colorScale, COLORSCHEMES } from './color';\n\n\n\nfunction fractal<T>({method, params}: Algorithm<T>) {\n  return {\n    label: method.label,\n    calc: method.calc(params),\n    range: method.range(params),\n    describe: method.describe(params),\n    controls: method.controls,\n  }\n}\n\nexport { colorScale }\n\n\n\nexport { FractalDrawer, ALLFRACTALS, COLORSCHEMES, fractal }\n","import { CombinedState } from 'redux';\n\nimport {\n  AlgorithmAction,\n  AlgorithmState,\n} from './algorithm/types';\nimport {\n  ColorAction,\n  ColorState,\n} from './color/types';\nimport {\n  ViewAction,\n  ViewState,\n} from './view/types';\nimport {\n  DrawAction,\n} from './drawState';\n\nexport enum DrawState {\n  None,\n  Draw,\n  Color,\n  Capture,\n}\n\nexport const UPDATE_FRACTAL = 'FRACTAL_UPDATE';\n\nexport type UpdateFractal = {\n  type: typeof UPDATE_FRACTAL\n  payload: Partial<{\n    algorithm: AlgorithmState<any>\n    color: Partial<ColorState>\n    view: Partial<Omit<ViewState,'pixelCount'>>\n  }> | undefined\n}\n\nexport type FractalState = CombinedState<{\n  algorithm: AlgorithmState<any>\n  color: ColorState\n  view: ViewState\n  drawState: DrawState\n}>\n\nexport type FractalAction = AlgorithmAction<any> | ColorAction | ViewAction | UpdateFractal | DrawAction;","// Constants\nconst PI = Math.PI\nconst TAU = 2*PI\n\n// Functions\nconst abs = Math.abs\nconst asin = Math.asin\nconst atan2 = Math.atan2\nconst exp = Math.exp\nconst floor = Math.floor\nconst pow = Math.pow\nconst random = Math.random\nconst round = Math.round\nconst sin = Math.sin\nconst sqrt = Math.sqrt\nconst cos = Math.cos\n\nexport {\n  PI,\n  TAU,\n\n  abs,\n  asin,\n  atan2,\n  cos,\n  exp,\n  floor,\n  pow,\n  random,\n  round,\n  sin,\n  sqrt,\n}\n","import { AlgorithmState } from '../../store/fractal/algorithm/types';\nimport { ColorState } from '../../store/fractal/color/types';\nimport { ViewState } from '../../store/fractal/view/types';\nimport { V1 } from './json1';\nimport { V2 } from './json2';\nimport {\n  jsonToState1,\n  stateToJson1,\n  urlToJson1,\n  jsonToUrl1,\n} from './json1'\nimport {\n  jsonToState2,\n  stateToJson2,\n  urlToJson2,\n  jsonToUrl2,\n} from './json2';\n\n\nexport interface AppState {\n  algorithm: AlgorithmState<any>,\n  color: ColorState,\n  view: Omit<ViewState,'pixelCount'>\n}\n\nexport interface Json {\n  v: '1' | '2'\n}\n\nexport type JsonState = V1 | V2\n\nexport function stateToJson(state: AppState): V2 {\n  return stateToJson2(state);\n}\n\nexport function jsonToState(data: JsonState): Partial<AppState> | undefined {\n  if (data.v === '1') return jsonToState1(data);\n  return jsonToState2(data);\n}\n\nexport function jsonToUrl(data: JsonState): string {\n  return window.location.href.split('?')[0] + '?' + (\n    data.v === '1' ? jsonToUrl1(data) :\n    jsonToUrl2(data)\n  )\n}\n\nexport function urlToJson(url: string): JsonState | undefined {\n  try {\n    const u = new URLSearchParams(url);\n    const v = u.get('v');\n    if (v === '1') return urlToJson1(u);\n    else if (v === '2') return urlToJson2(u);\n  } catch {}\n}","import { Json, AppState } from '.';\nimport { ALLFRACTALS, COLORSCHEMES } from '../'\n\n\ntype Color = [string, number, number] | [string, number, number, ...string[]]\n\nexport interface V2 extends Json {\n  v: '2',\n  alg?: [string, {[k: string]: any}],\n  col?: Color,\n  view?: [number, number, number, number, number],\n}\n\nexport function stateToJson2(state: AppState): V2 {\n  const {algorithm, color, view} = state;\n  const {schemeName} = color;\n  const scheme = COLORSCHEMES[schemeName] ? null : color.scheme;\n  const col: Color = [color.schemeName, color.skew, color.reverse ? 1 : 0];\n  if (Array.isArray(scheme)) {\n    col.push(...scheme)\n  }\n  return ({\n    v: '2',\n    alg: [algorithm.methodName, algorithm.params],\n    col: col,\n    view: [view.cx, view.cy, view.w, view.h, view.ppu],\n  })\n}\n\nexport function jsonToState2(data: V2): Partial<AppState> | undefined {\n  const result: Partial<AppState> = {}\n  if (data.alg) {\n    const methodName = data.alg[0];\n    const method = ALLFRACTALS[methodName];\n    if (method) {\n      result.algorithm = {\n        methodName,\n        method,\n        params: data.alg[1],\n      };\n    }\n  }\n\n  if (data.col) {\n    const schemeName = data.col[0];\n    let scheme = COLORSCHEMES[schemeName];\n    if (!scheme) {\n      scheme = data.col.slice(3) as string[]\n    }\n    result.color = {\n      schemeName: scheme && scheme.length ? schemeName : 'Rainbow',\n      scheme: scheme && scheme.length ? scheme : COLORSCHEMES.Rainbow,\n      skew: data.col[1],\n      reverse: data.col[2] ? true : false,\n    };\n  }\n  if (data.view) {\n    result.view = {\n      cx: data.view[0],\n      cy: data.view[1],\n      w: data.view[2],\n      h: data.view[3],\n      ppu: data.view[4],\n    };\n  }\n  return result;\n}\n\nexport function jsonToUrl2(data: V2): string {\n  const u = new URLSearchParams();\n  const {v, alg, col, view} = data;\n  u.append('v', v)\n  if (alg) {\n    const par = Object.entries(alg[1]).map(([k, v]) => {\n      return k + ':' + JSON.stringify(v);\n    }).join(';')\n    u.append('al', alg[0] + ';' + par)\n  }\n  if (col) {\n    u.append('co', col.join(';'))\n  }\n  if (view) {\n    u.append('vw', view.join(';'))\n  }\n  return u.toString()\n}\n\nexport function urlToJson2(u: URLSearchParams): V2 | undefined {\n  try {\n    const al = u.get('al')\n    const co = u.get('co')\n    const vw = u.get('vw')\n    const result: V2 = {v: '2'};\n    if (al) {\n      try {\n        const [me, ...pa] = al.split(';')\n        const params: {[k: string]: any} = Object.fromEntries(pa.map((entry: string) => {\n          const s = entry.split(':');\n          try {\n            return [s[0], JSON.parse(s[1])] as [string, any]\n          } catch {\n            console.log('bad param', entry)\n            return ['BAD_PARAM', 'BAD_PARAM'] as [string, any]\n          }\n        }).filter((ent: [string, any]) => ent[1] !== 'BAD_PARAM'))\n        result.alg = [me, params];\n      } catch {}\n    }\n    if (co) {\n      try {\n        const [scheme, skew, rev, ...colors] = co.split(';')\n        result.col = [scheme, +skew, +rev, ...colors];\n      } catch {}\n    }\n    if (vw) {\n      try {\n        const [cx, cy, w, h, ppu] = vw.split(';').map(k => +k)\n        result.view = [cx, cy, w, h, ppu];\n      } catch {}\n    }\n    return result;\n  } catch {}\n}","import { ALLFRACTALS, COLORSCHEMES } from '../'\nimport { Json, AppState } from '.';\n\nexport interface V1 extends Json {\n  v: '1',\n  alg: {\n    m: string\n    p: object\n  },\n  col: {\n    sc: string\n    sk: number\n    rv: boolean\n  },\n  view: {\n    cx: number\n    cy: number\n    w: number\n    h: number\n    pp: number\n  }\n}\n\nexport function stateToJson1(state: AppState): V1 {\n  const {algorithm, color, view} = state;\n  return ({\n    v: '1',\n    alg: {\n      m: algorithm.methodName,\n      p: algorithm.params,\n    },\n    col: {\n      sc: color.schemeName,\n      sk: color.skew,\n      rv: color.reverse,\n    },\n    view: {\n      cx: view.cx,\n      cy: view.cy,\n      w: view.w,\n      h: view.h,\n      pp: view.ppu,\n    }\n  })\n}\n\nexport function jsonToState1(data: V1): AppState | undefined {\n  const method = ALLFRACTALS[data.alg.m];\n  const scheme = COLORSCHEMES[data.col.sc];\n  if (method) {\n    return ({\n      algorithm: {\n        methodName: data.alg.m,\n        method: method,\n        params: data.alg.p,\n      },\n      color: {\n        schemeName: scheme ? data.col.sc : 'Rainbow',\n        scheme: scheme ? scheme : COLORSCHEMES.Rainbow,\n        skew: data.col.sk,\n        reverse: data.col.rv,\n      },\n      view: {\n        cx: data.view.cx,\n        cy: data.view.cy,\n        w: data.view.w,\n        h: data.view.h,\n        ppu: data.view.pp,\n      }\n    })\n  }\n}\n\nexport function jsonToUrl1(data: V1): string {\n  const u = new URLSearchParams();\n  const {v, ...rest} = data;\n  u.append('v', v)\n  u.append('data', btoa(JSON.stringify(rest)))    \n  return u.toString()\n}\n\nexport function urlToJson1(u: URLSearchParams): V1 | undefined {\n  try {\n    const data = u.get('data')\n    if (data) {\n      const {alg, col, view} = JSON.parse(atob(data));\n      if (alg && col && view) {\n        return {v: '1', alg, col, view}\n      }\n    }\n  } catch {}\n}","import {\n  UpdateAlgorithm,\n  UPDATE_ALGORITHM,\n  AlgorithmState,\n  UpdateParams,\n  UPDATE_PARAMS,\n  SetAlgorithm,\n  SET_ALGORITHM,\n  Method,\n} from './types';\n\nexport const updateAlgorithm = <T>(f: Partial<AlgorithmState<T>>): UpdateAlgorithm<T> => ({\n  type: UPDATE_ALGORITHM,\n  payload: f\n})\n\nexport const updateParams = <T>(params: T): UpdateParams<T> => ({\n  type: UPDATE_PARAMS,\n  payload: params\n})\n\nexport const setAlgorithm = <T>(methodName: string, method: Method<T>, params?: T): SetAlgorithm<T> => ({\n  type: SET_ALGORITHM,\n  payload: {\n    methodName,\n    method,\n    params\n  }\n})","import {\n  UPDATE_COLOR,\n  ColorState,\n  UpdateColor,\n} from './types';\n\n\nexport const updateColor = (color: Partial<ColorState>): UpdateColor => ({\n  type: UPDATE_COLOR,\n  payload: color,\n})\n\n","import {\n  ViewState,\n  UpdateView,\n  Recenter,\n  ZoomIn,\n  ZoomOut,\n  UPDATE_VIEW,\n  RECENTER,\n  ZOOM_IN,\n  ZOOM_OUT,\n} from './types';\n\n\nexport const updateView = (update: Partial<ViewState>): UpdateView => ({\n  type: UPDATE_VIEW,\n  payload: update,\n})\n\nexport const recenter = (): Recenter => ({\n  type: RECENTER,\n})\n\nexport const setCenter = (cx: number, cy: number): UpdateView => ({\n  type: UPDATE_VIEW,\n  payload: {cx, cy},\n})\n\nexport const zoomIn = (factor: number): ZoomIn => ({\n  type: ZOOM_IN,\n  payload: factor,\n})\n\nexport const zoomOut = (factor: number): ZoomOut => ({\n  type: ZOOM_OUT,\n  payload: factor,\n})","import {\n  jsonToState, urlToJson,\n  AppState, JsonState\n} from '../../fractals/json';\nimport {\n  UPDATE_FRACTAL,\n  UpdateFractal,\n} from './types';\n\nexport {\n  updateAlgorithm,\n  setAlgorithm,\n  updateParams,\n} from './algorithm/actions'\n\nexport {\n  updateColor,\n} from './color/actions';\n\nexport {\n  updateView,\n  recenter,\n  setCenter,\n  zoomIn,\n  zoomOut,\n} from './view/actions';\n\nexport {\n  redraw,\n  recolor,\n  capture,\n  finish,\n} from './drawState'\n\nexport const uploadData = (data: AppState): UpdateFractal => ({\n  type: UPDATE_FRACTAL,\n  payload: data\n})\n\nexport const uploadJson = (data: JsonState): UpdateFractal => ({\n  type: UPDATE_FRACTAL,\n  payload: jsonToState(data)\n})\n\nexport const uploadUrl = (url: string): UpdateFractal => {\n  const data = urlToJson(url);\n  if (data) {\n    return ({\n      type: UPDATE_FRACTAL,\n      payload: jsonToState(data)\n    })\n  } else {\n    return ({\n      type: UPDATE_FRACTAL,\n      payload: undefined\n    })\n  }\n}","import { Complex, Polar } from './types';\nimport * as P from './polar';\nimport * as Math from './real';\n\n\nexport function complex(re: number, im: number): Complex {\n  return {re, im}\n}\n\nexport function conjugate(z: Complex) {\n  return {re: z.re, im: -z.im}\n}\n\nexport function fromPolar({angle, radius}: Polar) {\n  return {\n    re: radius * Math.cos(angle),\n    im: radius * Math.sin(angle),\n  }\n}\n\nexport function toPolar(z: Complex): Polar {\n  return {\n    angle: Math.atan2(z.im, z.re),\n    radius: Math.sqrt(z.re*z.re + z.im*z.im),\n  }\n}\n\nexport function neg(a: Complex): Complex {\n  return {re: -a.re, im: -a.im}\n}\n\n\n// Addition\n\nexport function add(a: Complex, b: Complex): Complex {\n  return {re: a.re+b.re, im: a.im+b.im}\n}\n\nexport function addReal(a: Complex, b: number): Complex {\n  return {re: a.re + b, im: a.im}\n}\n\nexport function addPolar(a: Complex, b: Polar): Complex {\n  return add(a, fromPolar(b))\n}\n\n\n// Subtraction\n\nexport function subt(a: Complex, b: Complex): Complex {\n  return {re: a.re - b.re, im: a.im - b.im}\n}\n\nexport function subtReal(a: Complex, b: number): Complex {\n  return {re: a.re - b, im: a.im}\n}\n\nexport function subtPolar(a: Complex, b: Polar): Complex {\n  return subt(a, fromPolar(b))\n}\n\n\n// Multiplication\n\nexport function mult(a: Complex, b: Complex): Complex {\n  return {\n    re: a.re*b.re - a.im*b.im,\n    im: a.re*b.im + a.im*b.re,\n  }\n}\n\nexport function multReal(a: Complex, b: number): Complex {\n  return {re: b * a.re, im: b * a.im}\n}\n\nexport function multPolar(a: Complex, b: Polar): Complex {\n  return mult(a, fromPolar(b))\n}\n\n\n// Division\n\nexport function div(a: Complex, b: Complex): Complex {\n  const d = abs2(b);\n  return {\n    re: (a.re * b.re + a.im * b.im) / d,\n    im: (a.im * b.re - a.re * b.im) / d,\n  }\n}\n\nexport function divReal(a: Complex, b: number): Complex {\n  return {re: a.re / b, im: a.im / b}\n}\n\nexport function divPolar(a: Complex, b: Polar): Complex {\n  return fromPolar(P.div(toPolar(a), b))\n}\n\n\n// Exponentiation\n\nexport function exp(z: Complex): Complex {\n  return fromPolar({radius: Math.exp(z.re), angle: z.im})\n}\n\nexport function powFloat(z: Complex, k: number): Complex {\n  return fromPolar(P.powReal(toPolar(z), k))\n}\n\nexport function powInt(z: Complex, k: number): Complex {\n  if (k < 0) return div(complex(1, 0), powInt(z, -k))\n  if (k === 0) return complex(1, 0)\n  if (k === 1) return z\n  if (k === 2) return mult(z, z)\n  if (k === 3) return mult(mult(z, z), z)\n  if (k === 4) return mult(mult(mult(z, z), z), z)\n  if (k === 5) return mult(mult(mult(mult(z, z), z), z), z)\n  if (k === 6) return mult(mult(mult(mult(mult(z, z), z), z), z), z)\n  if (k === 7) return mult(mult(mult(mult(mult(mult(z, z), z), z), z), z), z)\n  if (k === 8) return mult(mult(mult(mult(mult(mult(mult(z, z), z), z), z), z), z), z)\n  return powFloat(z, k)\n}\n\nexport function powReal(z: Complex, k: number): Complex {\n  return powInt(z, k);\n}\n\nconst pow2 = (z: Complex) => mult(z, z);\nconst pow3 = (z: Complex) => mult(mult(z, z), z);\nconst pow4 = (z: Complex) => mult(mult(mult(z, z), z), z);\nconst pow5 = (z: Complex) => mult(mult(mult(mult(z, z), z), z), z);\nconst pow6 = (z: Complex) => mult(mult(mult(mult(mult(z, z), z), z), z), z);\nconst pow7 = (z: Complex) => mult(mult(mult(mult(mult(mult(z, z), z), z), z), z), z);\n//const pow8 = (z: Complex) => mult(mult(mult(mult(mult(mult(mult(z, z), z), z), z), z), z), z);\nconst pow8 = (z: Complex) => pow2(pow2(pow2(z)))\n\nexport function powN(k: number): (z: Complex) => Complex {\n  if (k < 0) {\n    const p = powN(-k);\n    return (z: Complex) => div(complex(1, 0), p(z))\n  }\n  if (k === 0) return z => complex(1, 0);\n  if (k === 1) return z => z;\n  if (k === 2) return pow2\n  if (k === 3) return pow3\n  if (k === 4) return pow4\n  if (k === 5) return pow5\n  if (k === 6) return pow6\n  if (k === 7) return pow7\n  if (k === 8) return pow8\n  if (k % 1 === 0) {\n    if (k % 2 === 0) {\n      const p = powN(k / 2)\n      return (z: Complex) => pow2(p(z))\n    } else {\n      const p = powN((k-1) / 2)\n      return (z: Complex) => mult(z, pow2(p(z)))\n    }\n  }\n  return z => powFloat(z, k);\n}\n\n\n// Other\n\nexport function abs2(z: Complex): number {\n  return z.re * z.re + z.im * z.im;\n}\n\nexport function abs(z: Complex): number {\n  return Math.sqrt(abs2(z));\n}\n\nexport function angle(z: Complex): number {\n  return Math.atan2(z.im, z.re);\n}\n\nexport function sqrt(z: Complex): Complex {\n  const angle = Math.atan2(z.im, z.re);\n  return fromPolar({\n    angle: angle / 2,\n    radius: Math.sqrt(abs(z))\n  })\n}\n\nexport function sinh(z: Complex): Complex {\n  return divReal(subt(exp(z), exp(neg(z))), 2)\n}\n","import { COLORSCHEMES, ALLFRACTALS } from './fractals'\n\nexport const methodName = 'Jl1'\nexport const colorSchemeName = 'Rainbow'\nexport const pixelCount = 90000\nexport const captureSize = {\n  w: 1920,\n  h: 1080,\n}\n\nexport const canvasSize = {\n  w: 600,\n  h: 500,\n}\n\nexport const method = ALLFRACTALS[methodName]\nexport const colorScheme = COLORSCHEMES[colorSchemeName]","import {\n  interpolateLab,\n  piecewise,\n  scalePow,\n} from 'd3';\nimport { Color } from './types';\n\n\nfunction colorScale(color: Color): (domain: [number,number]) => (n: number) => string {\n  const interpolator = Array.isArray(color.scheme)\n    ? piecewise(interpolateLab, color.scheme)\n    : color.scheme;\n  const range = color.reverse ? [1, 0] : [0, 1];\n  const exponent = 2**color.skew;\n  return (domain: [number,number]) => {\n    const scale = scalePow().domain(domain).range(range).exponent(exponent);\n    return (n: number) => interpolator(scale(n));  \n  }\n}\n\nfunction colorMap(color: Color): (domain: [number,number]) => {[k: number]: string} {\n  // discrete version\n  const cs = colorScale(color);\n  return (domain: [number, number]) => {\n    const scale = cs(domain);\n    if (domain[0] === 0) {\n      const result: string[] = [];\n      for (let i = domain[0]; i <= domain[1]; i++) {\n        result.push(scale(i))\n      }\n      return result;\n    } else {\n      const result: {[k: number]: string} = {};\n      for (let i = domain[0]; i <= domain[1]; i++) {\n        result[i] = scale(i);\n      }\n      return result;\n    }\n  }\n}\n\n\nexport { colorScale, colorMap }","import {\n  interpolateInferno as Inferno,\n  interpolateMagma as Magma,\n  interpolatePlasma as Plasma,\n  interpolateViridis as Viridis,\n  interpolateCool as Cool,\n  interpolateWarm as Warm,\n  interpolateGreys as Greys,\n  interpolateRainbow as Rainbow,\n  interpolateSinebow as Sinebow,\n  interpolateSpectral as Spectral,\n  interpolateCubehelixDefault as Cubehelix,\n\n  interpolateBlues as Blues,\n  interpolateBrBG as BrBG,\n  interpolateBuGn as BuGn,\n  interpolateBuPu as BuPu,\n  interpolateGnBu as GnBu,\n  interpolateGreens as Greens,\n  interpolateOrRd as OrRd,\n  interpolateOranges as Oranges,\n  interpolatePRGn as PRGn,\n  interpolatePiYG as PiYG,\n  interpolatePuBu as PuBu,\n  interpolatePuBuGn as PuBuGn,\n  interpolatePuOr as PuOr,\n  interpolatePuRd as PuRd,\n  interpolatePurples as Purples,\n  interpolateRdBu as RdBu,\n  interpolateRdGy as RdGy,\n  interpolateRdPu as RdPu,\n  interpolateRdYlBu as RdYlBu,\n  interpolateRdYlGn as RdYlGn,\n  interpolateReds as Reds,\n  interpolateYlGn as YlGn,\n  interpolateYlGnBu as YlGnBu,\n  interpolateYlOrBr as YlOrBr,\n  interpolateYlOrRd as YlOrRd,\n\n} from 'd3';\nimport { ColorScheme } from './types';\n\ntype SchemeDict = {[k: string]: ColorScheme}\n\nconst D3_SCHEMES_1: SchemeDict = {\n  Cool,\n  Cubehelix,\n  Greys,\n  Inferno,\n  Magma,\n  Plasma,\n  Rainbow,\n  Sinebow,\n  Spectral,\n  Viridis,\n  Warm,\n}\n\nconst D3_SCHEMES_2: SchemeDict = {\n  Blues,\n  BrBG,\n  BuGn,\n  BuPu,\n  GnBu,\n  Greens,\n  OrRd,\n  Oranges,\n  PRGn,\n  PiYG,\n  PuBu,\n  PuBuGn,\n  PuOr,\n  PuRd,\n  Purples,\n  RdBu,\n  RdGy,\n  RdPu,\n  RdYlBu,\n  RdYlGn,\n  Reds,\n  YlGn,\n  YlGnBu,\n  YlOrBr,\n  YlOrRd,\n}\n\nconst OTHER_SCHEMES: SchemeDict = {\n  Paint: [\"#3db5ec\", \"#73c2b0\", \"#b9e375\", \"#f4bb44\", \"#eb591b\"],\n  Ink: ['#000000', '#FFDD8C'],\n}\n\nconst ALL_SCHEMES: SchemeDict = {\n  ...D3_SCHEMES_1,\n  ...D3_SCHEMES_2,\n  ...OTHER_SCHEMES,\n}\n\nexport default ALL_SCHEMES\n","import { colorScale, colorMap } from './colorScale';\nimport COLORSCHEMES from './schemes';\n\n\nexport {\n  colorScale,\n  colorMap,\n  COLORSCHEMES,\n}","export interface ViewState {\n  cx: number\n  cy: number\n  w: number\n  h: number\n  ppu: number // units per pixel\n  pixelCount: number\n}\n\nexport const UPDATE_VIEW = 'VIEW_UPDATE';\nexport const ZOOM_IN = 'VIEW_ZOOM_IN';\nexport const ZOOM_OUT = 'VIEW_ZOOM_OUT';\nexport const RECENTER = 'VIEW_RECENTER';\n\nexport type UpdateView = {\n  type: typeof UPDATE_VIEW,\n  payload: Partial<ViewState>,\n}\n\nexport type Recenter = {\n  type: typeof RECENTER,\n}\n\nexport type ZoomIn = {\n  type: typeof ZOOM_IN,\n  payload: number,\n}\n\nexport type ZoomOut = {\n  type: typeof ZOOM_OUT,\n  payload: number,\n}\n\nexport type ViewAction = UpdateView | ZoomIn | ZoomOut | Recenter;","import { FractalState } from '../store/fractal/types';\nimport { ViewState } from '../store/fractal/view/types';\nimport { colorScale } from './color';\nimport { fractal } from './index';\n\n\nexport function linearScale(domain: [number, number], range: [number,number]) {\n  const m = (range[1] - range[0]) / (domain[1] - domain[0])\n  const b = range[0] - m*domain[0]\n  return (n: number) => m*n + b;\n}\n\n\nexport function scaleDown({w, h, ppu, pixelCount}: {\n  w: number,\n  h: number,\n  ppu: number,\n  pixelCount: number,\n}) {\n  const pixels = w * h;\n  const factor = Math.sqrt(pixelCount / pixels)\n  const result = {\n    w: Math.round(w * factor),\n    h: Math.round(h * factor),\n    ppu: Math.round(ppu * factor),\n  }\n  return result\n}\n\nexport function rgb(color: string) {\n  return [color.slice(1,3), color.slice(3,5), color.slice(5,7)].map(s => parseInt(s, 16));\n}\n\n\ninterface Rect {\n  x: [number, number]\n  y: [number, number]\n  w: number\n  h: number\n}\n\nexport type DrawerView = ViewState | Rect\n\ninterface Props extends Pick<FractalState,'algorithm'|'color'> {\n  view: DrawerView\n}\n\nfunction isRect(view: ViewState | Rect): view is Rect {\n  return 'x' in view;\n}\n\nclass FractalDrawer {\n  ctx: CanvasRenderingContext2D\n  fullResolution: boolean\n  cmap: [number,number,number][]\n  image: ImageData\n\n  static logDrawTime = false\n\n  constructor(fullResolution: boolean=false) {\n    this.ctx = document.createElement('canvas').getContext('2d') as CanvasRenderingContext2D;\n    this.fullResolution = fullResolution;\n    this.cmap = [];\n    this.image = new ImageData(1,1);\n  }\n\n  getView(view: ViewState | Rect) {\n    if (isRect(view)) {\n      return view;\n    } else {\n      return {...view, ...scaleDown(view)}\n    }\n  }\n\n  recolor(state: Props) {\n    this.draw(state)\n  }\n\n  draw(state: Props) {\n    const t0 = performance.now();\n    this.makeCMap(state);\n    this.makeImage(state);\n    const t1 = performance.now();\n    if (FractalDrawer.logDrawTime) {\n      console.log('draw time:', t1 - t0, 'ms')\n    }\n  }\n\n  makeCMap({color, algorithm}: Props) {\n    const range = fractal(algorithm).range;\n    const cs = colorScale(color)(range);\n    const cmap: [number,number,number][] = [];\n    for (let i = 0; i <= range[1]; i++) {\n      this.ctx.fillStyle = cs(i);\n      const [r, g, b] = [\n        this.ctx.fillStyle.slice(1,3), \n        this.ctx.fillStyle.slice(3,5),\n        this.ctx.fillStyle.slice(5,7),\n      ].map(n => parseInt(n, 16))\n      cmap.push([r, g, b]);\n    }\n    this.cmap = cmap;\n  }\n\n  makeImage(state: Props) {\n    const {algorithm} = state;\n    const cmap = this.cmap;\n    const view = this.getView(state.view);\n    const {w, h} = view;\n    const calc = fractal(algorithm).calc;\n    const image = new ImageData(w, h);\n    let xrange: [number,number]\n    let yrange: [number,number]\n    if (isRect(view)) {\n      xrange = view.x;\n      yrange = view.y\n    } else {\n      const {cx, cy, w, h, ppu} = view;\n      const rx = w / ppu / 2;\n      const ry = h / ppu / 2;\n      xrange = [cx - rx, cx + rx];\n      yrange = [cy + ry, cy - ry];\n    }\n    const xscale = linearScale([-0.5, w-0.5], xrange);\n    const yscale = linearScale([-0.5, h-0.5], yrange);\n    for (let r = 0; r < h; r++) {\n      const y = yscale(r);\n      const hh = w * r;\n      for (let c = 0; c < w; c++) {\n        const x = xscale(c);\n        const i = 4*(c + hh);\n        const color = cmap[calc(x, y)]\n        image.data[i] = color[0];\n        image.data[i+1] = color[1];\n        image.data[i+2] = color[2];\n        image.data[i+3] = 255;\n      }\n    }\n    this.image = image;\n  }\n\n  putOnCanvas(canvas: HTMLCanvasElement) {\n    canvas.width = this.image.width;\n    canvas.height = this.image.height;\n    canvas.getContext('2d')?.putImageData(this.image, 0, 0);\n  }\n\n  toBlob(f: BlobCallback) {\n    const cvs = document.createElement('canvas');\n    this.putOnCanvas(cvs);\n    cvs.toBlob(f)\n  }\n\n  toURL(f: (url: string) => void) {\n    this.toBlob(blob => {\n      if (blob) {\n        const url = URL.createObjectURL(blob);\n        f(url)\n      }\n    })\n  }\n\n}\n\nexport default FractalDrawer;","import { JsonState } from '../../fractals/json'\nexport const ADD_TO_GALLERY = 'GALLERY_ADD'\nexport const MASS_ADD_TO_GALLERY = 'MASS_ADD_TO_GALLERY'\nexport const DELETE_IMAGE = 'GALLERY_DELETE'\n\nexport interface GalleryImage {\n  url: string\n  data: JsonState\n  title: string\n}\n\nexport type GalleryState = GalleryImage[]\n\nexport type AddToGallery = {\n  type: typeof ADD_TO_GALLERY\n  payload: GalleryImage\n}\n\nexport type MassAddToGallery = {\n  type: typeof MASS_ADD_TO_GALLERY\n  payload: GalleryImage[]\n}\n\nexport type DeleteImage = {\n  type: typeof DELETE_IMAGE\n  payload: string\n}\n\nexport type GalleryAction = AddToGallery | DeleteImage | MassAddToGallery\n\n\n","import { DrawState } from './types';\n\nexport const SET_DRAW_STATE = 'FRACTAL_SET_DRAW'\nexport const FINISH_DRAWING = 'FRACTAL_FINISH_DRAW'\n\nexport type SetDrawState = {\n  type: typeof SET_DRAW_STATE\n  payload: DrawState\n}\n\nexport type FinishDrawing = {\n  type: typeof FINISH_DRAWING\n}\n\nexport type DrawAction = SetDrawState | FinishDrawing;\n\nexport function reducer(state: DrawState=DrawState.None, action: DrawAction) {\n  switch(action.type) {\n    case SET_DRAW_STATE:\n      return action.payload;\n    case FINISH_DRAWING:\n      return DrawState.None\n    default:\n      return state;\n  }\n}\n\nexport const redraw = (): SetDrawState => ({\n  type: SET_DRAW_STATE,\n  payload: DrawState.Draw,\n})\n\nexport const recolor = (): SetDrawState => ({\n  type: SET_DRAW_STATE,\n  payload: DrawState.Color,\n})\n\nexport const capture = (): SetDrawState => ({\n  type: SET_DRAW_STATE,\n  payload: DrawState.Capture,\n})\n\nexport const finish = (): FinishDrawing => ({\n  type: FINISH_DRAWING,\n})","import {\n  AlgorithmState,\n  AlgorithmAction,\n  SET_ALGORITHM,\n  UPDATE_ALGORITHM,\n  UPDATE_PARAMS,\n} from './types';\nimport { method, methodName } from '../../../defaults';\n\nconst initialState = {\n  methodName,\n  method,\n  params: method.newParams()\n}\n\nexport default function<T>(state: AlgorithmState<any>=initialState, action: AlgorithmAction<T>) {\n  switch (action.type) {\n    case UPDATE_ALGORITHM:\n      return {...state, ...action.payload}\n    case SET_ALGORITHM:\n      return {\n        methodName: action.payload.methodName,\n        method: action.payload.method, \n        params: action.payload.params ? action.payload.params : action.payload.method.newParams(),\n      } as AlgorithmState<T>\n    case UPDATE_PARAMS:\n      return {...state, params: {...state.params, ...action.payload}} as typeof state\n    default:\n      return state\n  }\n}","import { COLORSCHEMES } from '../../../fractals/color';\nimport {\n  ColorState,\n  ColorAction,\n  UPDATE_COLOR,\n} from './types';\nimport { colorSchemeName } from '../../../defaults';\n\nconst initialState: ColorState = {\n  schemeName: colorSchemeName,\n  scheme: COLORSCHEMES[colorSchemeName],\n  reverse: false,\n  skew: 0,\n}\n\nexport default function(state: ColorState=initialState, action: ColorAction) {\n  switch(action.type) {\n    case UPDATE_COLOR:\n      return {...state, ...action.payload}\n    default:\n      return state;\n  }\n}","import algorithm from './algorithm/reducer';\nimport color from './color/reducer';\nimport view from './view/reducer';\nimport { reducer as drawState } from './drawState';\nimport {\n  FractalState,\n  FractalAction,\n  UPDATE_FRACTAL,\n} from './types';\nimport { combineReducers } from 'redux';\n\nconst reducer1 = combineReducers({\n  algorithm,\n  color,\n  view,\n  drawState,\n});\n\nexport default function(state: FractalState, action: FractalAction): FractalState {\n  if (action.type === UPDATE_FRACTAL) {\n    if (action.payload !== undefined) {\n      const vw = {...state.view, ...action.payload.view}\n      // fit without changing w:h ratio\n      const rw = vw.w / state.view.w;\n      const rh = vw.h / state.view.h;\n      if (rw > rh) {\n        vw.h = state.view.h * rw;\n      } else {\n        vw.w = state.view.w * rh;\n      }\n      return {\n        algorithm: {...state.algorithm, ...action.payload.algorithm},\n        color: {...state.color, ...action.payload.color},\n        view: vw,\n        drawState: state.drawState,\n      };\n    } else {\n      return state;\n    }\n  } else {\n    return reducer1(state, action);\n  }\n}\n","import {\n  UIState,\n  Nav,\n  Modal,\n  StretchMode,\n  SET_NAV,\n  SET_MODAL,\n  SET_STRETCH,\n  UPDATE_UI,\n  ADD_COLOR_SCHEME,\n} from './types';\nimport { Action } from '../types';\nimport { ADD_TO_GALLERY } from '../gallery/types';\nimport { ALLFRACTALS } from '../../fractals/algorithm';\nimport { COLORSCHEMES } from '../../fractals/color';\nimport { UPDATE_FRACTAL } from '../fractal/types';\nimport { FINISH_DRAWING } from '../fractal/drawState';\n\n\nconst initialState: UIState = ({\n  nav: Nav.Explore,\n  modal: Modal.None,\n  canvasStretch: StretchMode.Contain,\n  galleryBadge: 0,\n  methodList: ALLFRACTALS,\n  colorSchemeList: {...COLORSCHEMES},\n  waiting: false,\n});\n\n\nexport default function(state: UIState=initialState, action: Action) {\n  switch(action.type) {\n    case UPDATE_UI:\n      return {...state, ...action.payload};\n    case SET_NAV:\n      if (action.payload === Nav.Gallery) {\n        return {...state, nav: action.payload, galleryBadge: 0};\n      } else {\n        return {...state, nav: action.payload};\n      }\n    case SET_MODAL:\n      return {...state, modal: action.payload};\n    case SET_STRETCH:\n      return {...state, canvasStretch: action.payload};\n    case ADD_COLOR_SCHEME:\n      return {\n        ...state, \n        colorSchemeList: {\n          ...state.colorSchemeList,\n          [action.payload.name]: action.payload.scheme,\n        },\n      };\n    case ADD_TO_GALLERY:\n      return {...state, galleryBadge: state.galleryBadge+1};\n    case UPDATE_FRACTAL:\n      if (action.payload\n        && action.payload.color\n        && action.payload.color.schemeName \n        && !(state.colorSchemeList[action.payload!.color!.schemeName])) {\n        return {\n          ...state, \n          colorSchemeList: {\n            ...state.colorSchemeList,\n            [action.payload.color.schemeName]: action.payload.color.scheme,\n          },\n        };\n      }\n      return state;\n    case FINISH_DRAWING:\n      return {...state, waiting: false}\n    default:\n      return state;\n  }\n}","import {\n  GalleryState,\n  GalleryAction,\n  ADD_TO_GALLERY,\n  DELETE_IMAGE,\n  MASS_ADD_TO_GALLERY,\n} from './types'\n\nconst initialState: GalleryState = [];\n\nexport default function(state: GalleryState=initialState, action: GalleryAction) {\n  switch(action.type) {\n    case ADD_TO_GALLERY:\n      return [...state, action.payload];\n    case DELETE_IMAGE:\n      URL.revokeObjectURL(action.payload)\n      return state.filter(v => v.url !== action.payload);\n    case MASS_ADD_TO_GALLERY:\n      console.log(action);\n      return [...state, ...action.payload];\n    default:\n      return state\n  }\n}","import { combineReducers } from 'redux';\nimport fractal from './fractal/reducer';\nimport ui from './ui/reducer';\nimport gallery from './gallery/reducer';\n\nexport default combineReducers({\n  fractal,\n  ui,\n  gallery,\n});","import { createStore } from 'redux';\nimport reducer from './reducer';\n\nexport default createStore(reducer);","import { Complex, Polar } from './types';\nimport * as Math from './real';\n\n\nexport function polar(angle: number, radius: number): Polar {\n  return {angle, radius};\n}\n\nexport function fromComplex({re, im}: Complex): Polar {\n  return {\n    angle: Math.atan2(im, re),\n    radius: Math.sqrt(re*re + im*im),\n  };\n}\n\nexport function toComplex(z: Polar): Complex {\n  return {\n    re: z.radius * Math.cos(z.angle),\n    im: z.radius * Math.sin(z.angle),\n  };\n}\n\nexport function neg(z: Polar): Polar {\n  return {\n    angle: z.angle,\n    radius: -z.radius,\n  };\n}\n\nexport function mult(a: Polar, b: Polar): Polar {\n  return {\n    angle: a.angle + b.angle,\n    radius: a.radius * b.radius,\n  };\n}\n\nexport function multReal(a: Polar, b: number): Polar {\n  return {angle: a.angle, radius: b* a.radius}\n}\n\nexport function div(a: Polar, b: Polar): Polar {\n  return {\n    angle: a.angle - b.angle,\n    radius: a.radius / b.radius,\n  };\n}\n\nexport function divReal(a: Polar, b: number): Polar {\n  return {angle: a.angle, radius: a.radius / b}\n}\n\nexport function powReal(z: Polar, k: number): Polar {\n  return {angle: z.angle * k, radius: Math.pow(z.radius, k)}\n}\n","import {\n  FractalInterface,\n} from '../../../fractals/algorithm/types';\n\nexport const UPDATE_ALGORITHM = 'ALGORITHM_UPDATE';\nexport const SET_ALGORITHM = 'ALGORITHM_SET';\nexport const UPDATE_PARAMS = 'ALGORITHM_UPDATE_PARAMS';\n\nexport type Method<T> = FractalInterface<T>\n\nexport interface AlgorithmState<T> {\n  methodName: string\n  method: Method<T>\n  params: T\n}\n\nexport type UpdateAlgorithm<T> = {\n  type: typeof UPDATE_ALGORITHM\n  payload: Partial<AlgorithmState<T>>\n}\n\nexport type SetAlgorithm<T> = {\n  type: typeof SET_ALGORITHM,\n  payload: {\n    methodName: string\n    method: Method<T>\n    params?: T\n  }\n}\n\nexport type UpdateParams<T> = {\n  type: typeof UPDATE_PARAMS,\n  payload: T\n}\n\nexport type AlgorithmAction<T> = UpdateAlgorithm<T> | SetAlgorithm<T> | UpdateParams<T>","import {\n  UIState,\n  SetStretch,\n  StretchMode,\n  SET_STRETCH,\n  SetModal,\n  SET_MODAL,\n  SetNav,\n  SET_NAV,\n  Modal,\n  Nav,\n  AddColorScheme,\n  ADD_COLOR_SCHEME,\n  ColorScheme,\n  UpdateUI,\n  UPDATE_UI,\n} from './types'\n\nexport const updateUI = (x: Partial<UIState>): UpdateUI => ({\n  type: UPDATE_UI,\n  payload: x\n})\n\nexport const setStretch = (stretch: StretchMode): SetStretch => ({\n  type: SET_STRETCH,\n  payload: stretch\n})\n\nexport const setModal = (modal: Modal): SetModal => ({\n  type: SET_MODAL,\n  payload: modal\n})\n\nexport const setNav = (nav: Nav): SetNav => ({\n  type: SET_NAV,\n  payload: nav\n})\n\nexport const startWaiting = (): UpdateUI => ({\n  type: UPDATE_UI,\n  payload: {waiting: true},\n})\n\nexport const stopWaiting = (): UpdateUI => ({\n  type: UPDATE_UI,\n  payload: {waiting: false}\n})\n\nexport const addColorScheme = (name: string, scheme: ColorScheme): AddColorScheme => ({\n  type: ADD_COLOR_SCHEME,\n  payload: {name, scheme}\n})\n\n\n\n\n","import { JsonState } from '../../fractals/json';\nimport {\n  AddToGallery,\n  ADD_TO_GALLERY,\n  DeleteImage,\n  DELETE_IMAGE,\n  MassAddToGallery,\n  MASS_ADD_TO_GALLERY,\n} from './types';\n\n\nexport const addToGallery = (url: string, data: JsonState, title: string): AddToGallery => ({\n  type: ADD_TO_GALLERY,\n  payload: {url, data, title}\n})\n\nexport const massAddToGallery = (imgs: {url: string, data: JsonState, title: string}[]): MassAddToGallery => ({\n  type: MASS_ADD_TO_GALLERY,\n  payload: imgs\n})\n\nexport const deleteImage = (url: string): DeleteImage => ({\n  type: DELETE_IMAGE,\n  payload: url,\n})\n","export {\n  updateAlgorithm,\n  setAlgorithm,\n  updateParams,\n  updateColor,\n  updateView,\n  recenter,\n  setCenter,\n  zoomIn,\n  zoomOut,\n  redraw,\n  recolor,\n  capture,\n  finish,\n  uploadData,\n  uploadJson,\n  uploadUrl,\n} from './fractal/actions';\n\nexport {\n  setNav,\n  setModal,\n  setStretch,\n  startWaiting,\n  stopWaiting,\n  updateUI,\n  addColorScheme,\n} from './ui/actions';\n\nexport {\n  addToGallery,\n  massAddToGallery,\n  deleteImage,\n} from './gallery/actions';\n\n\n\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Outer\":\"Canvas_Outer__3WApH\",\"Canvas\":\"Canvas_Canvas__2ENmD\",\"Stretch\":\"Canvas_Stretch__2sMXG\"};","import {\n  FractalInterface,\n  ControlProps,\n  StringWithMath,\n} from '../types'\n\n\n// create, settings, controls, random?\n\n\nexport default function<T>({\n  controls=[],\n  ...rest\n}: {\n  calc: (params: T) => (x: number, y: number) => number\n  newParams: () => T\n  label: StringWithMath\n  describe: (params: T) => StringWithMath\n  range: (params: T) => [number,number]\n  controls?: ControlProps[]\n}): FractalInterface<T> {\n  return {...rest, controls};\n}","import { Complex } from '../math/types';\nimport { abs2 } from '../math/complex';\n\n\nexport default function(bound: number, iterations: number) {\n  const b2 = bound * bound;\n  return (\n    f: (n: Complex) => Complex,\n    z0: Complex = {re: 0, im: 0}, \n  ) => {\n    let k = 0;\n    let z = z0;\n    while (k < iterations && abs2(z) < b2) {\n      k += 1;\n      z = f(z);\n    }\n    return k;\n  }\n}","import {\n  FractalInterface,\n  Complex,\n  ControlProps,\n  StringWithMath,\n  Params,\n} from '../types'\nimport { StringOrMath } from '../../../components/TypographyWithMath';\nimport { complex } from '../../math/complex';\nimport escapeTime from '../escapeTime';\nimport { num } from '../../formatting';\nimport baseFractalInterface from './base';\n\n\nexport interface EscapeParams extends Params {\n  bd: number\n  iter: number\n}\n\nconst DefaultEscapeParams: EscapeParams ={\n  bd: 10,\n  iter: 20,\n}\n\nexport function newParams<T>(x: () => T): () => (T & EscapeParams) {\n  return () => ({...DefaultEscapeParams, ...x()});\n}\n\nfunction calculate<T>(\n    f: (p: T) => (c: Complex) => (z: Complex) => Complex,\n    z0: 0 | 'c' | ((p: T) => (c: Complex) => Complex)=0,\n): (params: T & EscapeParams) => (x: number, y: number) => number {\n  if (z0 === 0) {\n    return (p: T & EscapeParams) => {\n      const func = f(p)\n      return (x: number, y: number) => {\n        return escapeTime(p.bd, p.iter)(func(complex(x, y)))\n      };\n    };\n  }\n  if (z0 === 'c') {\n    return (p: T & EscapeParams) => {\n      const func = f(p)\n      return (x: number, y: number) => {\n        return escapeTime(p.bd, p.iter)(func(complex(x, y)), complex(x, y))\n      };\n    };\n  }\n  return (p: T & EscapeParams) => {\n    const func = f(p)\n    const zz = z0(p)\n    return (x: number, y: number) => {\n      return escapeTime(p.bd, p.iter)(func(complex(x, y)), zz(complex(x, y)))\n    };\n  };\n}\n\nfunction describe<T>(\n    f: (p: T & EscapeParams) => string,\n    z0: 0 | 'c' | ((p: T & EscapeParams) => string)=0,\n): (params: T & EscapeParams) => StringWithMath {\n  return (p: T & EscapeParams) => describeEscapeFunction(\n    f(p),\n    z0 === 0 ? '0' : z0 === 'c' ? 'x+yi' : z0(p),\n    p.bd,\n    p.iter,\n  );\n}\n\ninterface CommonEscapeProps<T> {\n  label: StringWithMath\n  f: (p: T) => (c: Complex) => (z: Complex) => Complex\n  z0?: 0 | 'c' | ((p: T) => (c: Complex) => Complex)\n  newParams: () => T\n  controls?: ControlProps[]\n}\n\ninterface EscapePropsA<T> extends CommonEscapeProps<T> {\n  latexF: (p: T & EscapeParams) => string\n  latexZ0?: 0 | 'c' | ((p: T) => string)\n}\n\ninterface EscapePropsB<T> extends CommonEscapeProps<T> {\n  describe: (p: T & EscapeParams) => StringWithMath\n}\n\ntype EscapeProps<T> = EscapePropsA<T> | EscapePropsB<T>\n\nfunction isTypeA<T>(p: EscapeProps<T>): p is EscapePropsA<T> {\n  return !('describe' in p);\n}\n\nexport default function escape<T>(props: EscapeProps<T>): FractalInterface<T & EscapeParams> {\n  if (isTypeA(props)) {\n    const lz0 =\n      props.latexZ0 === undefined && (props.z0 === 0 || props.z0 === 'c')\n      ? props.z0 : props.latexZ0;\n    return baseFractalInterface<T & EscapeParams>({\n      label: props.label,\n      calc: calculate(props.f, props.z0),\n      range: (params: EscapeParams) => [0, params.iter],\n      describe: describe(props.latexF, lz0),\n      newParams: newParams(props.newParams),\n      controls: props.controls,\n    })\n  } else {\n    return baseFractalInterface<T & EscapeParams>({\n      label: props.label,\n      calc: calculate(props.f, props.z0),\n      range: (params: T & EscapeParams) => [0, params.iter],\n      describe: props.describe,\n      newParams: newParams(props.newParams),\n      controls: props.controls,\n    })\n  }\n}\n\n\nexport function describeEscapeFunction(\n  f: string, \n  z0: string, \n  bd: number, \n  iter: number,\n): StringOrMath[] {\n\n  const fmla = (\n    '\\\\begin{aligned}'\n    + 'z_0 &= ' + z0\n    + '\\\\\\\\' \n    + 'z_{n+1} &= ' + (f.indexOf('z_') === -1 ? f.replace(/z/g, 'z_n') : f)\n    + '\\\\end{aligned}'\n  );\n\n  return [\n    {math: fmla, displayMode: true},\n    \"The color of the pixel located at \", {math: \"(x, y)\"},\n    \" corresponds to \", {math: \"k\"}, \", where \", {math: \"z_k\"},\n    \" is the first term of the above sequence such that \",\n    {math: `|z_k| > ${num(bd)}`},\n    \". If this does not occur in the first \", {math: num(iter)},\n    \" terms of the sequence, then \", {math: \"k = \" + num(iter)}, '.',\n  ]\n}","import {\n  FractalInterface,\n  Complex,\n  ControlProps,\n  StringWithMath,\n} from '../types'\nimport baseFractalInterface from './base';\nimport escapeTime from '../escapeTime';\nimport { EscapeParams, describeEscapeFunction, newParams } from './escape';\nimport { complex } from '../../math/complex';\n\n\nfunction juliaLabel(f: StringWithMath): StringWithMath {\n  if (Array.isArray(f)) {\n    return ['Julia: ', ...f]\n  } else {\n    return ['Julia: ', f]\n  }\n}\n\nfunction juliaCalc<T>(\n  f: (p: T) => (z: Complex) => Complex,\n) {\n  return (p: T & EscapeParams) => {\n    const func = f(p)\n    const esc = escapeTime(p.bd, p.iter)\n    return (x: number, y: number) => {\n      return esc(func, complex(x, y))\n    };\n  };\n}\n\nexport default function julia<T>({f, label, latexF, ...props}: {\n  f: (p: T) => (z: Complex) => Complex,\n  label: StringWithMath,\n  latexF: (p: T & EscapeParams) => string,\n  newParams: () => T,\n  controls?: ControlProps[],\n}): FractalInterface<T & EscapeParams> {\n\n  return baseFractalInterface<T & EscapeParams>({\n    label: juliaLabel(label),\n    calc: juliaCalc(f),\n    range: (params: EscapeParams) => [0, params.iter],\n    describe: (params: T & EscapeParams) => describeEscapeFunction(\n      latexF(params),\n      'x+yi',\n      params.bd,\n      params.iter,\n    ),\n    newParams: newParams(props.newParams),\n    controls: props.controls,\n  })\n}\n\nexport function noParam(props: {\n  f: (z: Complex) => Complex,\n  latexF: string,\n  newParams?: () => Partial<EscapeParams>\n}): FractalInterface<EscapeParams> {\n  return julia({\n    f: () => props.f,\n    label: props.latexF,\n    latexF: () => props.latexF,\n    newParams: props.newParams ? props.newParams : () => ({}),\n  });\n}","\nexport function isInt(n: number) {\n  return n % 1 === 0;\n}\n","import { Complex, Coeffs } from './types';\nimport { add, powInt, multReal, toPolar, addPolar } from './complex';\nimport * as P from './polar';\nimport { isInt } from './util';\n\n\n/**\n * { exponent: coefficient }\n * can be object \n *  {2: 3, 5: 1} => 3z^2 + z^5\n * or array\n *  [1, 0, -3, 5] => z^0 - 3z^2 + 5z^3\n */\n\n\nfunction allAreInts(coeffs: Coeffs): boolean {\n  for (const k in coeffs) {\n    if (!isInt(+k) || +k < 0) return false;\n  }\n  return true;\n}\n\n\nexport default function(coeffs: Coeffs): (z: Complex) => Complex {\n  if (allAreInts(coeffs)) {\n    return (z: Complex) => {\n      let result: Complex = {re: 0, im: 0};\n      for (const k in coeffs) {\n        result = add(result, multReal(powInt(z, +k), coeffs[k]))\n      }\n      return result\n    }\n  } else {\n    return (z: Complex) => {\n      const p = toPolar(z);\n      let result: Complex = {re: 0, im: 0};\n      for (const k in coeffs) {\n        result = addPolar(result, P.multReal(P.powReal(p, +k), coeffs[k]))\n      }\n      return result\n    }\n  } \n}","// Fractal-specific functions\nimport { Complex } from './types';\nimport {\n  complex,\n  abs2,\n  add,\n  multReal,\n  powN,\n} from './complex';\nimport * as Math from './real';\n\n\n\n// Burning Ship\n\nconst BS = (z: Complex) => complex(Math.abs(z.re), Math.abs(z.im))\n\nexport function burningship(k: number=1, c?: [number,number]): (z: Complex) => Complex {\n  if (c) {\n    const bs = burningship(k);\n    const cc = complex(c[0], c[1])\n    return (z: Complex) => add(bs(z), cc)\n  }\n  if (k === 1) return BS\n  else {\n    const p = powN(k)\n    return (z: Complex) => p(complex(Math.abs(z.re), Math.abs(z.im)))\n  }\n}\n\n\n// Mandelbox\n\nexport function mandelboxA(v: number=1) {\n  const w = v*2;\n  const f = (n: number) =>  {\n    if (n > v) return w - n;\n    else if (n < -v) return -w - n;\n    else return n;\n  }\n  return (z: Complex) => complex(f(z.re), f(z.im));\n}\n\nexport function mandelboxB(v: number=2) {\n  const v2 = v*v;\n  const recip = 1/v2;\n  return (z: Complex) => {\n    const ab2 = abs2(z);\n    if (ab2 < recip) {\n      return multReal(z, v2)\n    } else if (ab2 < 1) {\n      return multReal(z, 1/ab2)\n    } else {\n      return z\n    }\n  }\n}\n\nexport function mandelbox(a: number=1, b: number=2, c: number=2) {\n  const aa = a*2;\n  const f1 = (n: number) =>  {\n    if (n > a) return aa - n;\n    else if (n < -a) return -aa - n;\n    else return n;\n  }\n  const b2 = b*b;\n  const recip = 1/b2;\n  const f2 = (z: Complex) => {\n    const ab2 = abs2(z);\n    if (ab2 < recip) {\n      return multReal(z, c*b2)\n    } else if (ab2 < 1) {\n      return multReal(z, c/ab2)\n    } else {\n      return multReal(z, c)\n    }\n  }\n  return (z: Complex) => f2(complex(f1(z.re), f1(z.im)));\n}\n\n\n// Phoenix\n\n\nexport function lookback(f: (z: Complex, zprev: Complex) => Complex, z0: Complex=complex(0,0)) {\n  let zp = z0;\n  return (z: Complex) => {\n    const z1 = f(z, zp)\n    zp = z;\n    return z1;\n  }\n}\n\n\nexport function phoenix(p=-0.5, k: number=2, c?: [number,number]) {\n  const po = powN(k)\n  if (c) {\n    const cc = complex(c[0], c[1])\n    return (z: Complex, zp: Complex) => add(add(po(z), cc), multReal(zp, p));\n  } else {\n    return (z: Complex, zp: Complex) => add(po(z), multReal(zp, p));\n  }\n  /*\n  let zp = complex(0,0)\n  const po = powN(k)\n  if (c) {\n    const cc = complex(c[0], c[1])\n    return (z: Complex, zprev=zp) => {\n      const z1 = add(add(po(z), cc), multReal(zprev, p))\n      zp = z;\n      return z1;\n    }\n  } else {\n    return (z: Complex, zprev=zp) => {\n      const z1 = add(po(z), multReal(zprev, p))\n      zp = z;\n      return z1;\n    }\n  }\n  */\n}","import {\n  ControlType,\n  ControlNumber,\n  ControlComplex,\n} from '../types'\n\n\nexport function number(param: string, {step=1, ...rest}: {\n  min?: number\n  max?: number\n  label?: string\n  step?: number\n}={}): ControlNumber {\n  return {\n    type: ControlType.Number,\n    param,\n    label: rest.label ? rest.label : param,\n    step,\n    ...rest,\n  }\n}\n\n\nexport function complex(param: string, {stepRadius=0.02, stepAngle=0.05, ...rest}: {\n  label?: string\n  stepRadius?: number\n  stepAngle?: number\n}={}): ControlComplex {\n  return {\n    type: ControlType.Complex,\n    param,\n    label: rest.label ? rest.label : param,\n    stepRadius,\n    stepAngle,\n    ...rest,\n  }\n}","import { Complex, ControlType, ControlProps } from './types';\nimport * as mix from './mixers';\nimport {\n  complex,\n  add,\n  multReal,\n  powInt,\n  powFloat,\n} from '../math/complex';\nimport { R as Math } from '../math';\nimport { mandelbox } from '../math/fractals';\nimport { isInt } from '../math/util';\nimport { num } from '../formatting'\nimport { MandelboxParams } from './mandelbox';\nimport * as ctrl from './mixers/controls';\n\n\nexport interface BurningShipParams { k: number }\n\nfunction absabs(z: Complex) {\n  return {re: Math.abs(z.re), im: Math.abs(z.im)};\n}\n\nconst BurningShip = mix.escape({\n  label: 'Burning Ship',\n  latexF: (p: BurningShipParams) => `\\\\left(|Re(z)|+|Im(z)|\\\\right)^{${num(p.k)}}+x-yi`,\n  f: (p: BurningShipParams) => {\n    const k = p.k;\n    if (isInt(k)) {\n      return (c: Complex) => {\n        const cc = {re: c.re, im: -c.im}\n        return (z: Complex) => add(powInt(absabs(z), k), cc);\n      }\n    } else {\n      return (c: Complex) => {\n        const cc = {re: c.re, im: -c.im}\n        return (z: Complex) => add(powFloat(absabs(z), k), cc);\n      }\n    }\n  },\n  newParams: () => ({k: 2}),\n  controls: [\n    {\n      type: ControlType.Number,\n      label: 'exponent (k)',\n      param: 'k',\n      step: 0.1,\n      min: 0,\n    }\n  ] as ControlProps[],\n})\n\n\n\n\ninterface BurningShipBoxParams extends BurningShipParams, MandelboxParams {}\n\nconst BurningShipMandelbox = mix.escape<BurningShipBoxParams>({\n  label: 'Burning Ship (Mandelbox Remix)',\n  \n  f: ({box1, box2, box3, k}) => {\n    const pow = isInt(k) && k > 0 ? powInt : powFloat\n    const mbox = mandelbox(box1, box2, box3);\n    return (x: Complex) => (z: Complex) => {\n      let z1 = multReal(pow(complex(Math.abs(z.re), -Math.abs(z.im)), k), 1/box3);\n      return add(mbox(z1), x);\n    }\n  },\n\n  z0: 0,\n\n  describe: ({box1, box2, box3, k, bd, iter}) => [\n    'This follows the same algorithm as the Mandelbox fractal, but first applies the function ',\n    {\n      math: `z \\\\mapsto \\\\left(|Re(z)|-|Im(z)|\\\\right)^{${num(k)}} \\\\div ${num(box3)}`,\n      displayMode: true,\n    }\n  ],\n\n  newParams: () => ({box1: 1, box2: 2, box3: 2.2, k: 2, bd: 50}),\n\n  controls: [\n    {\n      type: ControlType.Call,\n      icon: 'Random',\n      onCall: () => ({box3: Math.round(Math.random() * 100)/100 + 0.5})\n    },\n    ...['box1', 'box2', 'box3'].map(p => ctrl.number(p, {step:0.1})),\n    ctrl.number('k', {step: 0.1, min: 0}),\n    ctrl.number('bd', {step: 5, min: 0}),\n  ],\n});\n\nexport {\n  BurningShip,\n  BurningShipMandelbox,\n}","import { Complex, ControlType, ControlProps } from './types';\nimport julia from './mixers/julia';\nimport {\n  complex,\n  add,\n  powReal,\n  exp,\n  sqrt,\n  sinh,\n  powN,\n} from '../math/complex';\nimport { burningship } from '../math/fractals';\nimport polynomial from '../math/polynomial';\nimport { R as Math } from '../math';\nimport * as fmt from '../formatting'\n\n\nfunction randomC() {\n  let angle = Math.PI -2 * Math.asin(Math.pow(Math.random(), 0.9));\n  if (Math.random() < 0.5) angle = 2*Math.PI-angle;\n  const radius = 0.3 + Math.sin(angle / 2) * 0.6 * (Math.random() * 0.4 + 0.8);\n  return [\n    Math.round(radius * Math.cos(angle) * 1000) / 1000,\n    Math.round(radius * Math.sin(angle) * 1000) / 1000,\n  ] as [number, number]\n}\n\n\ninterface JuliaParams {\n  k: number\n  c: [number, number]\n}\n\n\nconst JuliaControls: {[k: string]: ControlProps} = ({\n  k: {\n    type: ControlType.Number,\n    label: 'exponent (k)',\n    param: 'k',\n    step: 0.5,\n  },\n  c: {\n    type: ControlType.Complex,\n    label: 'c',\n    param: 'c',\n    stepRadius: 0.02,\n    stepAngle: 0.05,\n  },\n  randomC: {\n    type: ControlType.Call,\n    icon: 'Random',\n    //label: 'random',\n    onCall: () => ({c: randomC()}),\n  },\n})\n\ninterface JQuad extends JuliaParams {}\n\nconst Julia = julia({\n  label: {math: 'z^k+c'},\n\n  f: ({k,c}: JQuad) => {\n    const cc = complex(c[0], c[1])\n    const p = powN(k)\n    return (z: Complex) => add(p(z), cc);    \n  },\n\n  latexF: ({k,c}: JQuad) => `z^{${fmt.num(k)}}${fmt.complex(c,{sign:true})}`,\n\n  newParams: () => ({k: 2, c: randomC()}),\n\n  controls: [\n    JuliaControls.randomC,\n    JuliaControls.c,\n    JuliaControls.k,\n    {\n      type: ControlType.Number,\n      label: 'bound',\n      param: 'bd',\n      step: 5,\n      min: 0,\n    }\n  ],\n\n});\n\n\nexport type JPoly = {\n  a: number,\n  b: number,\n  m: number,\n  n: number,\n  c: [number,number],\n}\n\nconst Julia2Term = julia({\n  label: {math: 'az^m+bz^n+c'},\n\n  f: ({a, b, c, m, n}: JPoly) => {\n    const poly = polynomial({[m]: a, [n]: b});\n    const cc = complex(c[0], c[1]);\n    return (z: Complex) => add(poly(z), cc);\n  },\n\n  latexF: ({a, b, c, m, n}: JPoly) => {\n    return (\n      `${fmt.num(a)}z^{${fmt.num(m)}}`\n      + `${fmt.num(b,{sign:true})}z^{${fmt.num(n)}}`\n      + `${fmt.complex(c,{sign:true})}`\n    )\n  },\n\n  newParams: () => ({\n    a: -5, m: -2,\n    b: 1, n: 1,\n    c: [-0.5,0.5] as [number,number],\n  }),\n\n  controls: [\n    ...['a', 'm', 'b', 'n'].map(p => ({\n      type: ControlType.Number,\n      param: p,\n      label: p,\n      step: p === 'a' || p === 'b' ? 1 : 0.1,\n    }) as ControlProps),\n    JuliaControls.c,\n  ],\n})\n\n\n\nconst JuliaExp = julia<JuliaParams>({\n  label: {math: 'e^{z^k}+c'},\n\n  newParams: () => ({k: 3, c: [-0.6,0]}),\n\n  latexF: ({k,c}: JuliaParams) => `e^{z^{${fmt.num(k)}}}${fmt.complex(c,{sign:true})}`,\n\n  f: ({k,c}: JuliaParams) => {\n    const cc = complex(c[0], c[1]);\n    return (z: Complex) => add(exp(powReal(z, k)), cc);\n  },\n\n  controls: [\n    JuliaControls.randomC,\n    JuliaControls.c,\n    JuliaControls.k,\n    {\n      type: ControlType.Number,\n      label: 'bound',\n      param: 'bd',\n      min: 0,\n      step: 1,\n    },\n  ]\n})\n\n\n\nconst JuliaSinh = julia<JuliaParams>({\n  label: {math: '\\\\sqrt{\\\\sinh(z^{k})}+c'},\n\n  newParams: () => ({k: 2, c: [0.06, 0.12]}),\n\n  latexF: ({k,c}: JuliaParams) => `\\\\sqrt{\\\\sinh(z^{${fmt.num(k)}})}${fmt.complex(c,{sign:true})}`,\n\n  f: ({k,c}: JuliaParams) => {\n    const cc = complex(c[0], c[1]);\n    return (z: Complex) => add(sqrt(sinh(powReal(z, k))), cc);\n  },\n\n  controls: [\n    JuliaControls.randomC,\n    JuliaControls.c,\n    JuliaControls.k,\n    {\n      type: ControlType.Number,\n      label: 'bound',\n      param: 'bd',\n      min: 0,\n      step: 1,\n    },\n  ]\n})\n\n\nconst JuliaBurningShip = julia<JuliaParams>({\n  label: 'Burning Ship',\n\n  newParams: () => ({k: 2, c: [-0.52, -1.1]}),\n\n  f: ({k, c}: JuliaParams) => {\n    const cc = complex(c[0], c[1])\n    const bs = burningship(k);\n    return (z: Complex) => add(bs(z), cc)\n  },\n\n  latexF: ({k,c}: JuliaParams) => `(|Re(z)|+|Im(z)|)^{${fmt.num(k)}}${fmt.complex(c,{sign:true})}`,\n\n  controls: [\n    JuliaControls.randomC,\n    JuliaControls.c,\n    JuliaControls.k,\n  ]\n\n});\n\n\nexport {\n  Julia,\n  Julia2Term,\n  JuliaBurningShip,\n  JuliaExp,\n  JuliaSinh,\n}\n","import { Complex, ControlType } from './types';\nimport * as mix from './mixers';\nimport {\n  add,\n  powInt,\n  powFloat,\n  multReal,\n  addReal,\n  div,\n  mult,\n} from '../math/complex';\nimport { isInt } from '../math/util';\nimport * as fmt from '../formatting'\n\n\n\nexport interface MagnetParams {\n  k: number,\n}\n\nconst Magnet1 = mix.escape({\n  label: 'Magnet Type I',\n\n  f: ({k}: MagnetParams) => {\n    const pow = isInt(k) && k > 0 ? powInt : powFloat\n    return (c: Complex) => {\n      //const c = complex(x, y);\n      const a = addReal(c, -1);\n      const b = addReal(c, -2);\n      return (z: Complex) => pow(div(\n        add(powInt(z, 2), a),\n        add(multReal(z, 2), b)\n      ), k)\n    }\n  },\n\n  latexF: ({k}: MagnetParams) => '\\\\left(\\\\frac{z^2 + x+yi - 1}{2z + x+yi - 2}\\\\right)^{' + fmt.num(k) + '}',\n\n  newParams: () => ({k: 2}),\n\n  controls: [\n    {\n      type: ControlType.Number,\n      param: 'k',\n      label: 'exponent',\n      step: 0.5,\n    },\n    {\n      type: ControlType.Number,\n      param: 'bd',\n      label: 'bound',\n      step: 5,\n      min: 0,\n    },\n  ],\n})\n\nexport interface Magnet2Params {k: number}\n\nconst Magnet2 = mix.escape({\n  label: 'Magnet Type II',\n\n  newParams: () => ({k: 2}),\n\n  f: ({k}: Magnet2Params) => {\n    const pow = isInt(k) && k > 0 ? powInt : powFloat\n    return (c: Complex) => {\n      //const c = complex(x, y);\n      const a = addReal(c, -1);\n      const b = addReal(c, -2);\n      const a3 = multReal(a, 3);\n      const b3 = multReal(b, 3);\n      const ab = mult(a, b)\n      return (z: Complex) => pow(div(\n        add(add(powInt(z, 3), mult(a3, z)), ab),\n        add(add(multReal(powInt(z, 2), 3), mult(b3, z)), addReal(ab, 1))\n      ), k)\n    }\n  },\n\n  latexF: ({k}: Magnet2Params) => ('\\\\left(\\\\frac' \n  + '{z^3 + 3(x+yi-1)z + (x+yi-1)(x+yi-2)}' \n  + '{3z^2 + 3(x+yi-2)z + (x+yi-1)(x+yi-2) + 1}' \n  + '\\\\right)^{' + fmt.num(k) + '}'\n  ),\n\n  controls: [\n    {\n      type: ControlType.Number,\n      param: 'k',\n      label: 'exponent',\n      step: 0.5,\n    },\n    {\n      type: ControlType.Number,\n      param: 'bd',\n      label: 'bound',\n      step: 5,\n      min: 0,\n    },\n  ]\n})\n\n\nexport { Magnet1, Magnet2 }","import { Complex, ControlType, ControlProps } from './types';\nimport { EscapeParams, describeEscapeFunction } from './mixers/escape';\nimport * as mix from './mixers';\nimport { add, complex } from '../math/complex';\nimport { R as Math } from '../math';\nimport { mandelbox, burningship } from '../math/fractals';\nimport * as fmt from '../formatting';\nimport * as ctrl from './mixers/controls';\n\nfunction randomParams() {\n  return {box3: Math.round(Math.random() * 20)/10 + 2}\n}\n\n\nconst mandelboxFlatex = (v: number) => (\n  '\\\\left\\\\{\\\\begin{aligned}'\n  + `${fmt.num(2*v)} - n &, \\\\text{ if \\$n > ${fmt.num(v)}\\$}\\\\\\\\`\n  + `${fmt.num(-2*v)} - n &, \\\\text{ if \\$n < ${fmt.num(-v)}\\$}\\\\\\\\`\n  + 'n &, \\\\text{ otherwise}'\n  + '\\\\end{aligned}\\\\right.'\n);\n\nconst mandelboxAlatex = 'f(Re(z))+f(Im(z))i';\n\nconst mandelboxBlatex = (v: number) => (\n  '\\\\left\\\\{\\\\begin{aligned}'\n  + `${fmt.num(2*v)}z &, \\\\text{ if \\$|z|<${fmt.num(1/v)}\\$}\\\\\\\\`\n  + `z \\\\div |z|^2 &, \\\\text{ if \\$${fmt.num(1/v)} \\\\leq |z| < 1\\$}\\\\\\\\`\n  + 'z &, \\\\text{ otherwise}\\\\\\\\'\n  + '\\\\end{aligned}\\\\right.'\n)\n\nconst mandelboxClatex = (v: number) => fmt.num(v) + '\\\\cdot B(A(z)) + x + yi';\n\n\nfunction describeMandelbox(a: number, b: number, c: number, bound: number, iter: number) {\n  return [\n    {\n      math: 'f_{\\\\mathbb{R}\\\\mapsto\\\\mathbb{R}}(n) =' + mandelboxFlatex(a),\n      displayMode: true,\n    },\n    {\n      math: 'A_{\\\\mathbb{C}\\\\mapsto\\\\mathbb{C}}(z) =' + mandelboxAlatex,\n      displayMode: true,\n    },\n    {\n      math: 'B_{\\\\mathbb{C}\\\\mapsto\\\\mathbb{C}}(z) =' + mandelboxBlatex(b),\n      displayMode: true,\n    },\n    ...describeEscapeFunction(\n      mandelboxClatex(c),\n      '0',\n      bound,\n      iter,\n    )\n  ]\n} \n\nconst MandelboxRandom = ({\n  type: ControlType.Call,\n  icon: 'Random',\n  onCall: () => randomParams(),\n}) as ControlProps\n\nconst MandelboxControls = [\n  ctrl.number('box1', {step: 0.1}),\n  ctrl.number('box2', {step: 0.1}),\n  ctrl.number('box3', {step: 0.1}),\n]\n\n\nexport interface MandelboxParams {\n  box1: number,\n  box2: number,\n  box3: number,\n}\n\nexport const Mandelbox = mix.escape({\n  label: 'Mandelbox',\n\n  f: ({box1, box2, box3}: MandelboxParams) => {\n    const mbox = mandelbox(box1, box2, box3);\n    return (x: Complex) => (z: Complex) => {\n      return  add(mbox(z), x);\n    }\n  },\n\n  newParams: () => ({box1: 1, box2: 2, box3: 2.2}),\n\n  describe: ({box1, box2, box3, bd, iter}: MandelboxParams & EscapeParams) => {\n    return describeMandelbox(box1, box2, box3, bd, iter);\n  },\n\n  controls: [\n    MandelboxRandom,\n    ...MandelboxControls,\n    {\n      type: ControlType.Number,\n      param: 'bd',\n      label: 'bound',\n      step: 10,\n      min: 0,\n    }\n  ],\n\n});\n\n\n\nexport const Mandelcorner = mix.escape<MandelboxParams>({\n  label: 'Mandelcorner',\n  f: ({box1, box2, box3}) => (z0: Complex) => {\n    const cc = complex(z0.re, -z0.im);\n    const f1 = mandelbox(box1, box2, box3)\n    const bs = burningship()\n    return (zz: Complex) => {\n      let z = complex(zz.re, zz.im);\n      z = f1(z)\n      return add(bs(z), cc);\n    }\n  },\n\n  newParams: () => ({box1: 1, box2: 2, box3: 3}),\n\n  describe: ({box1, box2, box3}) => ['Mandelbox(' + [box1, box2, box3].map(v => fmt.num(v)).join(',') + ') -> Burning Ship'],\n\n  controls: [\n    MandelboxRandom,\n    ...MandelboxControls,\n    {\n      type: ControlType.Number,\n      param: 'bd',\n      label: 'bound',\n      step: 1,\n    }\n  ]\n})","import { Complex, ControlType } from './types';\nimport * as mix from './mixers';\nimport {\n  add,\n  powInt,\n  powFloat,\n} from '../math/complex';\nimport { isInt } from '../math/util';\nimport { num } from '../formatting'\n\n\n\nexport interface MandelbrotParams { k: number }\n\nexport const Mandelbrot = mix.escape({\n  label: 'Mandelbrot',\n  latexF: (p: MandelbrotParams) => `z^{${num(p.k)}}+x+yi`,\n  f: (p: MandelbrotParams) => {\n    const k = p.k;\n    if (isInt(k)) {\n      return (c: Complex) => (z: Complex) => add(powInt(z, k), c);\n    } else {\n      return (c: Complex) => (z: Complex) => add(powFloat(z, k), c);\n    }\n  },\n  newParams: () => ({k: 2}),\n  controls: [\n    {\n      type: ControlType.Number,\n      label: 'exponent (k)',\n      param: 'k',\n      step: 1,\n      min: 0,\n    }\n  ],\n})","import { Complex, ControlType } from './types';\nimport * as mix from './mixers';\nimport {\n  complex,\n} from '../math/complex';\nimport * as fmt from '../formatting'\nimport { burningship, phoenix, lookback } from '../math/fractals';\n\n\n\ninterface PhoenixParams {\n  p: number\n  k: number\n  c: [number,number]\n}\n\nconst Phoenix = mix.escape<PhoenixParams>({\n  label: \"Phoenix\",\n\n  newParams: () => ({p: -0.5, k: 2, c: [0.5667,0], iter: 40}),\n\n  f: ({p, k, c}: PhoenixParams) => {\n    return (_:Complex) => lookback(phoenix(p, k, c));\n  },\n\n  z0: () => (c: Complex) => complex(c.im, c.re),\n\n  latexZ0: () => 'y+xi',\n\n  latexF: ({p, k, c}: PhoenixParams) => {\n    return `z_{n}^{${fmt.num(k)}}${fmt.complex(c,{sign:true})}${fmt.num(p,{sign:true})}z_{n-1}`\n  },\n\n  controls: [\n    {\n      type: ControlType.Complex,\n      param: 'c',\n      label: 'c',\n      stepRadius: 0.02,\n      stepAngle: 0.05,\n    },\n    {\n      type: ControlType.Number,\n      param: 'p',\n      label: 'p',\n      step: 0.1,\n    },\n    {\n      type: ControlType.Number,\n      param: 'k',\n      label: 'k',\n      step: 0.5,\n    },\n  ]\n})\n\n\n\nconst PhoenixBurningShip = mix.escape<PhoenixParams>({\n  label: \"Phoenix/Burning Ship\",\n\n  newParams: () => ({p: -0.5, k: 2, c: [0.6,0]}),\n\n  f: ({p, k, c}: PhoenixParams) => {\n    const bs = burningship(k)\n    const px = phoenix(p, 1, c);\n    const f = (z: Complex, zp: Complex) => px(bs(z), zp)\n    return (_: Complex) => lookback(f);\n  },\n\n  z0: () => (c: Complex) => complex(c.im, c.re),\n\n  latexZ0: () => 'y+xi',\n\n  latexF: ({p, k, c}: PhoenixParams) => {\n    return `\\\\left(|Re(z_{n})|+|Im(z_{n})|\\\\right)^{${fmt.num(k)}}${fmt.complex(c,{sign:true})}${fmt.num(p,{sign:true})}z_{n-1}`\n  },\n\n  controls: [\n    {\n      type: ControlType.Complex,\n      param: 'c',\n      label: 'c',\n      stepRadius: 0.02,\n      stepAngle: Math.PI / 60,\n    },\n    {\n      type: ControlType.Number,\n      param: 'p',\n      label: 'p',\n      step: 0.1,\n    },\n    {\n      type: ControlType.Number,\n      param: 'k',\n      label: 'k',\n      step: 0.5,\n    },\n  ]\n})\n\n\nexport {\n  Phoenix,\n  PhoenixBurningShip,\n}","import { Complex, ControlType, FractalInterface } from './types';\nimport { EscapeParams, describeEscapeFunction } from './mixers/escape';\nimport { BurningShipParams } from './burningship';\nimport { MandelboxParams } from './mandelbox';\nimport * as mix from './mixers';\nimport {\n  complex,\n  add,\n  exp,\n  mult,\n  multReal,\n  abs2,\n  powInt,\n  powFloat,\n  powReal,\n} from '../math/complex';\nimport { R as Math } from '../math';\nimport { isInt } from '../math/util';\nimport * as fmt from '../formatting'\nimport { burningship, mandelbox, phoenix, lookback } from '../math/fractals';\nimport * as ctrl from './mixers/controls';\n\n\n\n\ninterface ExpoParams {\n  k: number\n}\n\nexport const Exponential = mix.escape<ExpoParams>({\n  label: {math: 'e^{z^k}+c'},\n\n  newParams: () => ({k: 3}),\n\n  latexF: ({k}: ExpoParams) => `e^{z^{${fmt.num(k)}}}+x+yi`,\n\n  f: ({k}: ExpoParams) => (c: Complex) => {\n    return (z: Complex) => add(exp(powReal(z, k)), c);\n  },\n\n  controls: [\n    {\n      type: ControlType.Number,\n      label: 'k',\n      param: 'k',\n      step: 0.5,\n    },\n    {\n      type: ControlType.Number,\n      label: 'bound',\n      param: 'bd',\n      min: 0,\n      step: 1,\n    },\n  ]\n})\n\n\ninterface P {\n  m1: number\n  m2: number\n  m3: number\n  k: number\n  p: number\n  c: [number, number]\n}\n\nexport const Test1 = mix.escape<P>({\n  label: 'Test',\n\n  newParams: () => ({p: 0.5, k: 2, m1: 2, m2: 2, m3: 2, c: [0.001, 0]}),\n\n  f: ({p, k, m1, m2, m3, c}) => {\n    const bs = burningship(k)\n    const bx = mandelbox(m1, m2, m3)\n    const px = phoenix(p, 1, c)\n    const f = (z: Complex, zp: Complex) => bx(px(bs(z), zp))\n    return (_: Complex) => lookback(f)\n  },\n\n  z0: () => (c: Complex) => c,\n\n  describe: () => [''],\n\n  controls: [\n    ctrl.complex('c'),\n    ctrl.number('k', {step: 0.5}),\n    ctrl.number('p', {step: 0.5}),\n    ctrl.number('m1', {step: 0.1}),\n    ctrl.number('m2', {step: 0.5}),\n    ctrl.number('m3', {step: 0.1}),\n\n  ]\n})","import { FractalInterface } from './types';\nimport {\n  BurningShip,\n  BurningShipMandelbox,\n} from './burningship';\nimport {\n  Julia,\n  Julia2Term,\n  JuliaBurningShip,\n  JuliaExp,\n  JuliaSinh,\n} from './julias';\nimport {\n  Magnet1,\n  Magnet2,\n} from './magnet';\nimport {\n  Mandelbox,\n  Mandelcorner,\n} from './mandelbox';\nimport {\n  Mandelbrot\n} from './mandelbrot';\nimport {\n  Phoenix,\n  PhoenixBurningShip,\n} from './phoenix';\nimport {\n  Test1\n} from './testing';\n\nexport const ALLFRACTALS: {[k: string]: FractalInterface<any>} = ({\n  Bs: BurningShip,\n  BsMbx: BurningShipMandelbox,\n  JlBs: JuliaBurningShip,\n  Jl1: Julia,\n  Jl2: Julia2Term,\n  JlExp: JuliaExp,\n  JlSinh: JuliaSinh,\n  Mg1: Magnet1,\n  Mg2: Magnet2,\n  Mbx: Mandelbox,\n  Md: Mandelbrot,\n  MbxBs: Mandelcorner,\n  Ph: Phoenix,\n  PhBs: PhoenixBurningShip,\n  Test1,\n});","import { ColorScheme as CS } from '../../../fractals/color/types';\n\nexport const UPDATE_COLOR = 'COLOR_UPDATE';\n\nexport type ColorScheme = CS\n\nexport interface ColorState {\n  schemeName: string\n  scheme: ColorScheme\n  reverse: boolean\n  skew: number\n}\n\nexport type UpdateColor = {\n  type: typeof UPDATE_COLOR,\n  payload: Partial<ColorState>,\n}\n\nexport type ColorAction = UpdateColor","import {\n  ViewState,\n  ViewAction,\n  UPDATE_VIEW,\n  RECENTER,\n  ZOOM_IN,\n  ZOOM_OUT,\n} from './types';\nimport { pixelCount, canvasSize } from '../../../defaults';\n\nconst initialState: ViewState = {\n  ...canvasSize,\n  cx: 0, \n  cy: 0,\n  ppu: 256,\n  pixelCount,\n}\n\nexport function recenterPPU({w, h}: {w: number, h: number}) {\n  return Math.round(Math.min(h,w)/5);\n}\n\nexport default function(state: ViewState={...initialState, ppu: recenterPPU(initialState)}, action: ViewAction) {\n  switch(action.type) {\n    case UPDATE_VIEW:\n      return {...state, ...action.payload}\n    case RECENTER:\n      return {...state, cx: 0, cy: 0, ppu: recenterPPU(state)}\n    case ZOOM_IN:\n      return {...state, ppu: state.ppu * action.payload}\n    case ZOOM_OUT:\n      return {...state, ppu: Math.round(state.ppu / action.payload)}\n    default:\n      return state;\n  }\n}"],"sourceRoot":""}