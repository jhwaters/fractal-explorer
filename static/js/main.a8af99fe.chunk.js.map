{"version":3,"sources":["fractals/formatting.ts","store/ui/types.ts","containers/Theme.tsx","components/Katex.tsx","components/TypographyWithMath.tsx","components/StyledSelect.tsx","components/CustomColor.tsx","components/DownUpButtons.tsx","components/NumberIncrementer.tsx","components/ComplexIncrementer.tsx","components/SettingsContainer.tsx","components/ColorPreview.tsx","components/ComplexNumberInput.tsx","containers/settings/SettingsMenu.tsx","components/NumberInput.tsx","containers/Bottombar.tsx","containers/settings/AlgorithmSettings.tsx","containers/settings/ColorSettings.tsx","containers/settings/ViewSettings.tsx","containers/settings/JSONInterface.tsx","containers/settings/index.ts","containers/canvas/Canvas.tsx","containers/canvas/index.ts","containers/controls/ControlPanel.tsx","containers/gallery/Gallery.tsx","containers/capture/Capture.tsx","containers/capture/index.ts","containers/controls/Zoom.tsx","containers/controls/Rotator.tsx","containers/controls/ParamControls.tsx","containers/controls/Iterator.tsx","containers/controls/Controls.tsx","containers/controls/index.ts","containers/gallery/index.ts","containers/Display.tsx","containers/controls/InfoButton.tsx","containers/controls/Recenter.tsx","containers/TopBar.tsx","containers/Info.tsx","containers/Waiting.tsx","containers/App.tsx","containers/Root.tsx","serviceWorker.ts","index.tsx","console/drawer/abstract.ts","console/drawer/util.ts","console/drawer/connected.ts","console/drawer/download.ts","console/drawer/zip.ts","console/drawer/disconnected.ts","console/drawer/scales.ts","console/drawer/animator.ts","console/console.ts","console/index.js","fractals/algorithm/types.ts","store/fractal/types.ts","fractals/math/real.ts","fractals/index.ts","store/fractal/algorithm/actions.ts","store/fractal/color/actions.ts","store/fractal/view/actions.ts","store/fractal/actions.ts","fractals/json/json3.ts","fractals/json/util.ts","fractals/json/index.ts","fractals/math/complex.ts","defaults.ts","fractals/drawer/transform.ts","store/fractal/view/types.ts","fractals/color/colorScale.ts","fractals/color/schemes.ts","fractals/color/index.ts","store/gallery/types.ts","store/fractal/drawState.ts","fractals/drawer/drawer.ts","fractals/drawer/image.ts","store/fractal/algorithm/reducer.ts","store/fractal/color/reducer.ts","store/fractal/reducer.ts","store/ui/reducer.ts","store/gallery/reducer.ts","store/reducer.ts","store/index.ts","fractals/drawer/view.ts","fractals/drawer/types.ts","fractals/math/polar.ts","store/fractal/algorithm/types.ts","fractals/algorithm/mixers/base.ts","fractals/algorithm/escapeTime.ts","fractals/algorithm/mixers/escape.ts","fractals/algorithm/mixers/julia.ts","fractals/algorithm/mixers/controls.ts","fractals/math/util.ts","fractals/math/polynomial.ts","fractals/math/fractals.ts","fractals/algorithm/burningship.ts","fractals/algorithm/julias.ts","fractals/algorithm/magnet.ts","fractals/algorithm/mandelbox.ts","fractals/algorithm/mandelbrot.ts","fractals/algorithm/phoenix.ts","fractals/algorithm/testing.ts","fractals/algorithm/fast.ts","fractals/algorithm/index.ts","store/ui/actions.ts","store/gallery/actions.ts","store/actions.ts","containers/canvas/Canvas.module.css","store/fractal/color/types.ts","store/fractal/view/reducer.ts"],"names":["num","n","sign","fixed","toFixed","toString","complex","a","b","opts","Nav","Modal","StretchMode","SET_MODAL","SET_NAV","SET_STRETCH","UPDATE_UI","ADD_COLOR_SCHEME","Theme","props","state","type","dark","this","setState","setDark","window","matchMedia","matches","addListener","x","theme","palette","darkPalette","lightPalette","createMuiTheme","CssBaseline","children","React","Component","defaultProps","primary","blue","secondary","pink","lightGreen","amber","MuiAppBar","color","MuiBackdrop","invisible","MuiTextField","variant","size","fullWidth","margin","styles","createStyles","root","whiteSpace","Katex","ref","createRef","current","katex","render","math","displayMode","renderMath","classes","className","createElement","PureComponent","withStyles","RenderStringOrMath","data","TextWithMath","Array","isArray","Typography","map","Select","width","TextField","Option","padding","MenuItem","OptionLabel","fontSize","TypographyWithMath","CustomColor","changeName","evt","name","target","value","changeNum","setNum","changeColor","i","colors","addColor","removeColor","save","onSave","onClose","validName","takenNames","forEach","k","toLowerCase","Math","max","length","push","slice","Grid","item","xs","onChange","style","borderRadius","InputLabel","Box","label","inputProps","p","height","scheme","mirror","reverse","skew","container","m","renderColorInput","alignSelf","onDown","disableDown","onUp","Button","disabled","onClick","position","marginTop","marginBottom","textAlign","bottom","userSelect","text","top","disableUp","downIcon","Icon","upIcon","rest","ButtonGroup","IconButton","NumberIncrementer","onClickDown","setValue","incrementDown","onClickUp","incrementUp","v","controlProps","min","step","undefined","params","fmt","ComplexIncrementer","onAngleDown","angleDown","onAngleUp","angleUp","onRadiusDown","radiusDown","onRadiusUp","radiusUp","toPolar","fromPolar","re","im","stepRadius","radius","stepAngle","angle","pol","RotateRight","RotateLeft","boxShadow","ColorPreview","docolors","canvas","context","getContext","orientation","cm","colorScale","fillStyle","fillRect","grid","strokeLinecap","fill","major","strokeWidth","strokeOpacity","minor","marker","ComplexNumberInput","GRID","round","getValueAtClick","onDoubleClick","r","pow","precision","stepRect","angles","stepX","stepY","max_radius","circle","cx","cy","hline","vline","rect_minor","polar_minor","rad","PI","cos","sin","RECT","MINOR","MAJOR","POLAR","makegrid","svg","rect","getBoundingClientRect","y","nativeEvent","clientX","clientY","clickX","clickY","d","vectorEffect","markerRadius","viewBox","join","stroke","gridColor","rectGrid","polarGrid","markerColor","Menu","NumberInput","s","isEmpty","isNaN","onBlur","emptyValue","borderTop","divider","StyledBottomNav","BottomNavigation","connect","ui","nav","galleryBadge","dispatch","setNav","BottomNavigationAction","Params","icon","Tune","Explore","Capture","Gallery","Badge","badgeContent","AlgorithmSettings","selectMethod","methodName","method","methodList","newParams","apply","setAlgorithm","reset","SettingsContainer","select","Object","keys","key","maxWidth","fractal","algorithm","recenter","redraw","ColorSettings","openCustomPopup","customPopup","closeCustomPopup","changeMirror","checked","changeReverse","changeSkew","console","log","checkCount","showCount","count","countInput","changeCount","selectScheme","setScheme","hasChanged","schemeName","saveScheme","addScheme","updateColor","schemeList","revert","sort","FormControlLabel","control","Switch","edge","display","FormControl","shrink","Slider","Popover","open","colorSchemeList","updates","recolor","addColorScheme","ViewSettings","centerStep","w","h","ppu","pixelCount","updateView","setCX","setCurrent","setCY","setW","setH","setPPU","setPixelCount","spacing","view","update","JSONTextField","fontFamily","JSONInterface","onCopyJson","navigator","clipboard","writeText","currentJson","onCopyLink","currentURL","onChangeJson","parsedJson","jsonToState","JSON","parse","jsonInput","urlToJson","split","onUploadJson","uploadData","selectText","Link","href","InputProps","onFocusCapture","readOnly","endAdornment","InputAdornment","title","Upload","stateToJson","stringify","jsonToUrl","StyledMenuItem","StyledLabel","ListItemText","StyledSwipeableDrawer","paper","flexDirection","SwipeableDrawer","SettingsDrawer","openMenu","setModal","openAlgorithm","menu","Algorithm","openColor","Color","openView","View","openJSON","closeAll","None","closePopup","openPopup","popup","labelStyle","listStyle","onOpen","List","ListItemIcon","Functions","Palette","Code","Divider","paddingTop","paddingBottom","Back","ListItem","left","right","version","SettingsMenu","modal","Canvas","fullResolution","canvasRef","centerOnClick","setCenter","t","offsetX","offsetY","stretch","Contain","ww","hh","imageH","imageW","dx","dy","inv","invert","image","createImageData","putImageData","finishDrawing","draw","drawState","DrawState","Draw","objectFit","outerClasses","Outer","outerstyle","visible","Stretch","Cover","id","canvasStretch","finish","Outside","backgroundColor","background","default","Paper","Inside","flexFlow","alignItems","justifyContent","Toolbar","ControlPanel","Popup","elevation","CropContainer","cropPixels","shouldRedraw","aspect","swapWH","getImage","cvs","document","getElementById","toDataURL","onCropChange","crop","onCropComplete","area","areaPixels","onZoomChange","zoom","capture","floor","Date","now","getTime","determineView","getData","ctx","toBlob","blob","url","URL","createObjectURL","addToGallery","finishCapture","startCapture","captureSize","prevProps","setTimeout","f","scaleFactor","cx_px","cy_px","ppuf","multiply","SwapHoriz","Fab","AddAPhoto","startWaiting","zoomIn","zoomOut","factor","ZoomOut","ZoomIn","onRotate","deg","rotateDeg","ParamControls","paramUpdater","param","onCall","startIcon","Random","ControlType","Number","renderNumberIncrementer","Complex","renderComplexIncrementer","Call","renderCall","controls","renderControl","updateParams","iter","Controls","Iterator","StyledGridList","GridList","StyledGridListTile","maxHeight","tile","GridListTile","StyledIconButton","ImageTile","cols","src","alt","GridListTileBar","actionIcon","onView","ViewImage","close","openDelete","Delete","onDelete","deleteImage","onDownload","download","click","onLoad","loadJson","viewer","cellHeight","images","index","Save","linkUrl","marginLeft","gallery","uploadJson","useStyles","makeStyles","overflow","flexGrow","Display","KatexButton","textTransform","formula","Info","Recenter","toolbar","disableMenu","rootClass","AppBar","marginRight","science","toPrecision","rx","ry","fractalinfo","describe","rounder","log10","centerx","centery","domainx","abs","domainy","marginThreshold","typography","progress","outline","waiting","CircularProgress","App","Root","store","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","error","require","uploadUrl","search","ReactDOM","process","origin","addEventListener","fetch","headers","response","contentType","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker","Base","t0","getView","getParams","COLORSCHEMES","fromEntries","entries","rangeGen","start","stop","promiseGenerator","gen","ms","next","done","Promise","resolve","promiseRangeGen","Connected","reduxStore","autodraw","reduxAction","delay","action","getState","getFractal","ALLFRACTALS","fixPolarParams","Abstract","THE_CONNECTED","new","filename","body","append","remove","revokeObjectURL","Zipper","zip","JSZip","file","generateAsync","Disconnected","fractalState","zipper","String","padStart","reject","imageData","toURL","json","drawImage","getAlgorithm","getColor","recenterPPU","parseState","fromState","baseScale","spec","scale","scaleLinear","domain","range","scaleLog","base","scalePow","exponent","r0","scaleZoom","makeScale","mappedScale","createScale","ang","polarScale","isRangeOnly","fixRangeOnly","addDomain","fixPolar","init","atan2","sqrt","isPolar","Animator","frames","scales","makeScales","run","initialize","animate","setMethod","currentParams","currentView","assign","fractalex","disconnected","animator","OPTS","logDrawTime","animateZoom","rotate","anim","startPPU","DOMMatrix","rotateSelf","c","magic","randomInt","random","shouldAnimate","minRad","maxRad","a1","a2","UPDATE_FRACTAL","TAU","asin","exp","calc","UPDATE_PARAMS","payload","SET_ALGORITHM","UPDATE_COLOR","UPDATE_VIEW","RECENTER","co","si","TRANSFORM","ZOOM_IN","ZOOM_OUT","fromNumArr","arr","replace","toNumArr","str","len","jsonToUrl3","obj","u","URLSearchParams","am","ap","cl","cs","cp","mi","rv","sk","vc","vs","vt","urlToJson3","entry","filter","ent","stateToJson3","result","jsonToState3","z","add","addReal","addPolar","subt","mult","multReal","div","abs2","powFloat","P","powInt","powReal","pow2","pow3","pow4","pow5","pow6","pow7","pow8","powN","sinh","divReal","colorSchemeName","canvasSize","det","pt","t1","t2","transformed","interpolator","piecewise","interpolateLab","scaleA","scaleB","scale1","scale2","colorMap","rgba","getImageData","d0","dd","D3_SCHEMES_1","Cool","Cubehelix","Greys","Inferno","Magma","Plasma","Rainbow","Sinebow","Spectral","Viridis","Warm","D3_SCHEMES_2","Blues","BrBG","BuGn","BuPu","GnBu","Greens","OrRd","Oranges","PRGn","PiYG","PuBu","PuBuGn","PuOr","PuRd","Purples","RdBu","RdGy","RdPu","RdYlBu","RdYlGn","Reds","YlGn","YlGnBu","YlOrBr","YlOrRd","ALL_SCHEMES","Paint","Ink","ADD_TO_GALLERY","MASS_ADD_TO_GALLERY","DELETE_IMAGE","FINISH_DRAWING","reducer","pixel","fixView","xdom","ydom","xscale","linearScale","yscale","transform","ImageData","makeImage","performance","initialState","reducer1","combineReducers","UPDATE_ALGORITHM","vw","rw","rh","createStore","pixels","bail","iterations","b2","z0","DefaultEscapeParams","calculate","func","escapeTime","zz","describeEscapeFunction","escape","baseFractalInterface","lz0","latexZ0","latexF","juliaLabel","juliaCalc","esc","julia","number","getRandomC","randomC","isInt","coeffs","allAreInts","BS","burningship","bs","cc","mandelbox","aa","f1","recip","f2","ab2","lookback","zp","z1","phoenix","po","multiplier","absabs","BurningShip","mix","BurningShipMandelbox","box1","box2","box3","mbox","ctrl","Julia2Term","poly","polynomial","JuliaExp","JuliaSinh","JuliaBurningShip","Magnet1","Magnet2","a3","b3","ab","mandelboxBlatex","describeMandelbox","mandelboxClatex","MandelboxRandom","FastMandelbox","box1a","box2a","box2b","ma","x0","y0","x2","y2","abso2","FastMandelcorner","Mandelbrot","MandelbrotJulia","Phoenix","pp","PhoenixJulia","_","PhoenixJuliaBurningShip","px","Test1","m1","m2","m3","bx","FastBurningShip","FastBurningShipMandelbox","box3a","FastJuliaMandelbrot","FastMandelbrot","FastPhoenix","py","x_","y_","xn","yn","FastPhoenixJulia","FastPhoenixBurningShip","FastPhoenixJuliaBurningShip","F_Bs","F_BsMbx","Mbx","F_Md","F_MdJl","MbxBs","F_Ph","F_PhJl","F_PhBs","F_PhJlBs","Bs","BsJl","BsMbx","Jl2","JlExp","JlSinh","Mg1","Mg2","Md","MdJl","Ph","PhJl","PhJlBs","module","exports"],"mappings":"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","file":"static/js/main.a8af99fe.chunk.js","sourcesContent":["\ntype NumberOpts = {\n  fixed?: number\n  round?: number\n  sign?: boolean\n}\n\nexport function num(n: number, {\n  sign,\n  fixed=4\n}: NumberOpts={}): string {\n  if (sign && !(n < 0)) {\n    return '+' + num(n, {fixed})\n  }\n  if (fixed) {\n    return (+(n.toFixed(fixed))).toString()\n  }\n  return n.toString()\n}\n\nexport function complex([a, b]: [number,number], opts: NumberOpts={}) {\n  return num(a,opts) + num(b,{...opts,sign:true}) + 'i'\n}\n\n\n\nexport function rounder(p: number) {\n  const d = Math.pow(10, p);\n  return (n: number) => Math.round(n * d) / d;\n}\n\n\n\nexport function science(n: number, p: number=4) {\n  const a = n.toPrecision(4);\n  const b = a.split('e')\n  if (b.length === 1) {\n    return a;\n  } else {\n    return b[0] + '\\\\times 10^{' + b[1] + '}'\n  }\n}","import { ALLFRACTALS, COLORSCHEMES } from '../../fractals';\nimport { ColorScheme as CS } from '../../fractals/color/types';\n\nexport type ColorScheme = CS\n\nexport const SET_MODAL = 'UI_SET_MODAL'\nexport const SET_NAV = 'UI_SET_NAV'\nexport const SET_STRETCH = 'UI_SET_STRETCH'\nexport const UPDATE_UI = 'UI_UPDATE'\nexport const ADD_COLOR_SCHEME = 'UI_ADD_COLOR_SCHEME'\n\nexport enum Nav {\n  Params,\n  Explore,\n  Capture,\n  Gallery,\n}\n\nexport enum Modal {\n  None,\n  Menu,\n  Info,\n  FullResolution,\n}\n\nexport enum StretchMode {\n  None,\n  Contain,\n  Cover,\n}\n\nexport interface UIState {\n  nav: Nav\n  modal: Modal\n  canvasStretch: StretchMode\n  galleryBadge: number\n  methodList: typeof ALLFRACTALS\n  colorSchemeList: typeof COLORSCHEMES\n  waiting: boolean\n}\n\nexport type UpdateUI = {\n  type: typeof UPDATE_UI\n  payload: Partial<UIState>\n}\n\nexport type SetModal = {\n  type: typeof SET_MODAL\n  payload: Modal\n}\n\nexport type SetNav = {\n  type: typeof SET_NAV\n  payload: Nav\n}\n\nexport type SetStretch = {\n  type: typeof SET_STRETCH\n  payload: StretchMode\n}\n\nexport type AddColorScheme = {\n  type: typeof ADD_COLOR_SCHEME\n  payload: {\n    name: string\n    scheme: ColorScheme\n  }\n}\n\nexport type UIAction = UpdateUI | SetModal | SetNav | SetStretch | AddColorScheme","import React from 'react';\nimport {\n  ThemeProvider as Provider, \n  createMuiTheme, \n} from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport {amber, pink, blue, lightGreen} from '@material-ui/core/colors';\n\n\ntype Props = {\n  type: 'light' | 'dark' | 'detect'\n  lightPalette?: any\n  darkPalette?: any\n  theme: any\n}\n\nclass Theme extends React.Component<Props> {\n  state: {type: 'light' | 'dark'}\n\n  static defaultProps = {\n    type: 'detect',\n\n    lightPalette: {\n      primary: blue,\n      secondary: pink,\n    },\n\n    darkPalette: {\n      primary: lightGreen,\n      secondary: amber,\n    },\n\n    theme: {\n      props: {\n        MuiAppBar: {color: 'inherit'},\n        MuiBackdrop: {\n          invisible: true\n        },\n        MuiTextField: {\n          variant: 'outlined',\n          size: 'small',\n          fullWidth: true,\n          margin: 'normal',\n        },\n      },\n    }\n  }\n\n  constructor(props: React.PropsWithChildren<Props>) {\n    super(props);\n    this.state = {\n      type: this.props.type === 'detect' ? 'light' : this.props.type\n    }\n  }\n\n  setDark(dark: boolean) {\n    this.setState({type: dark ? 'dark' : 'light'})\n  }\n\n  componentDidMount() {\n    if (this.props.type === 'detect') {\n      this.setDark(window.matchMedia(\"(prefers-color-scheme:dark)\").matches)\n      window.matchMedia(\"(prefers-color-scheme:dark)\").addListener(x => {\n        this.setDark(x.matches)\n      })\n    }\n  }\n\n  render() {\n    const theme = {\n      ...this.props.theme,\n      palette: {\n        ...this.props.theme.palette,\n        ...this.state,\n        ...(this.state.type === 'dark' ? this.props.darkPalette : this.props.lightPalette)\n      }\n    }\n    return (\n      <Provider theme={createMuiTheme(theme)}>\n        <CssBaseline/>\n        {this.props.children}\n      </Provider>\n    )\n  }\n}\n\nexport default Theme;","import React from 'react'\nimport katex from 'katex'\nimport { withStyles, createStyles, WithStyles } from '@material-ui/core/styles';\nimport 'katex/dist/katex.css';\n\n\nconst styles = createStyles({\n  root: {\n    whiteSpace: 'nowrap',\n  }\n})\n\nexport interface KatexProps {\n  math: string\n  displayMode?: boolean\n  className?: string\n  style?: React.CSSProperties\n}\n\ninterface Props extends KatexProps, WithStyles<typeof styles> {}\n\nclass Katex extends React.PureComponent<Props> {\n  ref: React.RefObject<HTMLSpanElement>\n\n  constructor(props: Props) {\n    super(props);\n    this.ref = React.createRef();\n  }\n\n  renderMath() {\n    if (this.ref.current) {\n      katex.render(this.props.math, this.ref.current, {\n        displayMode: this.props.displayMode\n      })\n    }\n  }\n\n  componentDidMount() {\n    this.renderMath()\n  }\n\n  componentDidUpdate() {\n    this.renderMath()\n  }\n\n  render() {\n    const { classes, className } = this.props;\n    return React.createElement('span', {\n      ref: this.ref,\n      className: className ? classes.root + ' ' + className : classes.root,\n    })\n  }\n}\n\nexport default withStyles(styles)(Katex)","import React from 'react';\nimport Katex, { KatexProps } from './Katex';\nimport Typography, {TypographyProps} from '@material-ui/core/Typography';\n\n\nexport type StringOrMath = string | KatexProps\n\nconst RenderStringOrMath = (data: StringOrMath) => {\n  if (typeof data === 'string') {\n    return data;\n  } else {\n    return React.createElement(Katex, data);\n  }\n}\n\nexport type StringWithMath = StringOrMath | StringOrMath[]\n\nexport interface TypographyWithMathProps extends TypographyProps {\n  data: StringWithMath\n  className?: string\n}\n\nconst TextWithMath = ({data, ...props}: TypographyWithMathProps) => {\n  if (Array.isArray(data)) {\n    return React.createElement(Typography, props, ...data.map(RenderStringOrMath))\n  }\n  if (typeof data === 'string') {\n    return React.createElement(Typography, props, data);\n  }\n  return React.createElement(Typography, props, React.createElement(Katex, data));\n}\n\nexport default TextWithMath","import MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\nimport TypographyWithMath from './TypographyWithMath';\nimport { withStyles, Theme } from '@material-ui/core/styles';\n\n\nexport const Select = withStyles((theme: Theme) => ({\n  root: {\n    width: '200px',\n  },\n}))(TextField)\n\nexport const Option = withStyles((theme: Theme) => ({\n  root: {\n    padding: '0.5em',\n  }\n}))(MenuItem)\n\n\nexport const OptionLabel = withStyles((theme: Theme) => ({\n  root: {\n    fontSize: '0.8em',\n  }\n}))(TypographyWithMath)\n","import React from 'react';\nimport { ColorPreview, DownUpButtons } from '.';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport TextField from '@material-ui/core/TextField';\n\n\ntype Props = {\n  takenNames: string[],\n  onSave: (name: string, colors: string[]) => void;\n  onClose: () => void;\n}\n\ntype State = {\n  name: string,\n  num: number,\n  colors: string[],\n}\n\nclass CustomColor extends React.Component<Props> {\n  state: State\n\n  static defaultProps = {\n    takenNames: [],\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      name: '',\n      num: 2,\n      colors: ['#FF0055', '#0055FF'],\n    }\n  }\n\n  changeName = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    const name = evt.target.value;\n    this.setState({name});\n  }\n\n  setNum(n: number) {\n    const num = Math.max(2, n)\n    let colors = [...this.state.colors];\n    if (num > colors.length) {\n      const x = colors[colors.length-1];\n      while (colors.length < num) {\n        colors.push(x);\n      }\n    } else {\n      colors = colors.slice(0,num);\n    }\n    this.setState({num, colors});\n  }\n\n  changeNum = (evt: React.ChangeEvent<HTMLInputElement>) => this.setNum(+evt.target.value)\n\n  changeColor = (i: number) => {\n    return (evt: React.ChangeEvent<HTMLInputElement>) => {\n      const colors = [...this.state.colors];\n      colors[i] = evt.target.value;\n      this.setState({colors});\n    }\n  }\n\n  addColor = () => this.setNum(this.state.num + 1);\n  removeColor = () => this.setNum(this.state.num - 1);\n\n  save = () => {\n    this.props.onSave(this.state.name, this.state.colors);\n    this.props.onClose();\n  }\n\n  validName = () => {\n    if (this.state.name === '') {\n      return false;\n    }\n    this.props.takenNames.forEach(k => {\n      if (k.toLowerCase() === this.state.name.toLowerCase()) {\n        return false;\n      }\n    })\n    return true;\n  }\n\n  renderColorInput(i: number) {\n    if (i < this.state.colors.length) {\n      return (\n        <Grid item xs={1}>\n          <input type=\"color\"\n            value={this.state.colors[i]}\n            onChange={this.changeColor(i)}\n            style={{width: '40px', borderRadius: 0, padding: 0}}\n          />\n        </Grid>\n      )\n    }\n    return null;\n  }\n\n  render() {\n    return (\n      <>\n\n        <InputLabel>New Colorscheme</InputLabel>\n\n        <Box>\n        <TextField\n              label=\"Name\"\n              variant=\"filled\"\n              value={this.state.name}\n              onChange={this.changeName}\n              inputProps={{type: 'text'}}\n            />\n        </Box>\n        <Box p={1}>\n          <ColorPreview\n            style={{width: '100%', height: '4mm'}}\n            scheme={this.state.colors}\n            mirror={false}\n            reverse={false}\n            skew={0}\n            width={100}\n            height={10}\n          />\n        </Box>\n        <Box>\n          <Grid container>\n            {this.state.colors.map((color: string, i: number) => (\n              <Box m={0.5}>{this.renderColorInput(i)}</Box>\n            ))}\n          </Grid>\n          <Box m={1}>\n            <DownUpButtons\n              variant=\"contained\"\n              style={{alignSelf: 'center'}}\n              onDown={this.removeColor}\n              disableDown={this.state.colors.length < 3}\n              onUp={this.addColor}\n            />\n          </Box>\n          <Box>\n          <Button \n              fullWidth color=\"primary\"\n              disabled={!this.validName()}\n              onClick={this.save}\n            >Save</Button>\n          </Box>\n        </Box>\n      </>\n    )\n  }\n}\n\nexport default CustomColor","import React from 'react';\nimport Box from '@material-ui/core/Box';\nimport ButtonGroup, { ButtonGroupProps } from '@material-ui/core/ButtonGroup';\nimport IconButton from '@material-ui/core/IconButton';\nimport Typography from '@material-ui/core/Typography';\nimport { createStyles, withStyles, WithStyles, Theme } from '@material-ui/core/styles';\nimport SvgIcon from '@material-ui/core/SvgIcon';\nimport * as Icon from './icons'\n\n\nconst styles = ({palette}: Theme) => createStyles({\n  container: {\n    position: 'relative',\n    marginTop: '5px',\n    marginBottom: '5px',\n  },\n  label: {\n    textAlign: 'center',\n    position: 'absolute',\n    bottom: '-5px',\n    width: '100%',\n    userSelect: 'none',\n    color: palette.text.secondary,\n  },\n  value: {\n    textAlign: 'center',\n    position: 'absolute',\n    top: '-5px',\n    width: '100%',\n    userSelect: 'none',\n    color: palette.text.secondary,\n  }\n});\n\n\nexport interface DownUpButtonsProps extends WithStyles<typeof styles>, Omit<ButtonGroupProps, 'classes'> {\n  [k: string]: any\n  onUp?: () => void\n  onDown?: () => void\n  disableUp?: boolean\n  disableDown?: boolean\n  value?: string\n  label?: string\n  fontSize?: \"small\" | \"default\" | \"large\" | \"inherit\"\n  iconDown?: typeof SvgIcon\n  iconUp?: typeof SvgIcon\n}\n\n\nconst DownUpButtons = ({label, value, classes, onUp, onDown, fontSize, \n  disableUp, disableDown, downIcon=Icon.Minus, upIcon=Icon.Plus,\n  ...rest\n}: DownUpButtonsProps) => (\n\n  <Box className={classes.container}>\n      {label ? (\n        <Typography variant=\"caption\" className={classes.label}>\n          {label}\n        </Typography>\n      ) : null}\n      {value ? (\n        <Typography variant=\"caption\" className={classes.value}>\n          {value}\n        </Typography>\n      ) : null}\n    <ButtonGroup {...rest}>\n      <IconButton\n        onClick={onDown}\n        disabled={disableDown}\n      >{React.createElement(downIcon, {fontSize})}</IconButton> \n      <IconButton\n        onClick={onUp}\n        disabled={disableUp}\n      >{React.createElement(upIcon, {fontSize})}</IconButton>\n    </ButtonGroup>\n  </Box>\n)\n\nexport default withStyles(styles)(DownUpButtons)","import React from 'react';\nimport { ControlNumber } from '../fractals/algorithm/types'\nimport DownUpButtons, { DownUpButtonsProps } from './DownUpButtons';\nimport * as fmt from '../fractals/formatting';\n\ninterface NewProps {\n  controlProps: ControlNumber\n  value: number\n  onChange: (x: number) => void\n}\n\ninterface Props extends NewProps, Omit<DownUpButtonsProps, 'label' | 'onDown' | 'onUp'> {}\n\nclass NumberIncrementer extends React.Component<Props> {\n\n  setValue(v: number) {\n    this.props.onChange(v)\n  }\n\n  incrementDown() {\n    const {min, step} = this.props.controlProps;\n    const v = this.props.value - step;\n    if (min !== undefined) {\n      return Math.max(min, v)\n    }\n    return v;\n  }\n\n  incrementUp() {\n    const {max, step} = this.props.controlProps;\n    const v = this.props.value + step;\n    if (max !== undefined) {\n      return Math.min(max, v)\n    }\n    return v;\n  }\n\n  onClickDown = () => {\n    this.setValue(this.incrementDown())\n  }\n\n  onClickUp = () => {\n    this.setValue(this.incrementUp())\n  }\n\n\n  render() {\n    const {controlProps, params, onChange, ...rest} = this.props;\n    return (\n      <DownUpButtons\n        {...rest}\n        value={fmt.num(this.props.value)}\n        label={controlProps.label}\n        onDown={this.onClickDown}\n        onUp={this.onClickUp}\n      />\n    )\n  }\n}\n\nexport default NumberIncrementer\n","import React from 'react';\nimport { ControlComplex } from '../fractals/algorithm/types'\nimport DownUpButtons, { DownUpButtonsProps } from './DownUpButtons';\nimport {\n  complex,\n  fromPolar,\n  toPolar,\n} from '../fractals/math/complex';\nimport { Polar } from '../fractals/math/types';\nimport { Icon } from '.';\nimport * as fmt from '../fractals/formatting';\n\n//const round = (n: number) => Math.round(n * 100000) / 100000\n\ntype Vec = [number, number]\n\ninterface NewProps {\n  controlProps: ControlComplex\n  value: Vec\n  onChange: (x: Vec) => void\n}\n\ninterface Props extends NewProps, Omit<DownUpButtonsProps,'onChange'> {}\n\nclass ComplexIncrementer extends React.Component<Props> {\n\n  setValue(v: Vec) {\n    this.props.onChange(v)\n  }\n\n  toPolar() {\n    return toPolar(complex(this.props.value[0], this.props.value[1]))\n  }\n\n  fromPolar(v: Polar): Vec {\n    const a = fromPolar(v);\n    return [a.re, a.im];\n  }\n\n  radiusDown(): Vec {\n    const {stepRadius} = this.props.controlProps;\n    const p = this.toPolar();\n    return this.fromPolar({...p, radius: p.radius-stepRadius})\n  }\n\n  radiusUp(): Vec {\n    const {stepRadius} = this.props.controlProps;\n    const p = this.toPolar();\n    return this.fromPolar({...p, radius: p.radius+stepRadius})\n  }\n\n  angleDown(): Vec {\n    const {stepAngle} = this.props.controlProps;\n    const p = this.toPolar();\n    return this.fromPolar({...p, angle: p.angle-stepAngle})\n  }\n\n  angleUp(): Vec {\n    const {stepAngle} = this.props.controlProps;\n    const p = this.toPolar();\n    return this.fromPolar({...p, angle: p.angle+stepAngle})\n  }\n\n\n  onAngleDown = () => {\n    this.setValue(this.angleDown())\n  }\n\n  onAngleUp = () => {\n    this.setValue(this.angleUp())\n  }\n\n  onRadiusDown = () => {\n    this.setValue(this.radiusDown())\n  }\n\n  onRadiusUp = () => {\n    this.setValue(this.radiusUp())\n  }\n\n\n  render() {\n    const {controlProps, onChange, ...rest} = this.props;\n    const pol = this.toPolar();\n    return (\n      <>\n      <DownUpButtons\n        {...rest}\n        //label={controlProps.label + ': '}\n        value={fmt.num(pol.angle)}\n        label={controlProps.label + ': angle'}\n        onDown={this.onAngleDown}\n        onUp={this.onAngleUp}\n        downIcon={Icon.RotateRight}\n        upIcon={Icon.RotateLeft}\n      />\n      <DownUpButtons\n        {...rest}\n        value={fmt.num(pol.radius)}\n        label={controlProps.label + ': radius'}\n        onDown={this.onRadiusDown}\n        onUp={this.onRadiusUp}\n      />\n      </>\n    )\n  }\n}\n\nexport default ComplexIncrementer\n","import Box from '@material-ui/core/Box';\nimport { withStyles, Theme, createStyles } from '@material-ui/core/styles';\n\n\nconst styles = createStyles((theme: Theme) => ({\n  root: {\n    height: '100%',\n  }\n}));\n\n\nexport default withStyles(styles)(Box)","import React from 'react';\nimport { ColorScheme } from '../fractals/color/types';\nimport { colorScale } from '../fractals/color';\nimport { withStyles, WithStyles, createStyles } from '@material-ui/core/styles';\n//import { CSSProperties } from '@material-ui/core'\n\n\nexport interface ColorPreviewProps {\n  width: number\n  height: number\n  orientation: string\n  scheme: ColorScheme\n  mirror: boolean\n  reverse: boolean\n  skew: number\n  style?: React.CSSProperties\n}\n\nconst styles = createStyles({\n  root: {\n    borderRadius: '8px',\n    boxShadow: '2px 2px 4px rgba(0,0,0,0.5)',\n  }\n})\n\ninterface Props extends ColorPreviewProps, WithStyles<typeof styles> {}\n\nclass ColorPreview extends React.Component<Props> {\n  ref: React.RefObject<HTMLCanvasElement>\n\n  static defaultProps = {\n    width: 400,\n    height: 10,\n    orientation: 'horizontal',\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.ref = React.createRef();\n  }\n\n  componentDidMount() {\n    this.docolors();\n  }\n\n  componentDidUpdate() {\n    this.docolors();\n  }\n\n  docolors() {\n    const canvas = this.ref.current;\n    if (canvas) {\n      const context = canvas.getContext('2d');\n      if (context) {\n        const { scheme, mirror, reverse, skew, width, height, orientation } = this.props;\n        if (orientation === 'horizontal') {\n          const cm = colorScale({scheme, reverse, skew, mirror})([0,width]);\n          let i = width + 1;\n          while (i--) {\n            context.fillStyle = cm(i);\n            context.fillRect(i, 0, 1, height);\n          }\n        } else {\n          const cm = colorScale({scheme, mirror, reverse, skew})([height,0]);\n          let i = height + 1;\n          while (i--) {\n            context.fillStyle = cm(i);\n            context.fillRect(0, i, width, 1);\n          }\n        }\n      }\n    }\n  }\n\n  render() {\n    return (\n      <canvas ref={this.ref} \n        width={this.props.width} \n        height={this.props.height} \n        style={this.props.style}\n        className={this.props.classes.root}\n      />\n    )\n  }\n}\n\nexport default withStyles(styles)(ColorPreview)","import React from 'react';\nimport { withStyles, createStyles, WithStyles } from '@material-ui/core/styles';\n\n\nexport interface ComplexNumberInputProps {\n  value: [number, number],\n  max: number,\n  onClick?: (v: [number, number]) => void,\n  onDoubleClick?: (v: [number, number]) => any,\n  size: number,\n  precision: number,\n  stepRect: number,\n  stepRadius: number,\n  stepAngle: number,\n  angles?: number[],\n  style?: React.CSSProperties,\n  markerColor: string,\n  gridColor?: string,\n  textColor?: string,\n}\n\n\nconst styles = createStyles({\n  root: {\n    padding: '0px',\n    userSelect: 'none',\n  },\n  \n  grid: {\n    strokeLinecap: 'square',\n    fill: 'none',\n  },\n  \n  major: {\n    strokeWidth: 0.5,\n    strokeOpacity: 1,\n  },\n  \n  minor: {\n    strokeWidth: 0.5,\n    strokeOpacity: 0.3,\n  },\n  \n  marker: {\n    strokeWidth: 0,\n  },\n});\n\n\ninterface Props extends ComplexNumberInputProps, WithStyles<typeof styles> {}\n\nclass ComplexNumberInput extends React.Component<Props> {\n  ref: React.RefObject<SVGSVGElement>\n  GRID: {\n    RECT?: {MAJOR?: string, MINOR?: string},\n    POLAR?: {MAJOR?: string, MINOR?: string},\n  }\n  round: (n: number) => number\n\n  static defaultProps = {\n    size: 100,\n    precision: 3,\n    stepAngle: 30,\n    stepRadius: 0.2,\n    stepRect: 0.2,\n\n    markerColor: 'blue',\n    //gridColor: 'black',\n  }\n\n  constructor(props: React.PropsWithChildren<Props>) {\n    super(props);\n    this.ref = React.createRef();\n    const r = Math.pow(10, props.precision);\n    this.round = (n: number) => Math.round(n*r) / r;\n    const {max, stepRadius, stepRect, stepAngle, angles} = this.props;\n    this.GRID = makegrid({max, stepRadius, stepAngle, angles, stepX: stepRect, stepY: stepRect});\n  }\n\n  getValueAtClick(evt: any): [number, number] | undefined {\n    const svg = this.ref.current;\n    if (svg) {\n      const rect = svg.getBoundingClientRect();\n      const {x, y} = rect;\n      const {clientX, clientY} = evt.nativeEvent;\n      const clickX = ((clientX - x) / this.props.size - 0.5) * 2*this.props.max;\n      const clickY = -((clientY - y) / this.props.size - 0.5) * 2*this.props.max;\n      return [this.round(clickX), this.round(clickY)];\n    }\n  }\n\n  onClick = (evt: any) => {\n    if (this.props.onClick) {\n      const p = this.getValueAtClick(evt);\n      if (p) this.props.onClick(p);\n    }\n  }\n\n  onDoubleClick = (evt: any) => {\n    if (this.props.onDoubleClick) {\n      const p = this.getValueAtClick(evt);\n      if (p) this.props.onDoubleClick(p);\n    }\n  }\n\n  polarGrid() {\n    if (this.GRID.POLAR) {\n      return (\n        <>\n        {this.GRID.POLAR.MINOR ? (\n          <path d={this.GRID.POLAR.MINOR} \n            className={this.props.classes.minor} \n            vectorEffect=\"non-scaling-stroke\"/>\n        ) : null}\n        {this.GRID.POLAR.MAJOR ? (\n          <path d={this.GRID.POLAR.MAJOR} \n            className={this.props.classes.major} \n            vectorEffect=\"non-scaling-stroke\"/>\n        ) : null}\n        </>\n      )\n    }\n    return null;\n  }\n\n  rectGrid() {\n    if (this.GRID.RECT) {\n      return (\n        <>\n        {this.GRID.RECT.MINOR ? (\n          <path d={this.GRID.RECT.MINOR} \n            className={this.props.classes.minor} \n            vectorEffect=\"non-scaling-stroke\"/>\n        ) : null}\n        {this.GRID.RECT.MAJOR ? (\n          <path d={this.GRID.RECT.MAJOR} \n            className={this.props.classes.major} \n            vectorEffect=\"non-scaling-stroke\"/>\n        ) : null}\n        </>\n      )\n    }\n    return null;\n  }\n  \n  render() {\n    const markerRadius = this.props.max / 24;\n    const viewBox = [-this.props.max, -this.props.max, 2*this.props.max, 2*this.props.max]\n    return (\n      <svg \n        ref={this.ref}\n        onClick={this.onClick}\n        onDoubleClick={this.onDoubleClick}\n        viewBox={viewBox.join(' ')}\n        className={this.props.classes.root}\n        style={{...this.props.style, width: this.props.size, height: this.props.size}}\n      >\n        <g className={this.props.classes.grid}\n          style={{stroke: this.props.gridColor}}\n        >\n          {this.rectGrid()}\n          {this.polarGrid()}\n        </g>\n        <circle \n          cx={this.props.value[0]}\n          cy={-this.props.value[1]}\n          r={markerRadius} \n          className={this.props.classes.marker}\n          style={{\n            stroke: this.props.markerColor,\n            fill: this.props.markerColor,\n          }}\n        />\n      </svg>\n    )\n  }\n}\n\n\nexport default withStyles(styles)(ComplexNumberInput)\n\n\nfunction makegrid({max, stepX, stepY, stepRadius, stepAngle, angles}: {\n  max: number,\n  stepX: number,\n  stepY: number,\n  stepAngle: number,\n  stepRadius: number,\n  angles?: number[],\n}) {\n  const max_radius = max * 1.5;\n\n  function circle(cx: number, cy: number, r: number) {\n    return (\n      'M' + cx+r + ',' + cy + \n      'A' + r + ',' + r + ',0,1,0,' + cx + ',' + cy + r +\n      'A' + r + ',' + r + ',0,0,0,' + cx + r + ',' + cy\n    )\n  }\n\n  function hline(v: number) {\n    return 'M' + (-max) + ',' + v + 'H' + max;\n  }\n\n  function vline(v: number) {\n    return 'M' + v + ',' + (-max) + 'V' + max;\n  }\n  \n  let rect_minor = ''\n  let i = 0;\n  while (i <= max) {\n    rect_minor += vline(i) + vline(-i);\n    i += stepX;\n  }\n\n  i = 0;\n  while (i <= max) {\n    rect_minor += hline(i) + hline(-i);\n    i += stepY;\n  }\n  \n  let polar_minor = '';\n  \n  if (angles) {\n    angles.forEach(a => {\n      const rad = a * Math.PI / 180;\n      polar_minor += 'M0,0L' + max_radius * Math.cos(rad) + ',' + max_radius * Math.sin(rad);\n    })\n  } else {\n    i = 0;\n    while (i < 360) {\n      const rad = i * Math.PI / 180;\n      polar_minor += 'M0,0L' + max_radius * Math.cos(rad) + ',' + max_radius * Math.sin(rad);\n      i += stepAngle;\n    }\n  }\n\n  i = stepRadius;\n  while (i <= max_radius) {\n    polar_minor += circle(0, 0, i);\n    i += stepRadius;\n  }\n\n  return {\n    RECT: {MINOR: rect_minor, MAJOR: hline(0) + vline(0)},\n    POLAR: {MINOR: polar_minor, MAJOR: circle(0, 0, 1)},\n  }\n  \n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { Modal } from '../../store/ui/types';\nimport { setModal } from '../../store/actions'\nimport AlgorithmSettings from './AlgorithmSettings';\nimport ColorSettings from './ColorSettings';\nimport ViewSettings from './ViewSettings';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Box from '@material-ui/core/Box';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Divider from '@material-ui/core/Divider';\nimport Typography from '@material-ui/core/Typography';\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer';\nimport JSONInterface from './JSONInterface';\nimport { withStyles } from '@material-ui/core/styles';\nimport { Icon } from '../../components';\nimport { version } from '../../../package.json';\n\ntype Props = {\n  open: boolean\n  setModal: (modal: Modal) => void\n}\n\nconst StyledMenuItem = withStyles({\n  root: {\n    padding: '1em',\n  }\n})(MenuItem)\n\nconst StyledLabel = withStyles({\n  root: {\n    padding: 0,\n    margin: 0,\n  }\n})(ListItemText)\n\n\nconst StyledSwipeableDrawer = withStyles({\n  paper: {\n    display: 'flex',\n    flexDirection: 'row',\n    height: '100%',\n    maxWidth: '90vw',\n  }\n})(SwipeableDrawer)\n\nenum Menu {\n  None,\n  Algorithm,\n  Color,\n  View,\n  JSON,\n}\n\nclass SettingsDrawer extends React.Component<Props> {\n  state: {\n    menu: Menu,\n    popup: boolean,\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      menu: Menu.None,\n      popup: false,\n    }\n  }\n\n\n\n  openMenu = () => this.props.setModal(Modal.Menu);\n  openAlgorithm = () => this.setState({menu: Menu.Algorithm});\n  openColor = () => this.setState({menu: Menu.Color});\n  openView = () => this.setState({menu: Menu.View});\n  openJSON = () => this.setState({menu: Menu.JSON});\n\n  closeAll = () => {\n    this.setState({menu: Menu.None});\n    this.closePopup();\n    this.props.setModal(Modal.None);\n  }\n\n  openPopup = () => this.setState({popup: true})\n  closePopup = () => this.setState({popup: false})\n\n  render() {\n    const labelStyle = this.state.menu === Menu.None ? {} : {display: 'none'};\n    const listStyle = this.state.menu === Menu.None ? {} : {width: '4em'}\n    return (\n      <StyledSwipeableDrawer\n        open={this.props.open}\n        onOpen={this.openMenu}\n        onClose={this.closeAll}\n      >\n        <List style={listStyle}>\n          <StyledMenuItem onClick={this.openAlgorithm}>\n            <ListItemIcon><Icon.Functions/></ListItemIcon>\n            <StyledLabel style={labelStyle}>Algorithm</StyledLabel>\n          </StyledMenuItem>\n          <StyledMenuItem onClick={this.openColor}>\n            <ListItemIcon><Icon.Palette/></ListItemIcon>\n            <StyledLabel style={labelStyle}>Colors</StyledLabel>\n          </StyledMenuItem>\n          <StyledMenuItem onClick={this.openView}>\n            <ListItemIcon><Icon.View/></ListItemIcon>\n            <StyledLabel style={labelStyle}>View</StyledLabel>\n          </StyledMenuItem>\n          <StyledMenuItem onClick={this.openJSON}>\n            <ListItemIcon><Icon.Code/></ListItemIcon>\n            <StyledLabel style={labelStyle}>Serialize</StyledLabel>\n          </StyledMenuItem>\n          <Divider/>\n          <StyledMenuItem onClick={this.closeAll} style={{paddingTop: '2em', paddingBottom: '2em'}}>\n            <ListItemIcon><Icon.Back/></ListItemIcon>\n            <StyledLabel style={labelStyle}>Close</StyledLabel>\n          </StyledMenuItem>\n          <ListItem style={{position: 'absolute', bottom: '0', left: '0', right: '0'}}>\n            <Typography style={labelStyle} variant=\"caption\">{version}</Typography>\n          </ListItem>\n        </List>\n        <Box>\n          {this.state.menu === Menu.Algorithm ? (\n            <AlgorithmSettings \n              //onClose={this.closeAll}\n            />\n          ) : this.state.menu === Menu.Color ? (\n            <ColorSettings\n              //onClose={this.closeAll}\n            />\n          ) : this.state.menu === Menu.View ? (\n            <ViewSettings\n              //onClose={this.closeAll}\n            />\n          ) : this.state.menu === Menu.JSON ? (\n            <JSONInterface/>\n          ) : null}\n        </Box>\n        \n      </StyledSwipeableDrawer>\n    )\n  }\n}\n\nexport default connect(\n  (state: State) => ({\n    open: state.ui.modal === Modal.Menu,\n  }),\n  (dispatch: Dispatch) => ({\n    setModal: (modal: Modal) => dispatch(setModal(modal))\n  })\n)(SettingsDrawer)","import React from 'react';\nimport TextField, { \n  StandardTextFieldProps,\n  FilledTextFieldProps,\n  OutlinedTextFieldProps,\n} from '@material-ui/core/TextField';\n\n\ninterface NewProps {\n  value?: number\n  step?: number\n  min?: number\n  max?: number\n  emptyValue?: number\n}\n\ninterface StandardNumberInputProps\n  extends NewProps, Omit<StandardTextFieldProps, 'value' | 'type'> {}\n\ninterface FilledNumberInputProps\n  extends NewProps, Omit<FilledTextFieldProps, 'value' | 'type'> {}\n\ninterface OutlinedNumberInputProps\n  extends NewProps, Omit<OutlinedTextFieldProps, 'value' | 'type'> {}\n\ntype NumberInputProps = \n  StandardNumberInputProps | \n  FilledNumberInputProps | \n  OutlinedNumberInputProps;\n\n\nclass NumberInput extends React.Component<NumberInputProps> {\n  state: {isEmpty: boolean}\n\n  constructor(props: NumberInputProps) {\n    super(props);\n    this.state = {\n      isEmpty: false\n    }\n  }\n\n  onChange = (evt: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const s = evt.target.value;\n    if (s === '') {\n      this.setState({isEmpty: true})\n    } else {\n      this.setState({isEmpty: false})\n    }\n    if (this.props.onChange) {\n      if (!isNaN(+s)) {\n        this.props.onChange(evt)\n      }\n    }\n  }\n\n  onBlur = (evt: React.FocusEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    if (this.props.onBlur) {\n      this.props.onBlur(evt);\n    }\n    this.setState({isEmpty: false});\n  }\n\n\n  render() {\n    const {step, min, max, inputProps, onChange, onBlur, value='', emptyValue=0, ...rest} = this.props;\n    return React.createElement(TextField, {\n      type: 'number',\n      value: value ? +value : this.state.isEmpty ? '' : emptyValue,\n      inputProps: {step, min, max, ...inputProps},\n      onChange: this.onChange,\n      onBlur: this.onBlur,\n      ...rest, \n    })\n  }\n}\n\n\nexport default NumberInput","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../store/types';\nimport { Nav } from '../store/ui/types';\nimport { setNav } from '../store/actions';\nimport BottomNavigation, { BottomNavigationProps } from '@material-ui/core/BottomNavigation';\nimport BottomNavigationAction from '@material-ui/core/BottomNavigationAction';\nimport Badge from '@material-ui/core/Badge';\nimport { withStyles, createStyles, Theme } from '@material-ui/core/styles';\nimport { Icon } from '../components';\n\n\nconst styles = createStyles(({palette}: Theme) => ({\n  root: {\n    position: 'absolute',\n    //top: 'auto',\n    bottom: 0,\n    width: '100%',\n    borderTop: '1px solid ' + palette.divider,\n  },\n}))\n\nconst StyledBottomNav = withStyles(styles)(BottomNavigation)\n\nconst BottomNav = (p: BottomNavigationProps & {galleryBadge: number}) => {\n  const {galleryBadge, ...props} = p;\n  return (\n    <StyledBottomNav {...props}>\n      \n      <BottomNavigationAction\n        value={Nav.Params}\n        label=\"Parameters\"\n        icon={<Icon.Tune/>}\n      />\n      <BottomNavigationAction\n        value={Nav.Explore}\n        label=\"Explore\"\n        icon={<Icon.Explore/>}\n      />\n      <BottomNavigationAction\n        value={Nav.Capture}\n        label=\"Capture\"\n        icon={<Icon.Capture/>}\n      />\n      <BottomNavigationAction\n        value={Nav.Gallery}\n        label=\"Saved\"\n        icon={\n          <Badge badgeContent={galleryBadge} color=\"primary\">\n            <Icon.Gallery/>\n          </Badge>\n        }\n      />\n    </StyledBottomNav>\n  )\n};\n\nexport default connect(\n  (state: State) => ({\n    value: state.ui.nav,\n    galleryBadge: state.ui.galleryBadge,\n  }),\n  (dispatch: Dispatch) => ({\n    onChange: (evt: any, x: Nav) => dispatch(setNav(x)),\n  })\n)(BottomNav)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State as AppState, Dispatch } from '../../store/types';\nimport { Method } from '../../store/fractal/algorithm/types';\nimport { setAlgorithm, recenter, redraw } from '../../store/actions';\nimport {\n  SettingsContainer, \n  Select,\n  Option,\n  OptionLabel,\n} from '../../components';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport Typography from '@material-ui/core/Typography';\n\n\ntype Props = {\n  methodName: string\n  params: object\n  methodList: {[k: string]: Method<any>}\n  setAlgorithm: <T extends object>(methodName: string, method: Method<T>, params?: T) => void\n  onClose?: () => void\n}\n\n\ninterface State {\n  methodName: string,\n  method: Method<any>\n  params: object,\n}\n\nclass AlgorithmSettings extends React.Component<Props> {\n  state: State\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      methodName: props.methodName,\n      method: props.methodList[props.methodName],\n      params: {...props.params},\n    };\n  }\n\n  selectMethod = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    const methodName = evt.target.value;\n    const method = this.props.methodList[methodName]\n    this.setState({methodName, method, params: method.newParams()});\n  }\n\n  apply = () => {\n    const {methodName, method, params} = this.state;\n    this.props.setAlgorithm(methodName, method, params)\n    if (this.props.onClose) {\n      this.props.onClose();\n    }\n  }\n\n  reset = () => {\n    const {methodName, params} = this.props;\n    this.setState({\n      methodName,\n      method: this.props.methodList[methodName],\n      params: {...params},\n    });\n  }\n\n  render() {\n    return (\n      <SettingsContainer>\n        <Box m={1}>\n          <Box m={1}>\n            <Select select\n              label=\"Method\"\n              value={this.state.methodName}\n              onChange={this.selectMethod}\n            >\n              {Object.keys(this.props.methodList).map(k => {\n                return (\n                  <Option key={k} value={k}>\n                    <OptionLabel\n                      data={this.props.methodList[k].label}\n                    />\n                  </Option>\n                )\n              })}\n            </Select>\n          </Box>\n          <Box m={1}>\n            <Typography style={{maxWidth: '200px'}} variant=\"body2\">\n              * Indicates method with improved rendering speed.\n            </Typography>\n          </Box>\n          <Box m={1}>\n            <ButtonGroup fullWidth color=\"primary\" orientation=\"vertical\">\n              <Button fullWidth onClick={this.apply}>Apply</Button>\n              <Button fullWidth onClick={this.reset}>Reset</Button>\n            </ButtonGroup>\n          </Box>\n        </Box>\n      </SettingsContainer>\n    )\n  }\n}\n\nexport default connect(\n  (state: AppState) => ({\n    methodName: state.fractal.algorithm.methodName,\n    methodList: state.ui.methodList,\n    params: state.fractal.algorithm.params,\n  }),\n  (dispatch: Dispatch) => ({\n    setAlgorithm: function<T>(methodName: string, method: Method<T>, params?: T) {\n      dispatch(setAlgorithm(methodName, method, params))\n      dispatch(recenter())\n      dispatch(redraw())\n    },\n  })\n)(AlgorithmSettings)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State as AppState } from '../../store/types';\nimport { ColorState, ColorScheme } from '../../store/fractal/color/types';\nimport { updateColor, recolor, addColorScheme } from '../../store/actions';\nimport {\n  ColorPreview,\n  SettingsContainer,\n  Select,\n  Option,\n  OptionLabel,\n  CustomColor,\n  NumberInput,\n} from '../../components';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Popover from '@material-ui/core/Popover';\nimport Slider from '@material-ui/core/Slider';\nimport Switch from '@material-ui/core/Switch';\n\n\ninterface Colors {\n  schemeName: string\n  mirror: boolean\n  reverse: boolean\n  skew: number\n  count: 'iter' | number\n}\n\n\ntype Props = {\n  current: Colors\n  updateColor: (update: Partial<ColorState>) => void\n  addScheme: (name: string, scheme: string[]) => void\n  onClose?: () => void\n  schemeList: {[k: string]: ColorScheme}\n}\n\n\ntype Evt = React.ChangeEvent<HTMLInputElement>\n\nclass ColorSettings extends React.Component<Props> {\n  state: {\n    schemeName: string\n    mirror: boolean\n    reverse: boolean\n    skew: number\n    count: 'iter' | number\n\n    customPopup: boolean\n    showCount: boolean\n    countInput: number\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      schemeName: props.current.schemeName,\n      mirror: props.current.mirror,\n      reverse: props.current.reverse,\n      skew: props.current.skew,\n      count: props.current.count,\n\n      showCount: props.current.count !== 'iter',\n      countInput: props.current.count === 'iter' ? 60 : props.current.count,\n      customPopup: false,\n    }\n  }\n\n  openCustomPopup = () => this.setState({customPopup: true})\n  closeCustomPopup = () => this.setState({customPopup: false})\n\n\n  setScheme(schemeName: string) {\n    this.setState({schemeName});\n  }\n\n  changeMirror = (evt: Evt) => this.setState({mirror: evt.target.checked});\n  changeReverse = (evt: Evt) => this.setState({reverse: evt.target.checked});\n  changeSkew = (evt: any, skew: number | number[]) => {\n    if (typeof skew === 'number') this.setState({skew});\n    else console.log(skew);\n  }\n  checkCount = (evt: Evt) => {\n    if (evt.target.checked) {\n      this.setState({\n        showCount: false,\n        count: 'iter',\n        mirror: false,\n      })\n    } else {\n      this.setState({\n        showCount: true,\n        count: this.state.countInput,\n        mirror: true\n      })\n    }\n  }\n\n  changeCount = (evt: Evt) => {\n    if (this.state.showCount) {\n      const count = +evt.target.value;\n      this.setState({count, countInput: count});\n    } else {\n      this.setState({countInput: +evt.target.value});\n    }\n  }\n\n  selectScheme = (evt: any) => {\n    const scheme = evt.target.value;\n    if (scheme === 'CUSTOM') {\n      this.openCustomPopup();\n    } else {\n      this.setScheme(scheme);\n    }\n  }\n\n  hasChanged = () => {\n    if (this.state.schemeName !== this.props.current.schemeName\n      || this.state.mirror !== this.props.current.mirror\n      || this.state.reverse !== this.props.current.reverse\n      || this.state.skew !== this.props.current.skew\n      || this.state.count !== this.props.current.count) {\n      return true;\n    }\n    return false;\n  }\n\n  saveScheme = (k: string, colors: string[]) => {\n    this.props.addScheme(k, colors);\n    this.setScheme(k);\n  }\n\n  apply = () => {\n    this.props.updateColor({\n      schemeName: this.state.schemeName,\n      scheme: this.props.schemeList[this.state.schemeName],\n      mirror: this.state.mirror,\n      reverse: this.state.reverse,\n      skew: this.state.skew,\n      count: this.state.count === 'iter' ? 0 : this.state.count,\n    });\n    if (this.props.onClose) {\n      this.props.onClose()\n    }\n  }\n\n  revert = () => {\n    this.setState({\n      schemeName: this.props.current.schemeName,\n      mirror: this.props.current.mirror,\n      reverse: this.props.current.reverse,\n      skew: this.props.current.skew,\n      count: this.props.current.count,\n    })\n  }\n\n  render() {\n    return (\n      <>\n        <SettingsContainer>\n          <Box m={1}>\n            <Box m={1}>\n              <Select select\n                label=\"Scheme\"\n                value={this.state.schemeName}\n                onChange={this.selectScheme}\n              >\n                <Option value=\"CUSTOM\">\n                  <OptionLabel data=\"CREATE NEW SCHEME\"/>\n                </Option>\n                {Object.keys(this.props.schemeList).sort().map(k => (\n                  <Option key={k} value={k}>\n                    <OptionLabel data={k}/>\n                  </Option>\n                ))}\n              </Select>\n            </Box>\n\n            <Box m={2}>\n              <FormControlLabel\n                label=\"Reversed\"\n                control={\n                  <Switch checked={this.state.reverse}\n                    onChange={this.changeReverse}\n                    edge=\"end\"\n                  />\n                }\n              />\n            </Box>\n\n            <Box m={2}>\n              <FormControlLabel\n                label=\"Match Iterations\"\n                control={\n                  <Switch checked={!this.state.showCount}\n                    onChange={this.checkCount}\n                    edge=\"end\"\n                  />\n                }\n              />\n            </Box>\n\n            <Box m={2} style={this.state.showCount ? {} : {display: 'none'}}>\n              <FormControlLabel\n                label=\"Mirror\"\n                control={\n                  <Switch checked={this.state.mirror}\n                    onChange={this.changeMirror}\n                    edge=\"end\"\n                  />\n                }\n              />\n            </Box>\n\n            <Box m={2} style={this.state.showCount ? {} : {display: 'none'}}>\n              <NumberInput\n                label=\"Count\"\n                value={this.state.countInput}\n                onChange={this.changeCount}\n                min={2}\n                step={1}\n                emptyValue={2}\n              />\n            </Box>\n\n            <Box m={2}>\n              <FormControl fullWidth>\n                <InputLabel shrink>Skew</InputLabel>\n                <Slider\n                  color=\"secondary\"\n                  value={this.state.skew}\n                  onChange={this.changeSkew}\n                  min={-5}\n                  max={5}\n                  step={0.1}\n                />\n              </FormControl>\n            </Box>\n\n            <Box m={1}>\n              <ColorPreview \n                style={{width: '100%', height: '4mm'}}\n                scheme={this.props.schemeList[this.state.schemeName]}\n                mirror={this.state.mirror}\n                reverse={this.state.reverse}\n                skew={this.state.skew}\n                width={100}\n                height={10}\n              />\n            </Box>\n\n            <Box m={1}>\n              <ColorPreview \n                style={{width: '100%', height: '4mm'}}\n                scheme={this.props.schemeList[this.state.schemeName]}\n                mirror={this.props.current.mirror}\n                reverse={this.props.current.reverse}\n                skew={this.props.current.skew}\n                width={100}\n                height={10}\n              />\n              <InputLabel>Current</InputLabel>\n            </Box>\n\n            \n            <ButtonGroup fullWidth color=\"primary\" orientation=\"vertical\">\n              <Button \n                onClick={this.apply}\n                disabled={!this.hasChanged()}\n              >Apply</Button>\n              <Button\n                onClick={this.revert}\n                disabled={!this.hasChanged()}\n              >Reset</Button>\n            </ButtonGroup>\n\n          </Box>\n        </SettingsContainer>\n\n        <Popover\n          open={this.state.customPopup}\n          onClose={this.closeCustomPopup}\n        >\n          <Box m={2}>\n            <CustomColor\n              onSave={this.saveScheme}\n              onClose={this.closeCustomPopup}\n              takenNames={Object.keys(this.props.schemeList)}\n            />\n          </Box>\n        </Popover>\n      </>\n    )\n  }\n}\n\nexport default connect(\n  (state: AppState) => ({\n    current: {\n      ...state.fractal.color,\n      count: state.fractal.color.count === 0 ? 'iter' : state.fractal.color.count\n    } as Colors,\n    schemeList: state.ui.colorSchemeList,\n  }),\n  (dispatch) => ({\n    updateColor: (updates: Partial<ColorState>) => {\n      dispatch(updateColor(updates));\n      dispatch(recolor());\n    },\n    addScheme: (k: string, colors: string[]) => {\n      dispatch(addColorScheme(k, colors));\n    },\n  }),\n)(ColorSettings);","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { ViewState } from '../../store/fractal/view/types';\nimport { updateView, redraw } from '../../store/actions';\nimport { NumberInput, SettingsContainer } from '../../components';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\n\ntype Props = {\n  current: ViewState\n  updateView: (update: Partial<ViewState>) => void\n  onClose?: () => void\n}\n\ntype Evt = React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>\n\nclass ViewSettings extends React.Component<Props> {\n  state: {\n    current: ViewState,\n  }\n  centerStep: number\n\n  constructor(props: Props) {\n    super(props);\n    this.centerStep = 10 / this.props.current.ppu;\n    this.state = {\n      current: {...props.current},\n    }\n  }\n\n  hasChanged = () => {\n    if (this.props.current.cx !== this.state.current.cx) return true;\n    if (this.props.current.cy !== this.state.current.cy) return true;\n    if (this.props.current.w !== this.state.current.w) return true;\n    if (this.props.current.h !== this.state.current.h) return true;\n    if (this.props.current.ppu !== this.state.current.ppu) return true;\n    if (this.props.current.pixelCount !== this.state.current.pixelCount) return true;\n    return false;\n  }\n\n  apply = () => {\n    this.props.updateView(this.state.current);\n    if (this.props.onClose) {\n      this.props.onClose()\n    }\n  }\n\n  revert = () => {\n    this.setState({current: {...this.props.current}});\n  }\n\n  setCurrent(x: Partial<ViewState>) {\n    this.setState({current: {...this.state.current, ...x}});\n  }\n\n  setCX = (evt: Evt) => this.setCurrent({cx: +evt.target.value});\n  setCY = (evt: Evt) => this.setCurrent({cy: +evt.target.value});\n  setW = (evt: Evt) => this.setCurrent({w: +evt.target.value});\n  setH = (evt: Evt) => this.setCurrent({h: +evt.target.value});\n  setPPU = (evt: Evt) => this.setCurrent({ppu: +evt.target.value});\n  setPixelCount = (evt: Evt) => this.setCurrent({pixelCount: +evt.target.value});\n\n\n  render() {\n    return (\n      <SettingsContainer\n      >\n        <Box m={1}>\n        <Box m={1}>\n          <InputLabel>Relative Dimensions</InputLabel>\n          <Grid container spacing={1}>\n            <Grid item xs={6}>\n              <NumberInput\n                fullWidth={false}\n                label=\"Width\"\n                value={+this.state.current.w} \n                onChange={this.setW}\n                step={1}\n                min={1}\n                inputProps={{style: {maxWidth: '5em'}}}\n              />\n            </Grid>\n            <Grid item xs={6}>\n              <NumberInput\n                fullWidth={false}\n                label=\"Height\" \n                value={+this.state.current.h} \n                onChange={this.setH} \n                step={1}\n                min={1}\n                inputProps={{style: {maxWidth: '5em'}}}\n              />\n            </Grid>\n          </Grid>\n\n          <Box>\n            <NumberInput\n              label=\"Pixel count\"\n              value={+this.state.current.pixelCount} \n              onChange={this.setPixelCount} \n              step={10000}\n              min={10000}\n            />\n          </Box>\n\n          <Box>\n            <NumberInput\n              label=\"Center x-coordinate\"\n              value={+this.state.current.cx} \n              onChange={this.setCX} \n              step={this.centerStep}\n            />\n          </Box>\n\n          <Box>\n            <NumberInput\n              label=\"Center y-coordinate\"\n              value={+this.state.current.cy} \n              onChange={this.setCY} \n              step={this.centerStep}\n            />\n          </Box>\n\n          <Box>\n            <NumberInput\n              label=\"Scale (pixels per unit)\"\n              value={+this.state.current.ppu} \n              onChange={this.setPPU} \n              step={10}\n              min={0}\n            />\n          </Box>\n\n          <ButtonGroup fullWidth color=\"primary\" orientation=\"vertical\">\n            <Button \n              onClick={this.apply}\n              disabled={!this.hasChanged()}\n            >Apply</Button>\n            <Button\n              onClick={this.revert}\n              disabled={!this.hasChanged()}\n            >Reset</Button>\n\n          </ButtonGroup>\n        </Box>\n      </Box>\n      </SettingsContainer>\n    )\n  }\n  \n}\n\nexport default connect(\n  (state: State) => ({\n    current: state.fractal.view,\n  }),\n  (dispatch: Dispatch) => ({\n    updateView: (update: Partial<ViewState>) => {\n      dispatch(updateView(update));\n      dispatch(redraw());\n    },\n  })\n)(ViewSettings)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { uploadData, redraw } from '../../store/actions';\nimport TextField from '@material-ui/core/TextField';\nimport Box from '@material-ui/core/Box';\nimport IconButton from '@material-ui/core/IconButton';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport { Icon } from '../../components';\nimport { withStyles } from '@material-ui/core/styles';\nimport { stateToJson, jsonToState, jsonToUrl, AppState, urlToJson } from '../../fractals/json';\nimport Link from '@material-ui/core/Link';\n\n\nconst JSONTextField = withStyles({\n  root: {\n    maxWidth: '240px',\n    '& textarea, input': {\n      fontFamily: 'roboto mono, monospace',\n      //'&[readonly]': {fontSize: '0.7em'},\n    },\n  },\n})(TextField)\n\n\ninterface Props {\n  currentJson: string,\n  currentURL: string,\n  uploadData: (data: AppState) => void,\n}\n\nclass JSONInterface extends React.Component<Props> {\n  state: {\n    jsonInput: string\n    parsedJson: AppState | undefined\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      jsonInput: '',\n      parsedJson: undefined,\n    }\n  }\n\n  onCopyJson = () => {\n    navigator.clipboard.writeText(this.props.currentJson);\n  }\n\n  onCopyLink = () => {\n    navigator.clipboard.writeText(this.props.currentURL);\n  }\n\n  onChangeJson = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    try {\n      const parsedJson = jsonToState(JSON.parse(evt.target.value));\n      this.setState({\n        jsonInput: evt.target.value,\n        parsedJson,\n      })\n    } catch {\n      try {\n        const data = urlToJson(evt.target.value.split('?').slice(-1)[0]);\n        if (data) {\n          const parsedJson = jsonToState(data);\n          this.setState({\n            jsonInput: evt.target.value,\n            parsedJson,\n          })\n        } else {\n          this.setState({jsonInput: evt.target.value, parsedJson: undefined});\n        }\n      } catch {\n        this.setState({jsonInput: evt.target.value, parsedJson: undefined});\n      }\n    }\n  }\n\n  onUploadJson = () => {\n    if (this.state.parsedJson) {\n      this.props.uploadData(this.state.parsedJson);\n    }\n  }\n\n  selectText = (evt: any) => {\n    evt.target.select();\n  }\n\n  render() {\n    return (\n      <Box m={2}>\n        <Box>\n          <Link \n            variant=\"body1\"\n            href={this.props.currentURL}>\n            Link to Current Fractal\n          </Link>\n        </Box>\n        <Box>\n          <JSONTextField\n            label=\"Current JSON\"\n            value={this.props.currentJson}\n            InputProps={{\n              onFocusCapture: this.selectText,\n              readOnly: true,\n            }}\n          />\n        </Box>\n        <Box>\n          <JSONTextField \n            label=\"Load from URL or JSON\"\n            onChange={this.onChangeJson}\n            value={this.state.jsonInput}\n            InputProps={{\n              endAdornment: (\n                <InputAdornment position=\"end\">\n                  <IconButton onClick={this.onUploadJson} disabled={!this.state.parsedJson} title=\"load data into viewer\">\n                    <Icon.Upload/>\n                  </IconButton>\n                </InputAdornment>\n              )\n            }}\n            />\n        </Box>\n\n      </Box>\n    )\n  }\n}\n\n\n\nexport default connect(\n  (state: State) => {\n    const data = stateToJson(state.fractal);\n    return ({\n      currentJson: JSON.stringify(data),\n      currentURL: jsonToUrl(data),\n    });\n  },\n  (dispatch: Dispatch) => ({\n    uploadData: (data: AppState) => {\n      dispatch(uploadData(data));\n      dispatch(redraw());\n    },\n  })\n)(JSONInterface)","import SettingsMenu from './SettingsMenu'\n\nexport default SettingsMenu","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State as AppState, Dispatch } from '../../store/types';\nimport { FractalState, DrawState } from '../../store/fractal/types';\nimport { setCenter, redraw, finish } from '../../store/actions';\nimport { StretchMode, Nav } from '../../store/ui/types';\nimport createImageData from '../../fractals/drawer/drawer';\nimport Box from '@material-ui/core/Box';\nimport styles from './Canvas.module.css';\nimport { invert, apply } from '../../fractals/drawer/transform';\n\n\ntype Props = {\n  visible: boolean\n  fractal: FractalState\n  stretch: StretchMode\n  setCenter: (x: number, y: number) => void\n  finishDrawing: () => void\n}\n\nclass Canvas extends React.Component<Props> {\n  fullResolution: boolean\n  canvasRef: React.RefObject<HTMLCanvasElement>\n\n  constructor(props: Props) {\n    super(props);\n    this.fullResolution = false;\n    this.canvasRef = React.createRef();\n  }\n\n  get canvas() {\n    return this.canvasRef.current as HTMLCanvasElement\n  }\n\n  draw() {\n    const image = createImageData(this.props.fractal);\n    if (image) {\n      this.canvas.width = image.width;\n      this.canvas.height = image.height;\n      this.canvas.getContext('2d')?.putImageData(image, 0, 0);\n    }\n    this.props.finishDrawing();\n  }\n\n  componentDidMount() {\n    if (this.canvas) {\n      this.draw()\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.props.fractal.drawState === DrawState.Draw) {\n      this.draw()\n    }\n    else if (this.props.fractal.drawState === DrawState.Color) {\n      // cant recolor without recalculating anymore\n      this.draw();\n    }\n  }\n\n  centerOnClick = (evt: any) => {\n    if (this.props.setCenter) {\n      if (this.canvas) {\n        const {h, w, ppu, cx, cy, t} = this.props.fractal.view;\n        let {width, height} = this.canvas.getBoundingClientRect();\n        let {offsetX, offsetY} = evt.nativeEvent;\n\n        if (this.props.stretch === StretchMode.Contain) {\n          const ww = width / w;\n          const hh = height / h;\n          if (hh > ww) {\n            const imageH = h * ww;\n            offsetY -= (height - imageH) / 2\n            height = imageH\n          } else if (ww > hh) {\n            const imageW = w * hh;\n            offsetX -= (width - imageW) / 2\n            width = imageW\n          }\n        }\n\n        const pixel_x = Math.round((offsetX / width) * w);\n        const pixel_y = Math.round((offsetY / height) * h);\n        let dx = (pixel_x - (w / 2)) / ppu;\n        let dy = (pixel_y - (h / 2)) / ppu;\n        if (t) {\n          const inv = invert(t);\n          if (inv) {\n            [dx, dy] = apply(inv, [dx, dy]);\n          }\n        }\n        this.props.setCenter(cx + dx, cy + dy);\n      }\n    }\n  }\n\n  render() {\n    const outerClasses = [styles.Outer]\n    let objectFit: 'contain' | 'cover' | undefined\n    const outerstyle = this.props.visible ? {} : {display: 'none'}\n    switch (this.props.stretch) {\n      case StretchMode.Contain:\n        objectFit = 'contain';\n        outerClasses.push(styles.Stretch);\n        break;\n      case StretchMode.Cover:\n        objectFit = 'cover';\n        outerClasses.push(styles.Stretch);\n        break;\n    }\n\n    return (\n      <Box m={0} className={outerClasses.join(' ')} style={outerstyle}>\n\n          <canvas\n            id=\"fractal-preview-canvas\"\n            className={styles.Canvas}\n            ref={this.canvasRef}\n            onDoubleClick={this.centerOnClick}\n            style={{objectFit}}\n          />\n      </Box>\n    )\n  }\n}\n\n\nexport default connect(\n  (state: AppState) => ({\n    visible: (state.ui.nav === Nav.Params || state.ui.nav === Nav.Explore),\n    fractal: {...state.fractal},\n    stretch: state.ui.canvasStretch,\n  }),\n  (dispatch: Dispatch) => ({\n    setCenter: (x: number, y: number) => {\n      dispatch(setCenter(x, y));\n      dispatch(redraw());\n    },\n    finishDrawing: () => dispatch(finish()),\n  })\n)(Canvas)","import Canvas from './Canvas';\n\n\nexport default Canvas;","import React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport { withStyles, Theme } from '@material-ui/core/styles';\nimport Toolbar from '@material-ui/core/Toolbar';\n\ntype Props = {\n  visible: boolean\n}\n\nconst Outside = withStyles((theme: Theme) => ({\n  root: {\n    //position: 'absolute',\n    bottom: '0',\n    width: '100%',\n    backgroundColor: theme.palette.background.default + '99',\n  }\n}))(Paper);\n\nconst Inside = withStyles({\n  root: {\n    display: 'flex',\n    flexFlow: 'row wrap',\n    alignItems: 'center',\n    justifyContent: 'space-around',\n    paddingBottom: '0.7em',\n    paddingTop: '0.3em',\n  }\n})(Toolbar)\n\n\nfunction ControlPanel(props: React.PropsWithChildren<Props>) {\n\n  return (\n    <Outside elevation={0} style={props.visible ? {} : {display: 'none'}}>\n      <Inside>\n        {props.children}\n      </Inside>\n    </Outside>\n  )\n}\n\nexport default ControlPanel","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { Nav } from '../../store/ui/types';\nimport { GalleryState } from '../../store/gallery/types';\nimport { deleteImage, uploadJson, redraw, setNav } from '../../store/actions';\nimport GridList from '@material-ui/core/GridList';\nimport GridListTile from '@material-ui/core/GridListTile';\nimport GridListTileBar from '@material-ui/core/GridListTileBar';\nimport Box from '@material-ui/core/Box';\nimport { Icon } from '../../components';\nimport IconButton from '@material-ui/core/IconButton';\nimport Popover from '@material-ui/core/Popover';\nimport { withStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Link from '@material-ui/core/Link';\nimport { jsonToUrl, JsonState } from '../../fractals/json';\n\nconst StyledGridList = withStyles({\n  root: {\n    padding: '3px',\n    paddingTop: '20px',\n  },\n})(GridList)\n\nconst StyledGridListTile = withStyles({\n  root: {\n    maxWidth: '200px',\n    maxHeight: '200px',\n    margin: '1mm',\n  },\n  tile: {\n    width: '200px',\n    height: '200px',\n  },\n})(GridListTile);\n\nconst StyledIconButton = withStyles({\n  root: {\n    color: 'rgba(255,255,255,0.5)',\n    '& :hover': {\n      color: 'rgba(255,255,255,1)',\n    }\n  }\n})(IconButton)\n\n\ninterface TileProps {\n  title: string,\n  url: string,\n  onView: () => void,\n}\n\nfunction ImageTile(props: TileProps) {\n  const title = props.title;\n  return (\n    <StyledGridListTile key={title} cols={1}>\n      <img \n        src={props.url}\n        alt={title} \n        style={{objectFit: 'cover'}}/>\n      <GridListTileBar\n        title={title}\n        actionIcon={\n          <>\n            <StyledIconButton onClick={props.onView}>\n              <Icon.ViewImage/>\n            </StyledIconButton>\n          </>\n        }\n      />\n    </StyledGridListTile>\n  )\n}\n\n\ninterface Props {\n  images: GalleryState\n  visible: boolean\n  deleteImage: (url: string | null) => void\n  loadJson: (data: JsonState) => void\n}\n\n\nenum Popup {\n  None,\n  Delete,\n  JSON,\n  Link,\n}\n\n\nclass Gallery extends React.Component<Props> {\n  state: {\n    current: {\n      url: string,\n      title: string,\n      data: JsonState,\n    } | null,\n    popup: Popup\n  }\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      current: null,\n      popup: Popup.None,\n    };\n  }\n\n  close = () => {\n    this.setState({current: null, popup: Popup.None});\n  }\n  \n  closePopup = () => {\n    this.setState({popup: Popup.None})\n  }\n\n  openDelete = () => {\n    this.setState({popup: Popup.Delete})\n  }\n\n  onDelete = () => {\n    if (this.state.current) {\n      this.props.deleteImage(this.state.current.url);\n      this.close();\n    }\n  }\n\n  onDownload = () => {\n    if (this.state.current) {\n      const a = document.createElement('a')\n      a.download = this.state.current.title + '.png';\n      a.href = this.state.current.url;\n      a.click();\n    }\n  }\n\n  onLoad = () => {\n    if (this.state.current) {\n      this.props.loadJson(this.state.current.data);\n      this.close();\n    }\n  }\n\n  linkUrl() {\n    if (this.state.current) {\n      return jsonToUrl(this.state.current.data);\n    }\n  }\n\n  viewer = (tile: {url: string, data: JsonState, title: string}) => () => {\n    this.setState({current: tile});\n  }\n\n  render() {\n\n    return (\n      <>\n      <StyledGridList \n        cellHeight={180} \n        style={this.props.visible ? {} : {display: 'none'}}\n      >\n        {this.props.images.map((tile, index) => {\n          return React.createElement(ImageTile, {\n            ...tile,\n            key: tile.url,\n            onView: this.viewer(tile),\n          });\n        })}\n      </StyledGridList>\n      <Popover\n        open={this.state.current !== null}\n        onClose={this.close}>\n        <Box style={{position: 'relative'}}>\n          <Toolbar>\n            <IconButton onClick={this.close} title=\"close\" edge=\"start\">\n              <Icon.Back/>\n            </IconButton>\n            <IconButton onClick={this.openDelete} title=\"delete image\">\n              <Icon.Delete/>\n            </IconButton>\n            <IconButton onClick={this.onLoad} title=\"load in fractal viewer\">\n              <Icon.Upload/>\n            </IconButton>\n            <IconButton onClick={this.onDownload} title=\"download image\">\n              <Icon.Save/>\n            </IconButton>\n            <Link href={this.linkUrl()} variant=\"subtitle1\" style={{marginLeft: '1em'}}>Direct Link</Link>\n          </Toolbar>\n          <img \n            alt=\"fractal\"\n            src={this.state.current?.url || ''}\n            style={{\n              objectFit: 'contain', \n              maxWidth: '100%', \n              maxHeight: '100%'\n            }}/>\n          \n        </Box>\n        <Popover\n          open={this.state.popup === Popup.Delete}\n          onClose={this.close}\n        >\n          <Box m={2}>\n            <Typography>Delete this image?</Typography>\n            <ButtonGroup color=\"primary\" variant=\"outlined\">\n              <Button onClick={this.onDelete}>Yes</Button>\n              <Button onClick={this.closePopup}>No</Button>\n            </ButtonGroup>\n          </Box>\n        </Popover>\n      </Popover>\n\n      </>\n    )\n  }\n}\n\n\nexport default connect(\n  (state: State) => ({\n    visible: state.ui.nav === Nav.Gallery,\n    images: state.gallery,\n  }),\n  (dispatch: Dispatch) => ({\n    deleteImage: (url: string | null) => {\n      if (url) dispatch(deleteImage(url));\n    },\n    loadJson: (data: JsonState) => {\n      dispatch(uploadJson(data));\n      dispatch(redraw());\n      dispatch(setNav(Nav.Explore))\n    }\n  })\n)(Gallery)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { FractalState, DrawState } from '../../store/fractal/types';\nimport { capture, finish, addToGallery, startWaiting } from '../../store/actions';\nimport { apply, multiply, invert } from '../../fractals/drawer/transform';\nimport { Nav } from '../../store/ui/types';\nimport Cropper from 'react-easy-crop';\nimport Box from '@material-ui/core/Box';\nimport { withStyles } from '@material-ui/core/styles';\nimport ControlPanel from '../controls/ControlPanel';\nimport IconButton from '@material-ui/core/IconButton';\nimport { linearScale, scaleFactor } from '../../fractals/drawer/view';\nimport createImageData from '../../fractals/drawer/drawer';\nimport { stateToJson, JsonState } from '../../fractals/json';\nimport { Icon, NumberInput } from '../../components';\nimport { captureSize } from '../../defaults';\nimport Fab from '@material-ui/core/Fab';\n\nconst CropContainer = withStyles({\n  root: {\n    position: 'relative',\n    display: 'flex',\n    height: '100%',\n    width: '100%',\n  }\n})(Box);\n\ninterface Crop {x: number, y: number}\ninterface Area extends Crop {width: number, height: number}\n\ninterface CropperProps {\n  crop: Crop\n  zoom: number\n}\n\ninterface Props {\n  visible: boolean\n  fractal: FractalState\n  addToGallery: (image: string, data: JsonState, title: string) => void\n  startCapture: () => void\n  finishCapture: () => void\n}\n\n\nclass Capture extends React.Component<Props> {\n  state: CropperProps & {\n    image: string | null,\n    w: number,\n    h: number,\n  }\n  cropPixels: Area\n  shouldRedraw: boolean\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      ...captureSize,\n      crop: {x: 0, y: 0},\n      zoom: 1,\n      image: null,\n    }\n    this.cropPixels = {x: 0, y: 0, width: captureSize.w, height: captureSize.h}\n    this.shouldRedraw = false;\n  }\n\n  setW = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    const w = +evt.target.value;\n    this.setState({w, aspect: w / this.state.h});\n  }\n\n  setH = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    const h = +evt.target.value;\n    this.setState({h, aspect: this.state.w / h});\n  }\n\n  swapWH = () => {\n    this.setState({\n      w: this.state.h,\n      h: this.state.w,\n    })\n  }\n\n  getImage = () => {\n    const cvs = document.getElementById('fractal-preview-canvas') as HTMLCanvasElement;\n    if (cvs) {\n      const image =  cvs.toDataURL();\n      this.setState({ image })\n    }\n  }\n\n  onCropChange = (crop: Crop) => this.setState({crop});\n  onCropComplete = (area: Area, areaPixels: Area) => {\n    this.cropPixels = areaPixels;\n  }\n  onZoomChange = (zoom: number) => this.setState({zoom});\n\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.visible) {\n      if (!prevProps.visible || (this.shouldRedraw && this.props.fractal.drawState === DrawState.None)) {\n        this.getImage();\n        this.shouldRedraw = false;\n      }\n      else if (this.props.fractal.drawState === DrawState.Draw || this.props.fractal.drawState === DrawState.Color) {\n        this.shouldRedraw = true;\n      }\n    }\n    if (this.props.fractal.drawState === DrawState.Capture) {\n      setTimeout(this.capture, 500);\n    }\n  }\n\n  determineView() {\n    let {cx, cy, w, h, ppu, pixelCount, t} = this.props.fractal.view;\n    const f = scaleFactor(w, h, pixelCount)\n\n    const cx_px = w * f / 2;\n    const cy_px = h * f / 2;\n\n    const {x, y, width, height} = this.cropPixels;\n\n    const ppuf = ppu * f;\n\n    let dx = (x + width/2 - cx_px) / ppuf;\n    let dy = (y + height/2 - cy_px) / ppuf;\n    \n    const inv = multiply([1,0,0,-1], t);\n    if (inv) {\n      [dx, dy] = apply(inv, [dx, dy]);\n    }\n\n    const newPPU = Math.max(\n      this.state.w / (width / ppuf),\n      this.state.h / (height / ppuf),\n    );\n\n    return {\n      cx: cx+dx,\n      cy: cy-dy,\n      ppu: newPPU,\n      w: this.state.w,\n      h: this.state.h,\n      t\n    }\n\n    /*\n    const rx = w / ppu / 2;\n    const ry = h / ppu / 2;\n    const xscale = linearScale([0, f*w], [cx - rx, cx + rx]);\n    const yscale = linearScale([0, f*h], [cy - ry, cy + ry]);\n\n    const {x, y, width, height} = this.cropPixels;\n    const xdom = [xscale(x), xscale(x+width)] as [number,number];\n    const ydom = [yscale(y), yscale(y+height)] as [number,number];\n\n    return {\n      cx: (xdom[0] + xdom[1]) / 2,\n      cy: (ydom[1] - ydom[1]) / 2,\n      xdom,\n      ydom,\n      w: this.state.w,\n      h: this.state.h,\n      t\n    }\n    */\n  }\n\n  getData(view: any) {\n    //const ppu = Math.round(view.w / (view.xdom[1] - view.xdom[0]))\n    return stateToJson({\n      ...this.props.fractal,\n      view,\n      /*\n      view: {\n        cx: view.cx,\n        cy: view.cy,\n        w: view.w,\n        h: view.h,\n        ppu: ppu,\n        t: view.t,\n      },\n      */\n    })\n  }\n\n  capture = () => {\n    const title = 'fract' + Math.floor((Date.now() - new Date(2020,0,25).getTime())/1000).toString(16);\n    const view = this.determineView();\n    const data = this.getData(view)\n    const image = createImageData({\n      ...this.props.fractal,\n      view,\n    })\n    if (image) {\n      const cvs = document.createElement('canvas')\n      const ctx = cvs.getContext('2d')!\n      cvs.width = image.width;\n      cvs.height = image.height;\n      ctx.putImageData(image, 0, 0);\n      cvs.toBlob(blob => {\n        if (blob) {\n          const url = URL.createObjectURL(blob);\n          this.props.addToGallery(url, data, title)\n        }\n      })\n    }\n    this.props.finishCapture();\n  }\n\n  onClick = () => {\n    this.props.startCapture();\n  }\n\n  render() {    \n    return (\n      <>\n      <CropContainer style={this.props.visible ? {} : {display: 'none'}} >\n        <Cropper\n          image={this.state.image || ''}\n          crop={this.state.crop}\n          zoom={this.state.zoom}\n          aspect={this.state.w / this.state.h}\n          onCropChange={this.onCropChange}\n          onCropComplete={this.onCropComplete}\n          onZoomChange={this.onZoomChange}\n        />\n      </CropContainer>\n      <ControlPanel visible={this.props.visible}>\n\n          <Box>\n            <NumberInput\n              value={this.state.w}\n              label=\"width\"\n              onChange={this.setW}\n              min={0}\n              step={10}\n              inputProps={{style: {maxWidth: '4em'}}}\n            />\n          </Box>\n\n          <IconButton onClick={this.swapWH} title=\"swap width and height\">\n            <Icon.SwapHoriz />\n          </IconButton>\n\n          <Box>\n            <NumberInput\n              value={this.state.h}\n              label=\"height\"\n              onChange={this.setH}\n              min={0}\n              step={10}\n              inputProps={{style: {maxWidth: '4em'}}}\n            />\n          </Box>\n\n          <Fab onClick={this.onClick} color=\"primary\" title=\"render selected area\">\n            <Icon.AddAPhoto/>\n          </Fab>\n\n      </ControlPanel>\n      </>\n    )\n  }\n}\n\n\nexport default connect(\n  (state: State) => ({\n    visible: state.ui.nav === Nav.Capture,\n    fractal: state.fractal,\n  }),\n  (dispatch: Dispatch) => ({\n    addToGallery: (image:string, data: JsonState, title: string) => dispatch(addToGallery(image, data, title)),\n    startCapture: () => {\n      dispatch(startWaiting());\n      dispatch(capture());\n    },\n    finishCapture: () => dispatch(finish()),\n  }),\n)(Capture);","import Capture from './Capture';\n\nexport default Capture;","import React from 'react';\nimport { connect } from 'react-redux';\nimport { zoomIn, zoomOut, redraw } from '../../store/actions';\nimport DownUpButtons, { DownUpButtonsProps } from '../../components/DownUpButtons';\nimport { Icon } from '../../components';\n\ninterface NewProps {\n  factor?: number\n  label?: string\n  fontSize?: 'small' | 'default' | 'large' | 'inherit'\n  zoomIn: (n: number) => void\n  zoomOut: (n: number) => void\n}\n\ninterface Props extends NewProps, Omit<DownUpButtonsProps, 'onUp' | 'onDown'> {}\n\nconst Zoom = ({factor=2, zoomIn, zoomOut, ...rest}: Props) => {\n  const zin = () => zoomIn(factor);\n  const zout = () => zoomOut(factor);\n  \n  return (\n    <DownUpButtons \n      {...rest}\n      onUp={zin} \n      onDown={zout} \n      downIcon={Icon.ZoomOut} \n      upIcon={Icon.ZoomIn}\n    />\n  )\n}\n\n\n\nexport default connect(\n  null,\n  (dispatch: any) => ({\n    zoomIn: (n: number) => {\n      dispatch(zoomIn(n));\n      dispatch(redraw());\n    },\n    zoomOut: (n: number) => {\n      dispatch(zoomOut(n));\n      dispatch(redraw());\n    }\n  })\n)(Zoom)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { rotateDeg, redraw } from '../../store/actions';\nimport DownUpButtons, { DownUpButtonsProps } from '../../components/DownUpButtons';\nimport { Icon } from '../../components';\n\ninterface NewProps {\n  step?: number\n  label?: string\n  value: [number,number,number,number]\n  fontSize?: 'small' | 'default' | 'large' | 'inherit'\n  setTransform: (t: [number,number,number,number]) => void\n}\n\ninterface Props extends NewProps, Omit<DownUpButtonsProps, 'onUp' | 'onDown'> {}\n\nconst Rotator = ({step=15, onRotate, ...rest}: Props) => {\n  const rotateCCW = () => onRotate(step);\n  const rotateCW = () => onRotate(-step);\n  \n  return (\n    <DownUpButtons \n      {...rest}\n      onUp={rotateCCW} \n      onDown={rotateCW} \n      downIcon={Icon.RotateRight} \n      upIcon={Icon.RotateLeft}\n    />\n  )\n}\n\n\n\nexport default connect(\n  null,\n  (dispatch: any) => ({\n    onRotate: (deg: number) => {\n      dispatch(rotateDeg(deg));\n      dispatch(redraw());\n    },\n  })\n)(Rotator)","import React from 'react';\nimport { connect } from 'react-redux';\nimport {\n  NumberIncrementer,\n  ComplexIncrementer,\n } from '../../components';\nimport {\n  ControlProps, ControlType, Params, \n  ControlNumber, ControlComplex, ControlCall,\n} from '../../fractals/algorithm/types'\nimport Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\nimport { Icon } from '../../components';\nimport { State, Dispatch } from '../../store/types';\nimport { fractal } from '../../fractals';\nimport { updateParams, redraw } from '../../store/actions';\n\n\ninterface Props {\n  controls: ControlProps[]\n  params: Params\n  onChange: (x: Params) => void\n}\n\nclass ParamControls extends React.Component<Props> {\n\n  paramUpdater = (k: string) => {\n    return (v: any) => {\n      //console.log(\"setting \" + k + ' => ' + v);\n      this.props.onChange({[k]: v});\n    }\n  }\n\n  renderNumberIncrementer(x: ControlNumber) {\n    const {param} = x;\n    return (\n      <NumberIncrementer\n        key={'number-'+param}\n        controlProps={x}\n        value={this.props.params[param]}\n        onChange={this.paramUpdater(param)}\n      />\n    )\n  }\n\n  renderComplexIncrementer(x: ControlComplex) {\n    const {param} = x;\n    return (\n      <ComplexIncrementer\n        key={'complex-'+param}\n        controlProps={x}\n        value={this.props.params[param]}\n        onChange={this.paramUpdater(param)}\n      />\n    )\n  }\n\n  renderCall(x: ControlCall) {\n    const {icon, label} = x;\n    if (label && icon === 'Random') {\n      return (\n        <Button\n          key={'action-'+label}\n          variant=\"outlined\"\n          color=\"inherit\"\n          size=\"small\"\n          onClick={() => this.props.onChange(x.onCall())}\n          startIcon={<Icon.Random/>}\n        >{x.label}</Button>\n      )\n    }\n    if (!label && icon === 'Random') {\n      return (\n        <IconButton key={'action-'+icon} onClick={() => this.props.onChange(x.onCall())}>\n          <Icon.Random/>\n        </IconButton>\n      )\n    }\n    if (label) {\n      return (\n        <Button\n          key={'action-'+label}\n          variant=\"outlined\"\n          size=\"small\"\n          onClick={() => this.props.onChange(x.onCall())}\n        >{x.label}</Button>\n      )\n    }\n  }\n\n  renderControl(x: ControlProps) {\n    if (x.type === ControlType.Number) {\n      return this.renderNumberIncrementer(x);\n    }\n    if (x.type === ControlType.Complex) {\n      return this.renderComplexIncrementer(x);\n    }\n    if (x.type === ControlType.Call) {\n      return this.renderCall(x);\n    }\n    return null;\n  }\n\n\n  render() {\n    return (\n      <>\n        {this.props.controls.map(x => this.renderControl(x))}\n      </>\n    )\n  }\n}\n\nexport default connect(\n  (state: State) => ({\n    controls: [...fractal(state.fractal.algorithm).controls],\n    params: {...state.fractal.algorithm.params},\n  }),\n  (dispatch: Dispatch) => ({\n    onChange: (x: Params) => {\n      dispatch(updateParams(x));\n      dispatch(redraw());\n    },\n  })\n)(ParamControls)","import { connect } from 'react-redux';\nimport { State, Dispatch } from '../../store/types';\nimport { ControlType, ControlNumber } from '../../fractals/algorithm/types';\nimport { redraw, updateParams } from '../../store/actions';\nimport { NumberIncrementer}  from '../../components';\n\nexport default connect(\n  (state: State) => ({\n    value: state.fractal.algorithm.params.iter,\n    controlProps: {\n      type: ControlType.Number,\n      param: 'iter',\n      label: 'iterations',\n      step: 2,\n      min: 0,\n    } as ControlNumber\n  }),\n  (dispatch: Dispatch) => ({\n    onChange: (iter: number) => {\n      dispatch(updateParams({iter}));\n      dispatch(redraw());\n    }\n  })\n)(NumberIncrementer)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State } from '../../store/types'; \nimport { Nav } from '../../store/ui/types';\nimport Zoom from './Zoom';\nimport Rotator from './Rotator';\nimport ParamControls from './ParamControls';\nimport Iterator from './Iterator';\nimport ControlPanel from './ControlPanel';\n\ntype Props = {\n  nav: Nav,\n}\n\nclass Controls extends React.Component<Props> {\n\n  render() {\n    return (\n      <>\n        <ControlPanel visible={this.props.nav === Nav.Params}>\n          <ParamControls/>\n        </ControlPanel>\n        <ControlPanel visible={this.props.nav === Nav.Explore}>\n          <Iterator />\n          <Zoom factor={2} />\n          <Rotator />\n        </ControlPanel>\n      </>\n    )\n  }\n}\n\nexport default connect(\n  (state: State) => ({nav: state.ui.nav}),\n)(Controls)","import Controls from './Controls';\n\nexport default Controls;","import Gallery from './Gallery';\n\nexport default Gallery;","import React from 'react'\nimport Canvas from './canvas';\nimport Capture from './capture';\nimport Controls from './controls';\nimport Box from '@material-ui/core/Box';\nimport Gallery from './gallery';\nimport { makeStyles } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles({\n  root: {\n    position: 'absolute',\n    overflow: 'clip',\n    display: 'flex',\n    flexDirection: 'column',\n    flexGrow: 1,\n    top: '50px',\n    bottom: '55px',\n    width: '100%',\n    //paddingTop: '50px'\n  }\n});\n\nexport default function Display() {\n  const classes = useStyles();\n\n  return (\n    <Box className={classes.root}>\n      <Canvas/>\n      <Capture/>\n      <Gallery/>\n      <Controls/>\n    </Box>\n  )\n};","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State as AppState, Dispatch } from '../../store/types';\nimport { setModal } from '../../store/actions';\nimport { Modal } from '../../store/ui/types';\nimport { TypographyWithMath } from '../../components';\nimport Button, { ButtonProps } from '@material-ui/core/Button';\nimport { withStyles } from '@material-ui/core/styles';\nimport { fractal } from '../../fractals';\n\n\nconst KatexButton = withStyles({\n  label: {textTransform: 'none'},\n})(Button)\n\nconst InfoButton = ({formula, ...rest}: {\n  formula: string | {math: string} | (string | {math: string})[]\n} & ButtonProps) => (\n  <KatexButton {...rest}>\n    <TypographyWithMath data={formula}/>\n  </KatexButton>\n)\n\nexport default connect(\n  (state: AppState) => {\n    const formula = fractal(state.fractal.algorithm).label;\n    return {\n      disabled: state.ui.modal === Modal.Info,\n      formula,\n    }\n  },\n  (dispatch: Dispatch) => ({\n    onClick: () => dispatch(setModal(Modal.Info))\n  })\n)(InfoButton)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Dispatch } from '../../store/types';\nimport { recenter, redraw } from '../../store/actions';\nimport IconButton, { IconButtonProps } from '@material-ui/core/IconButton';\nimport { Icon } from '../../components';\n\nconst RecenterButton = (props: IconButtonProps) => (\n  <IconButton {...props} title=\"recenter image at origin\">\n    <Icon.Recenter/>\n  </IconButton>\n)\n\nexport default connect(\n  null,\n  (dispatch: Dispatch) => ({\n    onClick: () => {\n      dispatch(recenter());\n      dispatch(redraw());\n    }\n  }),\n)(RecenterButton)","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State, Dispatch } from '../store/types';\nimport { setModal } from '../store/actions';\nimport { Modal, Nav } from '../store/ui/types';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport { Icon } from '../components'\nimport InfoButton from './controls/InfoButton';\nimport RecenterButton from './controls/Recenter';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles({\n  toolbar: {\n    justifyContent: 'flex-start',\n  },\n  gallery: {\n    flexGrow: 1,\n    textAlign: 'center',\n  },\n  formula: {},\n  recenter: {},\n  Params: {\n    '& $gallery': {display: 'none'},\n  },\n  Explore: {\n    '& $gallery': {display: 'none'},\n  },\n  Capture: {\n    '& $gallery': {display: 'none'},\n    '& $recenter': {display: 'none'}\n  },\n  Gallery: {\n    '& $formula': {display: 'none'},\n    '& $recenter': {display: 'none'},\n  },\n})\n\n\nfunction TopBar(props: {\n  nav: Nav,\n  disableMenu: boolean,\n  openMenu: () => void,\n}) {\n  const classes = useStyles();\n  const rootClass = \n    props.nav === Nav.Params ? 'Params' : \n    props.nav === Nav.Explore ? 'Explore' :\n    props.nav === Nav.Capture ? 'Capture' :\n    'Gallery';\n  return (\n    <AppBar position=\"static\" elevation={0}>\n      <Toolbar className={classes.toolbar + ' ' + classes[rootClass]}>\n        <IconButton onClick={props.openMenu} edge=\"start\">\n          <Icon.Menu/>\n        </IconButton>\n        <InfoButton \n          className={classes.formula} \n          title=\"algorithm information\"\n          style={{marginLeft: 'auto', marginRight: 'auto'}}\n        />\n        <Typography className={classes.gallery}>Saved Fractals</Typography>\n        <RecenterButton className={classes.recenter}/>\n      </Toolbar>\n    </AppBar>\n  );\n}\n\nexport default connect(\n  (state: State) => ({\n    nav: state.ui.nav,\n    disableMenu: state.ui.modal === Modal.Menu,\n  }),\n  (dispatch: Dispatch) => ({\n    openMenu: () => dispatch(setModal(Modal.Menu)),\n  }),\n)(TopBar);","import React from 'react';\nimport { connect } from 'react-redux';\nimport Katex from '../components/Katex';\nimport { State as AppState, Dispatch } from '../store/types';\nimport { setModal } from '../store/actions';\nimport { Modal } from '../store/ui/types';\nimport { AlgorithmState } from '../store/fractal/algorithm/types';\nimport { TypographyWithMath } from '../components';\nimport Box from '@material-ui/core/Box';\nimport Paper from '@material-ui/core/Paper';\nimport Popover from '@material-ui/core/Popover';\nimport Typography from '@material-ui/core/Typography';\nimport { fractal } from '../fractals';\nimport { withStyles, createStyles, WithStyles, Theme } from '@material-ui/core/styles';\n\n\nconst styles = createStyles((theme: Theme) => ({\n  text: {\n    fontSize: '1em',\n  }\n}))\n\n\nfunction rounder(p: number) {\n  const d = Math.pow(10, p);\n  return (n: number) => Math.round(n * d) / d;\n}\n\nfunction science(n: number, p: number=4) {\n  const a = n.toPrecision(4);\n  const b = a.split('e')\n  if (b.length === 1) {\n    return a;\n  } else {\n    return b[0] + '\\\\times 10^{' + b[1] + '}'\n  }\n}\n\ninterface Props {\n  visible: boolean\n  anchorEl?: HTMLElement\n  onClose: () => void\n  cx: number\n  cy: number\n  rx: number\n  ry: number\n  algorithm: AlgorithmState<object>\n}\n\ninterface PP extends Props, WithStyles<typeof styles> {}\n\n\nconst FractalInfo = (props: PP) => {\n\n  const {algorithm} = props;\n  const fractalinfo = fractal(algorithm).describe;\n\n  const round = rounder(3-Math.floor(Math.log10(props.rx)))\n\n  const cx = round(props.cx)\n  const cy = round(props.cy)\n\n  const rx = science(Math.abs(props.rx))\n  const ry = science(Math.abs(props.ry))\n\n  const centerx = 'x_c = ' + cx\n  const centery = 'y_c = ' + cy\n  const domainx = '|x - x_c| \\\\leq ' + rx \n  const domainy = '|y - y_c| \\\\leq ' + ry \n\n  const classes = props.classes as {text: string};\n\n  return (\n    <Popover\n      open={props.visible}\n      onClose={props.onClose}\n      marginThreshold={10}\n    >\n      <Paper >\n        <Box p={2} onClick={props.onClose}>\n          <TypographyWithMath data={fractalinfo} className={classes.text}/>\n          <Typography style={{marginTop: '1em'}} className={classes.text}>\n            The currently displayed portion of this fractal is centered\n            at <Katex math=\"(x_c, y_c)\"/>, where\n          </Typography>\n          <Katex math={centerx + '\\\\text{ and }' + centery} displayMode={true} className={classes.text}/>\n          <Typography className={classes.text}>\n            and plotted over <Katex math=\"(x, y)\"/> such that \n          </Typography>\n          <Katex math={domainx + '\\\\text{ and }' + domainy} displayMode={true} className={classes.text}/>\n        </Box>\n      </Paper>\n    </Popover>\n  )\n}\n\nexport default connect(\n  (state: AppState) => {\n    const {cx, cy, ppu, w, h} = state.fractal.view;\n    const rx = w/ppu/2, ry = h/ppu/2;\n    return {\n      visible: state.ui.modal === Modal.Info,\n      cx: cx,\n      cy: cy,\n      rx: rx,\n      ry: ry,\n      algorithm: state.fractal.algorithm,\n    }\n  },\n  (dispatch: Dispatch) => ({\n    onClose: () => dispatch(setModal(Modal.None))\n  })\n)(withStyles(styles)(FractalInfo))","import React from 'react';\nimport { connect } from 'react-redux';\nimport { State } from '../store/types';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Modal from '@material-ui/core/Modal';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  typography: {\n    color: 'white',\n  },\n  progress: {\n    outline: 'none',\n  }\n})\n\ninterface Props {\n  open: boolean\n}\n\nfunction Waiting({open}: Props) {\n  const classes = useStyles();\n  return (\n    <Modal open={open} className={classes.root}>\n      <>\n      <CircularProgress className={classes.progress}/>\n      <Typography className={classes.typography}>Rendering Image</Typography>\n      </>\n    </Modal>\n  )\n}\n\nexport default connect(\n  (state: State) => ({open: state.ui.waiting}),\n)(Waiting);","import React from 'react';\nimport BottomBar from './Bottombar';\nimport Settings from './settings';\nimport Display from './Display';\nimport TopBar from './TopBar';\nimport Info from './Info';\nimport Waiting from './Waiting';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\n\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    height: '100%',\n    flexDirection: 'column',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    position: 'absolute',\n    overflow: 'hidden',\n    justifyContent: 'space-between',\n  }\n}))\n\n\nexport default function App() {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <Waiting/>\n      <Display/>\n      <TopBar />\n      <Settings />\n      <Info />\n      <BottomBar />\n    </div>\n  )\n}","import React from 'react';\nimport { Provider } from 'react-redux';\nimport Theme from './Theme';\nimport { Store } from 'redux';\nimport App from './App';\nimport { State as AppState, Action as AppAction } from '../store/types';\n\ntype Props = {\n  store: Store<Partial<AppState>, AppAction>\n}\n\nexport default class Root extends React.Component<Props> {\n  render() {\n    const { store } = this.props;\n    return (\n      <Provider store={store}>\n        <Theme>\n          <App/>\n        </Theme>\n      </Provider>\n    )\n  }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Root from './containers/Root';\nimport store from './store';\nimport { uploadUrl } from './store/fractal/actions';\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\nrequire('./console');\n\n\nstore.dispatch(uploadUrl(window.location.search));\n\nReactDOM.render(<Root store={store} />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n\nserviceWorker.register();","import { FractalCommands, Params } from './types';\nimport { JsonState } from '../../fractals/json';\nimport { ColorState } from '../../store/fractal/color/types';\nimport { ViewState } from '../../store/fractal/view/types';\nimport { COLORSCHEMES } from '../../fractals';\nimport { multiply } from '../../fractals/drawer/transform';\n\nabstract class Base implements FractalCommands {\n  abstract updateParams(p: Params): void\n  abstract getParams(): Params\n  abstract setMethod(methodName: string): void\n  abstract getMethod(): string\n  abstract loadJson(data: JsonState): void\n  abstract recenter(): void\n  abstract zoom(factor: number): void\n  abstract setCenter(x: number, y: number): void\n  abstract getView(): ViewState\n  abstract updateColor(color: Partial<ColorState>): void\n  abstract updateView(view: Partial<ViewState>): void\n\n  transform(t: [number,number,number,number]) {\n    const t0 = this.getView().t;\n    this.updateView({t: multiply(t0, t)})\n  }\n\n  getParam(k: string) {\n    return this.getParams()[k];\n  }\n\n  setColorScheme(schemeName: string, opts?: {skew?: number, reverse?: boolean}) {\n    const scheme = COLORSCHEMES[schemeName];\n    if (scheme) {\n      this.updateColor({\n        scheme,\n        schemeName,\n        ...opts,\n      });\n    } else {\n      console.error('unknown schemeName:', schemeName)\n    }\n  }\n\n  fixPolarParams(p: Params) {\n    return Object.fromEntries(Object.entries(p).map(([k, v]: [string, any]) => {\n      if (v.angle && v.radius) {\n        const x = v.radius * Math.cos(v.angle)\n        const y = v.radius * Math.sin(v.angle)\n        return [k, [x, y]]\n      } else {\n        return [k, v];\n      }\n    }))\n  }\n\n}\n\nexport default Base","\nexport function* rangeGen(start: number, stop: number): Generator<number> {\n  const d = Math.abs(stop - start)\n  if (start < stop) {\n    for (let i = 0; i <= d; i++) {\n      yield start + i\n    }\n  } else {\n    for (let i = 0; i <= d; i++) {\n      yield stop - i\n    }\n  }\n}\n\nexport function promiseGenerator<T>(gen: Generator<T>, f: (x: T) => void, ms: number) {\n  const x = gen.next();\n  if (x.done) {\n    return new Promise(resolve => { resolve() })\n  } else {\n    f(x.value)\n    return new Promise(resolve => {\n      setTimeout(() => resolve(promiseGenerator(gen, f, ms)), ms)\n    })\n  }\n}\n\nexport function promiseRangeGen(start: number, stop: number) {\n  return (f: (n: number) => void, ms: number=0) => {\n    return promiseGenerator(rangeGen(start, stop), f, ms);\n  }\n}\n","import reduxStore from '../../store';\nimport * as reduxAction from '../../store/actions';\nimport { Action } from '../../store/types';\nimport { FractalState } from '../../store/fractal/types';\nimport { ColorState } from '../../store/fractal/color/types';\nimport { ViewState } from '../../store/fractal/view/types';\nimport { JsonState } from '../../fractals/json';\nimport { ALLFRACTALS } from '../../fractals'; \nimport { FractalCommands, Params } from './types'\nimport Abstract from './abstract';\nimport { promiseRangeGen } from './util';\n\nclass Connected extends Abstract implements FractalCommands {\n  protected store: typeof reduxStore\n  autodraw: boolean\n\n  constructor(store: typeof reduxStore=reduxStore, autodraw: boolean=false) {\n    super();\n    this.store = store;\n    this.autodraw = autodraw\n  }\n\n  static new(autodraw: boolean=false) {\n    return new Connected(reduxStore, autodraw);\n  }\n\n  loadJson(data: JsonState) {\n    this.dispatch(reduxAction.uploadJson(data))\n    return this;\n  }\n\n  animate([start, stop]: [number, number], {delay=0}: {\n    delay?: number\n  }={}) {\n    return (f: (n: number) => {\n      params?: {[k: string]: any},\n      view?: Partial<ViewState>,\n      color?: Partial<ColorState>,\n    }) => {\n      const autodraw = this.autodraw;\n      this.autodraw = false;\n      return promiseRangeGen(start, stop)((i: number) => {\n        const {params, view, color} = f(i);\n        if (params) this.updateParams(params);\n        if (view) this.updateView(view);\n        if (color) this.updateColor(color);\n        this.redraw();\n      }, delay).then(() => {\n        this.autodraw = autodraw;\n        return;\n      })\n    };\n  }\n\n  dispatch(action: Action) {\n    this.store.dispatch(action)\n    if (this.autodraw) {\n      this.redraw();\n    }\n  }\n\n  redraw() {\n    this.store.dispatch(reduxAction.redraw())\n  }\n\n  getFractal(): FractalState {\n    return this.store.getState().fractal;\n  }\n\n  getAlgorithm() {\n    return this.getFractal().algorithm;\n  }\n\n  getColor() {\n    return this.getFractal().color;\n  }\n\n  getView() {\n    return this.getFractal().view;\n  }\n\n  // Algorithm\n\n  getMethod() {\n    return this.getFractal().algorithm.methodName;\n  }\n\n  getParams() {\n    return this.getFractal().algorithm.params;\n  }\n\n  getParam(k: string) {\n    return this.getParams()[k]\n  }\n\n  setMethod(methodName: string) {\n    const method = ALLFRACTALS[methodName];\n    if (method) {\n      this.dispatch(reduxAction.setAlgorithm(methodName, method));\n    } else {\n      console.error('unknown methodName:', methodName)\n    }\n  }\n\n  updateParams(p: Params) {\n    this.dispatch(reduxAction.updateParams(this.fixPolarParams(p)));\n  }\n\n  // Color\n\n  updateColor(color: Partial<ColorState>) {\n    this.dispatch(reduxAction.updateColor(color));\n  }\n\n  // View\n\n  updateView(view: Partial<ViewState>) {\n    this.dispatch(reduxAction.updateView(view));\n  }\n\n  recenter() {\n    this.dispatch(reduxAction.recenter());\n  }\n\n  setCenter(x: number, y: number) {\n    this.dispatch(reduxAction.setCenter(x, y));\n  }\n\n  zoom(factor: number) {\n    this.dispatch(reduxAction.zoomIn(factor));\n  }\n\n}\n\nconst THE_CONNECTED = Connected.new(true);\n\nexport default Connected\n\nexport { THE_CONNECTED }","export function download(url: string, filename: string) {\n  console.log('downloading:', filename)\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = filename;\n  document.body.append(a);\n  a.click();\n  setTimeout(() => {\n    a.remove();\n    URL.revokeObjectURL(url);\n  }, 100);\n}","import JSZip from 'jszip';\nimport { download } from './download';\n\nclass Zipper {\n  zip: JSZip\n\n  constructor() {\n    this.zip = new JSZip();\n  }\n\n  file(name: string, data: Blob | Promise<Blob>) {\n    this.zip.file(name, data);\n  }\n\n  download(filename: string) {\n    this.zip.generateAsync({type: 'blob'}).then(blob => {\n      const url = URL.createObjectURL(blob);\n      download(url, filename);\n    })\n  }\n}\n\nexport default Zipper;","import reduxStore from '../../store';\nimport { addToGallery } from '../../store/actions';\nimport { FractalState } from '../../store/fractal/types';\nimport { recenterPPU } from '../../store/fractal/view/reducer';\nimport { JsonState, jsonToState, stateToJson, jsonToUrl } from '../../fractals/json';\nimport { ColorState } from '../../store/fractal/color/types';\nimport { ViewState } from '../../store/fractal/view/types';\nimport { ALLFRACTALS } from '../../fractals'; \nimport { FractalCommands, Params } from './types'\nimport { drawImage } from '../../fractals'\nimport Abstract from './abstract';\nimport { rangeGen } from './util';\nimport { download } from './download';\nimport Zipper from './zip';\n\ninterface Fractal extends Omit<FractalState,'drawState'|'view'> {\n  view: {\n    cx: number\n    cy: number\n    w: number\n    h: number\n    ppu: number\n    t: [number,number,number,number]\n  }\n}\n\nclass Disconnected extends Abstract implements FractalCommands {\n  fractal: Fractal\n  zipper: Zipper\n\n  constructor(fractalState: Fractal) {\n    super();\n    this.fractal = fractalState;\n    this.zipper = new Zipper();\n  }\n\n  animate([start, stop]: [number, number], opts?: any) {\n    const zip = this.zipper;\n    return (f: (n: number) => {\n      filename?: string,\n      params?: {[k: string]: any},\n      view?: Partial<ViewState>,\n      color?: Partial<ColorState>,\n    }) => new Promise(resolve => {\n      for (const i of rangeGen(start, stop)) {\n        const {filename='img' + String(i).padStart(4, '0') + '.png', params, view, color} = f(i);\n        if (params) this.updateParams(params);\n        if (view) this.updateView(view);\n        if (color) this.updateColor(color);\n        zip.file(filename, this.toBlob());\n        console.log('frame', i)\n      }\n      resolve(this);\n    })\n  }\n\n  private static parseState(fractal: Fractal) {\n    return {\n      algorithm: {...fractal.algorithm},\n      color: {...fractal.color},\n      view: {...fractal.view},\n    }\n  }\n\n  toBlob(): Promise<Blob> {\n    return new Promise((resolve, reject) => {\n      const image = this.imageData();\n      if (image) {\n        const cvs = document.createElement('canvas')!\n        const ctx = cvs.getContext('2d')!\n        cvs.width = image.width;\n        cvs.height = image.height;\n        ctx.putImageData(image,0,0);\n        cvs.toBlob(blob => {\n          if (blob) {\n            resolve(blob);\n          } else {\n            reject();\n          }\n        });\n      } else {\n        reject();\n      }\n    });\n  }\n\n  toURL(): Promise<string> {\n    return this.toBlob().then(blob => URL.createObjectURL(blob));\n  }\n\n  downloadImage(name: string='fractal.png') {\n    this.toURL().then(url => {\n      download(url, name);\n    })\n  }\n\n  download(name: string='fractal.zip') {\n    this.zipper.download(name);\n  }\n\n  clear() {\n    this.zipper = new Zipper();\n  }\n\n  static fromState(fractal: Fractal | FractalState) {\n    return new Disconnected(Disconnected.parseState(fractal));\n  }\n\n  static new() {\n    return Disconnected.fromState(reduxStore.getState().fractal);\n  }\n\n  json() {\n    return stateToJson(this.fractal)\n  }\n\n  url() {\n    return jsonToUrl(this.json())\n  }\n\n  loadJson(data: JsonState) {\n    const fractal = jsonToState(data);\n    if (fractal) {\n      this.fractal.algorithm = {...this.fractal.algorithm, ...fractal.algorithm}\n      this.fractal.color = {...this.fractal.color, ...fractal.color}\n      this.fractal.view = {...this.fractal.view, ...fractal.view}\n    }\n    return this;\n  }\n\n  saveToGallery() {\n    this.toURL().then(url => {\n      const title = 'fract' + Math.floor((Date.now() - new Date(2020,0,25).getTime())).toString(16)\n      reduxStore.dispatch(addToGallery(url, stateToJson(this.getFractal()), title));\n    })\n  }\n\n  imageData(): ImageData | undefined {\n    return drawImage(this.getFractal())\n  }\n\n  getFractal(): Omit<FractalState,'drawState'> {\n    return ({\n      algorithm: this.getAlgorithm(),\n      color: this.getColor(),\n      view: this.getView(),\n    });\n  }\n\n  getAlgorithm() {\n    return this.fractal.algorithm;\n  }\n\n  getColor() {\n    return this.fractal.color;\n  }\n\n  getView() {\n    return {\n      ...this.fractal.view,\n      pixelCount: this.fractal.view.w * this.fractal.view.h,\n    }\n  }\n\n  getMethod() {\n    return this.fractal.algorithm.methodName;\n  }\n\n  getParams() {\n    return this.fractal.algorithm.params;\n  }\n\n  getParam(k: string) {\n    return this.getParams()[k]\n  }\n\n  setMethod(methodName: string) {\n    const method = ALLFRACTALS[methodName];\n    if (method) {\n      this.fractal.algorithm.method = method;\n      this.fractal.algorithm.methodName = methodName;\n    } else {\n      console.error('unknown methodName:', methodName)\n    }\n  }\n\n  updateParams(p: Params) {\n    this.fractal.algorithm.params = {...this.fractal.algorithm.params, ...this.fixPolarParams(p)}\n  }\n\n\n  // Color\n\n  updateColor(color: Partial<ColorState>) {\n    this.fractal.color = {...this.fractal.color, ...color};\n  }\n\n\n\n  // View\n\n  updateView(view: Partial<ViewState>) {\n    this.fractal.view = {...this.fractal.view, ...view};\n  }\n\n  recenter() {\n    this.fractal.view.cx = 0;\n    this.fractal.view.cy = 0;\n    this.fractal.view.ppu = recenterPPU(this.fractal.view);\n  }\n\n  setCenter(x: number, y: number) {\n    this.fractal.view.cx = x;\n    this.fractal.view.cy = y;\n  }\n\n  zoom(factor: number) {\n    this.fractal.view.ppu *= factor;\n  }\n}\n\nexport default Disconnected","import {\n  scaleLinear,\n  scalePow,\n  scaleLog,\n} from 'd3';\n\n\nexport type Scale<T> = (i: number) => T\n\nfunction scaleZoom(\n  domain: [number, number], \n  range: [number, number], \n  exponent: number=1,\n): Scale<number> {\n  const f = range[1] / range[0]\n  const r0 = range[0]\n  const s = scalePow().domain(domain).range([0,1]).exponent(exponent)\n  return (n: number) => r0 * Math.pow(f, s(n));\n}\n\ninterface CommonSpec {\n  scale?: 'linear' | 'log' | 'pow' | 'zoom'\n  domain: [number, number]\n  range: [number, number]\n  exponent?: number\n  base?: number\n}\n\nexport interface ScaleSpec extends CommonSpec {}\n\nfunction baseScale(spec: ScaleSpec): Scale<number> {\n  if (spec.scale === 'linear') {\n    return scaleLinear().domain(spec.domain).range(spec.range);\n  }\n  if (spec.scale === 'log') {\n    return scaleLog().domain(spec.domain).range(spec.range).base(spec.base || 10);\n  }\n  if (spec.scale === 'pow') {\n    return scalePow().domain(spec.domain).range(spec.range).exponent(spec.exponent || 2);\n  }\n  if (spec.scale === 'zoom') {\n    return scaleZoom(spec.domain, spec.range, spec.exponent || 1);\n  }\n  return scaleLinear().domain(spec.domain).range(spec.range);\n}\n\nexport interface MappedSpec<T> extends CommonSpec {\n  map: (n: number) => T\n}\n\nfunction mappedScale<T>(spec: MappedSpec<T>): Scale<T> {\n  const a = baseScale(spec);\n  return (n: number) => spec.map(a(n));\n}\n\nfunction makeScale<T>(spec: ScaleSpec): Scale<number>;\nfunction makeScale<T>(spec: MappedSpec<T>): Scale<T>;\nfunction makeScale<T>(spec: ScaleSpec | MappedSpec<T>) {\n  if ('map' in spec) return mappedScale(spec);\n  else return baseScale(spec);\n}\n\nexport interface PolarSpec {\n  angle: number | ScaleSpec | MappedSpec<number>\n  radius: number | ScaleSpec | MappedSpec<number>\n}\n\nfunction polarScale(spec: PolarSpec): Scale<[number,number]> {\n  const {angle, radius} = spec;\n  const ang: (n: number) => number = typeof angle === 'number' ? (n: number) => angle : makeScale(angle);\n  const rad: (n: number) => number = typeof radius === 'number' ? (n: number) => radius : makeScale(radius);\n  return (n: number) => {\n    const a = ang(n);\n    const r = rad(n);\n    return [r * Math.cos(a), r * Math.sin(a)];\n  }\n}\n\nexport type Spec<T> = ScaleSpec | MappedSpec<T> | PolarSpec;\n\n\nfunction createScale<T>(spec: ScaleSpec): Scale<number>;\nfunction createScale<T>(spec: PolarSpec): Scale<[number,number]>;\nfunction createScale<T>(spec: MappedSpec<T>): Scale<T>;\nfunction createScale<T>(spec: Spec<T>) {\n  if ('range' in spec) {\n    return makeScale(spec);\n  } else {\n    return polarScale(spec);\n  }\n}\n\nexport default createScale","import Connected, { THE_CONNECTED } from './connected'\nimport Disconnected from './disconnected';\nimport createScale, { ScaleSpec, MappedSpec, Scale, PolarSpec } from './scales';\nimport { JsonState } from '../../fractals/json';\n\n\ntype ParamType = number | [number,number] | [number,number,number,number]\n\ninterface NoDomScale {\n  scale?: 'linear' | 'log' | 'pow' | 'zoom'\n  range: [number, number]\n  exponent?: number\n  base?: number\n}\n\ninterface NoDomMapped<T> extends NoDomScale {\n  map: (n: number) => T\n}\n\ntype RangeOnly = [number, number]\n\ninterface MyPolar {\n  angle?: number | RangeOnly | NoDomScale | NoDomMapped<number>\n  radius?: number | RangeOnly | NoDomScale | NoDomMapped<number>\n}\n\ntype MySpec<T> = RangeOnly | NoDomScale | NoDomMapped<T> | MyPolar\n\nfunction isRangeOnly<T>(spec: MySpec<T>): spec is RangeOnly {\n  return Array.isArray(spec);\n}\n\nfunction fixRangeOnly(spec: RangeOnly, domain: [number, number]): ScaleSpec {\n  return {scale: 'linear', domain, range: spec};\n}\n\nfunction addDomain(spec: NoDomScale, domain: [number, number]): ScaleSpec;\nfunction addDomain<T>(spec: NoDomMapped<T>, domain: [number, number]): MappedSpec<T>;\nfunction addDomain<T>(spec: NoDomScale | NoDomMapped<T>, domain: [number, number]) {\n  return {domain, ...spec};\n}\n\nfunction fixPolar(spec: MyPolar, domain: [number, number], init: [number, number]): PolarSpec {\n  const [x, y] = init;\n  return {\n    angle:\n      spec.angle === undefined ? Math.atan2(y, x) : \n      typeof spec.angle === 'number' ? spec.angle :\n      isRangeOnly(spec.angle) ? fixRangeOnly(spec.angle, domain) :\n      addDomain(spec.angle, domain),\n    radius:\n      spec.radius === undefined ? Math.sqrt(x*x + y*y) : \n      typeof spec.radius === 'number' ? spec.radius : \n      isRangeOnly(spec.radius) ? fixRangeOnly(spec.radius, domain) :\n      addDomain(spec.radius, domain),\n  };\n}\n\nfunction isPolar<T>(spec: MySpec<T>): spec is MyPolar {\n  return !isRangeOnly(spec) && !('range' in spec);\n}\n\ntype Target = Connected | Disconnected;\n\nclass Animator {\n  domain: [number, number]\n  params: {[k: string]: MySpec<ParamType>}\n  view: {[k: string]: MySpec<ParamType>}\n  json?: JsonState\n  init: {\n    method?: string\n    params?: {[k: string]: any}\n    view?: {[k: string]: any}\n    color?: {[k: string]: any}\n  }\n\n  constructor(frames: number | [number, number]) {\n    this.domain = typeof frames === 'number' ? [1, frames] : frames;\n    this.params = {}\n    this.view = {}\n    this.init = {}\n  }\n\n  loadJson(data: JsonState) {\n    this.json = data;\n  }\n\n  update(init: {\n    method?: string\n    params?: {[k: string]: any}\n    view?: {[k: string]: any}\n    color?: {[k: string]: any}\n  }) {\n    this.init = init;\n    return this;\n  }\n\n  initialize(target: Target) {\n    if (this.json) target.loadJson(this.json);\n    if (this.init.method) target.setMethod(this.init.method);\n    if (this.init.params) target.updateParams(this.init.params);\n    if (this.init.view) target.updateView(this.init.view);\n    if (this.init.color) target.updateColor(this.init.color);\n  }\n\n  makeScales(target: Target) {\n    const currentParams = target.getParams();\n    const currentView = target.getView() as {[k: string]: any};\n    const params: {[k: string]: Scale<ParamType>} = {}\n    const view: {[k: string]: Scale<ParamType>} = {}\n    \n    for (const [k, spec] of Object.entries(this.params)) {\n      if (isPolar(spec)) {\n        const init = currentParams[k];\n        if (Array.isArray(init) && typeof init[0] === 'number' && typeof init[1] == 'number') {\n          params[k] = createScale(fixPolar(spec, this.domain, init as [number,number]))\n        }\n      }\n      else if (isRangeOnly(spec)) {\n        params[k] = createScale(fixRangeOnly(spec, this.domain))\n      }\n      else {\n        params[k] = createScale(addDomain(spec, this.domain));\n      }\n    }\n    for (const [k, spec] of Object.entries(this.view)) {\n      if (isPolar(spec)) {\n        const init = currentView[k];\n        if (Array.isArray(init) && typeof init[0] === 'number' && typeof init[1] == 'number') {\n          view[k] = createScale(fixPolar(spec, this.domain, init as [number,number]))\n        }\n      }\n      else if (isRangeOnly(spec)) {\n        view[k] = createScale(fixRangeOnly(spec, this.domain))\n      }\n      else {\n        view[k] = createScale(addDomain(spec, this.domain));\n      }\n    }\n    return {params, view};\n  }\n\n  f = (target: Target) => {\n    const scales = this.makeScales(target);\n    return (i: number) => {\n      const params: {[k: string]: ParamType} = {};\n      const view: {[k: string]: ParamType} = {};\n      for (const [k, scale] of Object.entries(scales.params)) {\n        params[k] = scale(i);\n      }\n      for (const [k, scale] of Object.entries(scales.view)) {\n        view[k] = scale(i)\n      }\n      return {params, view};\n    }\n  }\n  \n  animate({params, view}: {\n    params?: {[k: string]: MySpec<ParamType>},\n    view?: {[k: string]: MySpec<ParamType>},\n  }) {\n    this.params = Object.assign(this.params, params)\n    this.view = Object.assign(this.view, view)\n    return this;\n  }\n\n  run = (target: Target | 'screen' | 'download', opts: {[k: string]: any}={}) => {\n    const {frames, ...rest} = opts\n    const domain = frames ? (\n      typeof frames === 'number' ? [frames, frames] :\n      frames.length === 1 ? [frames[0], frames[0]] :\n      frames\n    ) : this.domain;\n    if (target === 'screen') {\n      this.initialize(THE_CONNECTED);\n      THE_CONNECTED.autodraw = true;\n      return THE_CONNECTED.animate(domain, rest)(this.f(THE_CONNECTED));\n    }\n    else if (target === 'download') {\n      const t = Disconnected.new();\n      this.initialize(t);\n      return t.animate(domain, rest)(this.f(t)).then(() => t.download());\n    }\n    else {\n      this.initialize(target);\n      return target.animate(domain, rest)(this.f(target))\n    }\n  }\n\n}\n\nexport default Animator","import {\n  Connected,\n  THE_CONNECTED,\n  Disconnected,\n  Animator,\n} from './drawer';\nimport { OPTS } from '../fractals/drawer/drawer';\n\nconst fractalex = {\n  controller: (autodraw=true) => {\n    THE_CONNECTED.autodraw = autodraw;\n    return THE_CONNECTED;\n  },\n\n  disconnected: () => Disconnected.new(),\n\n  animator: (frames: number | [number, number]) => new Animator(frames),\n  \n  get logDrawTime() {\n    return OPTS.logDrawTime;\n  },\n\n  set logDrawTime(x: boolean) {\n    OPTS.logDrawTime = x;\n  },\n\n  animateZoom({frames=60, delay=0, rotate=0, target='screen'}: {\n    frames?: number, \n    delay?: number,\n    rotate?: number | [number,number], \n    target?: 'screen' | 'download' | Connected | Disconnected\n  }={}) {\n    const anim = new Animator(frames);\n    const {w, h, ppu} = THE_CONNECTED.getView();\n    const {iter} = THE_CONNECTED.getParams();\n    const startPPU = Math.round(Math.min(w, h)/5);\n    anim.view.ppu = {\n      scale: 'zoom',\n      range: [startPPU, ppu],\n    }\n    anim.params.iter = [20, iter]\n    if (rotate) {\n      anim.view.t = {\n        range: typeof rotate === 'number' ? [-rotate, 0] : rotate,\n        map: (deg: number) => {\n          const {a, b, c, d} = new DOMMatrix([1,0,0,-1,0,0]).rotateSelf(deg);\n          return [a, b, c, d] as [number,number,number,number];\n        }\n      }\n    }\n    return anim.run(target, {delay});\n  },\n\n  magic: ({\n    frames=30,\n    delay=0,\n    target='screen',\n  }: {\n    frames?: number | [number, number]\n    delay?: number\n    target?: 'screen' | 'download' | Connected | Disconnected\n  }={}) => {\n    const anim = new Animator(frames);\n    const {c, p} = THE_CONNECTED.getParams();\n    const randomInt = (n: number) => Math.floor(Math.random() * n)\n    let shouldAnimate = false;\n    if (c !== undefined) {\n      shouldAnimate = true;\n      const [x, y] = c;\n      const ang = Math.atan2(y, x);\n      const rad = Math.sqrt(x*x + y*y);\n      const minRad = Math.min(0.1, rad / 2);\n      const maxRad = Math.max(0.8 + Math.random(), rad*1.5);\n      const a1 = Math.PI*2*(1+randomInt(4));\n      const a2 = Math.PI*2*(1+randomInt(4));\n      anim.params.c = {\n        angle: {\n          range: Math.random() < 0.5 ? [0,a1] : [a1,0],\n          map: (a: number) => ang + a,\n        },\n        radius: {\n          range: Math.random() < 0.5 ? [0,a2] : [a2,0],\n          map: (r: number) => {\n            const s = Math.sin(r);\n            if (s < 0) {\n              return rad + Math.abs(rad - minRad) * s\n            } else if (s > 0) {\n              return rad + Math.abs(maxRad - rad) * s\n            } else {\n              return rad;\n            }\n          }\n        }\n      }\n    }\n    if (p !== undefined) {\n      shouldAnimate = true;\n      const [x, y] = p;\n      const ang = Math.atan2(y, x);\n      const rad = Math.sqrt(x*x + y*y);\n      const minRad = Math.max(0.01, rad / 4);\n      const maxRad = Math.max(0.5 + Math.random(), rad*1.5);\n      const a1 = Math.PI*2*(1+randomInt(4));\n      const a2 = Math.PI*2*(1+randomInt(4));\n      anim.params.p = {\n        angle: {\n          range: Math.random() < 0.5 ? [0,a1] : [a1,0],\n          map: (a: number) => ang + a,\n        },\n        radius: {\n          range: Math.random() < 0.5 ? [0,a2] : [a2,0],\n          map: (r: number) => {\n            const s = Math.sin(r);\n            if (s < 0) {\n              return rad + Math.abs(rad - minRad) * s\n            } else if (s > 0) {\n              return rad + Math.abs(maxRad - rad) * s\n            } else {\n              return rad;\n            }\n          }\n        }\n      }\n    }\n    if (shouldAnimate) {\n      return anim.run(target, {delay});\n    } else {\n      console.log(\"This fractal cannot be magically animated. Choose a fractal with 'c' or 'p' parameters.\")\n    }\n  },\n\n}\n\nexport default fractalex;","import fractalex from './console';\n\nwindow.fractalex = fractalex;","import { Complex as _Complex } from '../math/types';\nimport { StringWithMath as SWM } from '../../components/TypographyWithMath';\n\nexport type Complex = _Complex\n\nexport type StringWithMath = SWM\n\nexport type PixelCalculator = (x: number, y: number) => number\n\nexport type Params = {[k: string]: any}\n\nexport enum ControlType {\n  Call,\n  Number,\n  Complex,\n  Boolean,\n}\n\nexport interface ControlCall {\n  type: ControlType.Call\n  label?: string\n  icon?: string\n  onCall: () => Params\n}\n\nexport interface ControlNumber {\n  type: ControlType.Number\n  label: string\n  param: string\n  step: number\n  min?: number\n  max?: number\n}\n\nexport interface ControlComplex {\n  type: ControlType.Complex\n  label: string\n  param: string\n  stepRadius: number\n  stepAngle: number\n}\n\nexport interface ControlBoolean {\n  type: ControlType.Boolean\n  label: string\n  param: string\n}\n\nexport type ControlProps = ControlCall | ControlNumber | ControlComplex | ControlBoolean\n\n\nexport interface FractalInterface<T> {\n  label: StringWithMath\n  calc: (params: T) => (x: number, y: number) => number\n  range: (params: T) => [number, number]\n  describe: (params: T) => StringWithMath\n  newParams: () => T\n  controls: ControlProps[]\n}\n\nexport type Vector = [number, number]\n\n","import { CombinedState } from 'redux';\n\nimport {\n  AlgorithmAction,\n  AlgorithmState,\n} from './algorithm/types';\nimport {\n  ColorAction,\n  ColorState,\n} from './color/types';\nimport {\n  ViewAction,\n  ViewState,\n} from './view/types';\nimport {\n  DrawAction,\n} from './drawState';\n\nexport enum DrawState {\n  None,\n  Draw,\n  Color,\n  Capture,\n}\n\nexport const UPDATE_FRACTAL = 'FRACTAL_UPDATE';\n\nexport type UpdateFractal = {\n  type: typeof UPDATE_FRACTAL\n  payload: Partial<{\n    algorithm: AlgorithmState<any>\n    color: Partial<ColorState>\n    view: Partial<Omit<ViewState,'pixelCount'>>\n  }> | undefined\n}\n\nexport type FractalState = CombinedState<{\n  algorithm: AlgorithmState<any>\n  color: ColorState\n  view: ViewState\n  drawState: DrawState\n}>\n\nexport type FractalAction = AlgorithmAction<any> | ColorAction | ViewAction | UpdateFractal | DrawAction;","// Constants\nconst PI = Math.PI\nconst TAU = 2*PI\n\n// Functions\nconst abs = Math.abs\nconst asin = Math.asin\nconst atan2 = Math.atan2\nconst exp = Math.exp\nconst floor = Math.floor\nconst pow = Math.pow\nconst random = Math.random\nconst round = Math.round\nconst sin = Math.sin\nconst sqrt = Math.sqrt\nconst cos = Math.cos\n\nexport {\n  PI,\n  TAU,\n\n  abs,\n  asin,\n  atan2,\n  cos,\n  exp,\n  floor,\n  pow,\n  random,\n  round,\n  sin,\n  sqrt,\n}\n","import { ALLFRACTALS } from './algorithm';\nimport { Algorithm } from './types';\nimport { colorScale, COLORSCHEMES } from './color';\nimport drawImage from './drawer/drawer';\n\n\nfunction fractal<T>({method, params}: Algorithm<T>) {\n  return {\n    label: method.label,\n    calc: method.calc(params),\n    range: method.range(params),\n    describe: method.describe(params),\n    controls: method.controls,\n  }\n}\n\nexport { colorScale }\n\n\n\nexport { ALLFRACTALS, COLORSCHEMES, fractal, drawImage }\n","import {\n  UpdateAlgorithm,\n  UPDATE_ALGORITHM,\n  AlgorithmState,\n  UpdateParams,\n  UPDATE_PARAMS,\n  SetAlgorithm,\n  SET_ALGORITHM,\n  Method,\n} from './types';\n\nexport const updateAlgorithm = <T>(f: Partial<AlgorithmState<T>>): UpdateAlgorithm<T> => ({\n  type: UPDATE_ALGORITHM,\n  payload: f\n})\n\nexport const updateParams = <T>(params: T): UpdateParams<T> => ({\n  type: UPDATE_PARAMS,\n  payload: params\n})\n\nexport const setAlgorithm = <T>(methodName: string, method: Method<T>, params?: T): SetAlgorithm<T> => ({\n  type: SET_ALGORITHM,\n  payload: {\n    methodName,\n    method,\n    params\n  }\n})","import {\n  UPDATE_COLOR,\n  ColorState,\n  UpdateColor,\n} from './types';\n\n\nexport const updateColor = (color: Partial<ColorState>): UpdateColor => ({\n  type: UPDATE_COLOR,\n  payload: color,\n})\n\n","import {\n  ViewState,\n  UpdateView,\n  Recenter,\n  Transform,\n  ZoomIn,\n  ZoomOut,\n  UPDATE_VIEW,\n  TRANSFORM,\n  RECENTER,\n  ZOOM_IN,\n  ZOOM_OUT,\n} from './types';\n\n\nexport const updateView = (update: Partial<ViewState>): UpdateView => ({\n  type: UPDATE_VIEW,\n  payload: update,\n})\n\nexport const recenter = (): Recenter => ({\n  type: RECENTER,\n})\n\nexport const setCenter = (cx: number, cy: number): UpdateView => ({\n  type: UPDATE_VIEW,\n  payload: {cx, cy},\n})\n\nexport const rotateDeg = (deg: number): Transform => {\n  const rad = deg * Math.PI / 180;\n  const co = Math.cos(rad);\n  const si = Math.sin(rad);\n  return ({\n    type: TRANSFORM,\n    payload: [co, si, -si, co],\n  })\n};\n\nexport const zoomIn = (factor: number): ZoomIn => ({\n  type: ZOOM_IN,\n  payload: factor,\n})\n\nexport const zoomOut = (factor: number): ZoomOut => ({\n  type: ZOOM_OUT,\n  payload: factor,\n})","import {\n  jsonToState, urlToJson,\n  AppState, JsonState\n} from '../../fractals/json';\nimport {\n  UPDATE_FRACTAL,\n  UpdateFractal,\n} from './types';\n\nexport {\n  updateAlgorithm,\n  setAlgorithm,\n  updateParams,\n} from './algorithm/actions'\n\nexport {\n  updateColor,\n} from './color/actions';\n\nexport {\n  updateView,\n  recenter,\n  rotateDeg,\n  setCenter,\n  zoomIn,\n  zoomOut,\n} from './view/actions';\n\nexport {\n  redraw,\n  recolor,\n  capture,\n  finish,\n} from './drawState'\n\nexport const uploadData = (data: AppState): UpdateFractal => ({\n  type: UPDATE_FRACTAL,\n  payload: data\n})\n\nexport const uploadJson = (data: JsonState): UpdateFractal => ({\n  type: UPDATE_FRACTAL,\n  payload: jsonToState(data)\n})\n\nexport const uploadUrl = (url: string): UpdateFractal => {\n  const data = urlToJson(url);\n  if (data) {\n    return ({\n      type: UPDATE_FRACTAL,\n      payload: jsonToState(data)\n    })\n  } else {\n    return ({\n      type: UPDATE_FRACTAL,\n      payload: undefined\n    })\n  }\n}","import { Json, AppState, AppUpdate } from '.';\nimport { ALLFRACTALS, COLORSCHEMES } from '../'\nimport {\n  objToString,\n  stringToObj,\n} from './util';\n\ntype NTuple<T,L extends number> = [T, ...T[]] & {length: L};\n\ninterface V3_ extends Json {\n  v: '3'\n  am: string\n  ap: {[k: string]: any}\n  cp: NTuple<number,4> | {n: number, mi: boolean, rv: boolean, sk: number}\n  vc: NTuple<number,2>\n  vs: NTuple<number,3>\n  vt: NTuple<number,4>\n}\n\ninterface V3a extends V3_ {\n  cs: string\n}\n\ninterface V3b extends V3_ {\n  cl: string[]\n}\n\nexport type V3 = V3a | V3b\n\nexport function stateToJson3(state: AppState): V3 {\n  const {algorithm, color, view} = state;\n  if (COLORSCHEMES[color.schemeName]) {\n    return {\n      v: '3',\n      am: algorithm.methodName,\n      ap: {...algorithm.params},\n      cs: color.schemeName,\n      //cp: [color.count, color.mirror ? 1 : 0, color.reverse ? 1 : 0, color.skew],\n      cp: {n: color.count, mi: color.mirror, rv: color.reverse, sk: color.skew},\n      vc: [view.cx, view.cy],\n      vs: [view.w, view.h, view.ppu],\n      vt: view.t,\n    }\n  } else {\n    return {\n      v: '3',\n      am: algorithm.methodName,\n      ap: {...algorithm.params},\n      cl: color.scheme as string[],\n      //cp: [color.count, color.mirror ? 1 : 0, color.reverse ? 1 : 0, color.skew],\n      cp: {n: color.count, mi: color.mirror, rv: color.reverse, sk: color.skew},\n      vc: [view.cx, view.cy],\n      vs: [view.w, view.h, view.ppu],\n      vt: view.t,\n    }\n  }\n}\n\nexport function jsonToState3(data: Partial<V3>): AppUpdate {\n  const result: AppUpdate = {};\n  if (data.am) {\n    const method = ALLFRACTALS[data.am];\n    result.algorithm = {\n      methodName: data.am,\n      method: method,\n      params: data.ap ? data.ap : method.newParams()\n    }\n  }\n  if ('cl' in data || 'cs' in data || data.cp) {\n    result.color = {};\n    if ('cl' in data && data.cl) {\n      result.color.schemeName = '[Imported Scheme]';\n      result.color.scheme = data.cl as string[];\n    } else if ('cs' in data && data.cs && COLORSCHEMES[data.cs]) {\n      result.color.schemeName = data.cs;\n      result.color.scheme = COLORSCHEMES[data.cs];\n    }\n    if (data.cp) {\n      if (Array.isArray(data.cp)) {\n        result.color.count = data.cp[0];\n        result.color.mirror = data.cp[1] ? true : false;\n        result.color.reverse = data.cp[2] ? true : false;\n        result.color.skew = data.cp[3];\n      } else {\n        result.color.count = data.cp.n;\n        result.color.mirror = data.cp.mi;\n        result.color.reverse = data.cp.rv;\n        result.color.skew = data.cp.sk;\n      }\n    }\n  }\n  if (data.vc || data.vs || data.vt) {\n    result.view = {};\n    if (data.vc) {\n      result.view.cx = data.vc[0];\n      result.view.cy = data.vc[1];\n    }\n    if (data.vs) {\n      result.view.w = data.vs[0];\n      result.view.h = data.vs[1];\n      result.view.ppu = data.vs[2];\n    }\n    if (data.vt) {\n      result.view.t = data.vt as [number,number,number,number];\n    }\n  }\n  return result;\n}\n\n\n\nexport function fromNumArr(arr: number[]) {\n  return arr.map(n => n.toString().replace('e+', 'e')).join('_');\n}\n\nexport function toNumArr<L extends number>(str: string, len: L) {\n  const a = str.split('_').map(n => +n);\n  if (a.length === len) {\n    return a as NTuple<number,L>;\n  }\n}\n\nexport function jsonToUrl3(data: Partial<V3>): string {\n  const u = new URLSearchParams();\n  u.append('v', '3');\n  if (data.am) u.append('am', data.am);\n  if (data.ap) u.append('ap', objToString(data.ap));\n  if ('cl' in data && data.cl) {\n    u.append('cl', data.cl.join('_'))\n  } else if ('cs' in data && data.cs) {\n    u.append('cs', data.cs);\n  }\n  if (data.cp) {\n    if (Array.isArray(data.cp)) {\n      u.append('cp', fromNumArr(data.cp));\n    } else {\n      u.append('cp', fromNumArr([data.cp.n, data.cp.mi ? 1 : 0, data.cp.rv ? 1 : 0, data.cp.sk]))\n    }\n  }\n  if (data.vc) {\n    u.append('vc', fromNumArr(data.vc));\n  }\n  if (data.vs) {\n    u.append('vs', fromNumArr(data.vs));\n  }\n  if (data.vt) {\n    u.append('vt', fromNumArr(data.vt));\n  }\n  return u.toString();\n}\n\ntype X  = {v: '3'} & Partial<V3>\n\nexport function urlToJson3(u: URLSearchParams): X {\n  const data: X = {v: '3'};\n  const am = u.get('am');\n  if (am) data.am = am;\n  const ap = u.get('ap');\n  if (ap) data.ap = stringToObj(ap);\n  \n  const cp = u.get('cp');\n  if (cp) {\n    const x = toNumArr(cp, 4);\n    if (x) data.cp = {n: x[0], mi: x[1] === 1, rv: x[2] === 1, sk: x[3]};\n  }\n  \n  const vc = u.get('vc');\n  if (vc) {\n    const x = toNumArr(vc, 2);\n    if (x) data.vc = x;\n  }\n\n  const vs = u.get('vs');\n  if (vs) {\n    const x = toNumArr(vs, 3);\n    if (x) data.vs = x;\n  }\n\n  const vt = u.get('vt');\n  if (vt) {\n    const x = toNumArr(vt, 4);\n    if (x) data.vt = x;\n  }\n\n  const cl = u.get('cl');\n  if (cl) {\n    return {...data, cl: cl.split('_')}\n  } else {\n    const cs = u.get('cs');\n    if (cs) {\n      return {...data, cs};\n    }\n  }\n  return data;\n}","\nexport function objToString(obj: {[k: string]: any}) {\n  return Object.entries(obj).map(([x, y]) => {\n    return x + ':' + JSON.stringify(y);\n  }).join(';')\n}\n\nexport function stringToObj(str: string) {\n  return Object.fromEntries(str.split(';').map((entry: string) => {\n    const s = entry.split(':');\n    try {\n      return [s[0], JSON.parse(s[1])] as [string, any]\n    } catch {\n      console.log('bad param', entry)\n      return ['BAD_PARAM', 'BAD_PARAM'] as [string, any]\n    }\n  }).filter((ent: [string, any]) => ent[0] !== 'BAD_PARAM'))\n}\n","import { AlgorithmState } from '../../store/fractal/algorithm/types';\nimport { ColorState } from '../../store/fractal/color/types';\nimport { ViewState } from '../../store/fractal/view/types';\nimport {\n  V3,\n  jsonToState3,\n  stateToJson3,\n  urlToJson3,\n  jsonToUrl3,\n} from './json3';\n\n\nexport interface AppState {\n  algorithm: AlgorithmState<any>,\n  color: ColorState,\n  view: Omit<ViewState,'pixelCount'>\n}\n\nexport interface AppUpdate {\n  algorithm?: AlgorithmState<any>\n  color?: Partial<ColorState>\n  view?: Partial<Omit<ViewState,'pixelCount'>>\n}\n\nexport interface Json {\n  v: '3'\n}\n\nexport type JsonState = V3\n\nexport type JsonCurrent = V3\n\nexport function stateToJson(state: AppState): JsonCurrent {\n  return stateToJson3(state);\n}\n\nexport function jsonToState(data: Json & Partial<JsonState>): AppUpdate | undefined {\n  return jsonToState3(data);\n}\n\nexport function jsonToUrl(data: JsonState): string {\n  const q = window.location.href.split('?')[0] + '?';\n  return q + jsonToUrl3(data);\n}\n\nexport function urlToJson(url: string): (Json & Partial<JsonState>) | undefined {\n  try {\n    const u = new URLSearchParams(url);\n    return urlToJson3(u);\n  } catch {}\n}","import { Complex, Polar } from './types';\nimport * as P from './polar';\nimport * as Math from './real';\n\n\nexport function complex(re: number, im: number): Complex {\n  return {re, im}\n}\n\nexport function conjugate(z: Complex) {\n  return {re: z.re, im: -z.im}\n}\n\nexport function fromPolar({angle, radius}: Polar) {\n  return {\n    re: radius * Math.cos(angle),\n    im: radius * Math.sin(angle),\n  }\n}\n\nexport function toPolar(z: Complex): Polar {\n  return {\n    angle: Math.atan2(z.im, z.re),\n    radius: Math.sqrt(z.re*z.re + z.im*z.im),\n  }\n}\n\nexport function neg(a: Complex): Complex {\n  return {re: -a.re, im: -a.im}\n}\n\n\n// Addition\n\nexport function add(a: Complex, b: Complex): Complex {\n  return {re: a.re+b.re, im: a.im+b.im}\n}\n\nexport function addReal(a: Complex, b: number): Complex {\n  return {re: a.re + b, im: a.im}\n}\n\nexport function addPolar(a: Complex, b: Polar): Complex {\n  return add(a, fromPolar(b))\n}\n\n\n// Subtraction\n\nexport function subt(a: Complex, b: Complex): Complex {\n  return {re: a.re - b.re, im: a.im - b.im}\n}\n\nexport function subtReal(a: Complex, b: number): Complex {\n  return {re: a.re - b, im: a.im}\n}\n\nexport function subtPolar(a: Complex, b: Polar): Complex {\n  return subt(a, fromPolar(b))\n}\n\n\n// Multiplication\n\nexport function mult(a: Complex, b: Complex): Complex {\n  return {\n    re: a.re*b.re - a.im*b.im,\n    im: a.re*b.im + a.im*b.re,\n  }\n}\n\nexport function multReal(a: Complex, b: number): Complex {\n  return {re: b * a.re, im: b * a.im}\n}\n\nexport function multPolar(a: Complex, b: Polar): Complex {\n  return mult(a, fromPolar(b))\n}\n\n\n// Division\n\nexport function div(a: Complex, b: Complex): Complex {\n  const d = abs2(b);\n  return {\n    re: (a.re * b.re + a.im * b.im) / d,\n    im: (a.im * b.re - a.re * b.im) / d,\n  }\n}\n\nexport function divReal(a: Complex, b: number): Complex {\n  return {re: a.re / b, im: a.im / b}\n}\n\nexport function divPolar(a: Complex, b: Polar): Complex {\n  return fromPolar(P.div(toPolar(a), b))\n}\n\n\n// Exponentiation\n\nexport function exp(z: Complex): Complex {\n  return fromPolar({radius: Math.exp(z.re), angle: z.im})\n}\n\nexport function powFloat(z: Complex, k: number): Complex {\n  return fromPolar(P.powReal(toPolar(z), k))\n}\n\nexport function powInt(z: Complex, k: number): Complex {\n  if (k < 0) return div(complex(1, 0), powInt(z, -k))\n  if (k === 0) return complex(1, 0)\n  if (k === 1) return z\n  if (k === 2) return mult(z, z)\n  if (k === 3) return mult(mult(z, z), z)\n  if (k === 4) return mult(mult(mult(z, z), z), z)\n  if (k === 5) return mult(mult(mult(mult(z, z), z), z), z)\n  if (k === 6) return mult(mult(mult(mult(mult(z, z), z), z), z), z)\n  if (k === 7) return mult(mult(mult(mult(mult(mult(z, z), z), z), z), z), z)\n  if (k === 8) return mult(mult(mult(mult(mult(mult(mult(z, z), z), z), z), z), z), z)\n  return powFloat(z, k)\n}\n\nexport function powReal(z: Complex, k: number): Complex {\n  return powInt(z, k);\n}\n\nconst pow2 = (z: Complex) => mult(z, z);\nconst pow3 = (z: Complex) => mult(mult(z, z), z);\nconst pow4 = (z: Complex) => mult(mult(mult(z, z), z), z);\nconst pow5 = (z: Complex) => mult(mult(mult(mult(z, z), z), z), z);\nconst pow6 = (z: Complex) => mult(mult(mult(mult(mult(z, z), z), z), z), z);\nconst pow7 = (z: Complex) => mult(mult(mult(mult(mult(mult(z, z), z), z), z), z), z);\n//const pow8 = (z: Complex) => mult(mult(mult(mult(mult(mult(mult(z, z), z), z), z), z), z), z);\nconst pow8 = (z: Complex) => pow2(pow2(pow2(z)))\n\nexport function powN(k: number): (z: Complex) => Complex {\n  if (k < 0) {\n    const p = powN(-k);\n    return (z: Complex) => div(complex(1, 0), p(z))\n  }\n  if (k === 0) return z => complex(1, 0);\n  if (k === 1) return z => z;\n  if (k === 2) return pow2\n  if (k === 3) return pow3\n  if (k === 4) return pow4\n  if (k === 5) return pow5\n  if (k === 6) return pow6\n  if (k === 7) return pow7\n  if (k === 8) return pow8\n  if (k % 1 === 0) {\n    if (k % 2 === 0) {\n      const p = powN(k / 2)\n      return (z: Complex) => pow2(p(z))\n    } else {\n      const p = powN((k-1) / 2)\n      return (z: Complex) => mult(z, pow2(p(z)))\n    }\n  }\n  return z => powFloat(z, k);\n}\n\n\n// Other\n\nexport function abs2(z: Complex): number {\n  return z.re * z.re + z.im * z.im;\n}\n\nexport function abs(z: Complex): number {\n  return Math.sqrt(abs2(z));\n}\n\nexport function angle(z: Complex): number {\n  return Math.atan2(z.im, z.re);\n}\n\nexport function sqrt(z: Complex): Complex {\n  const angle = Math.atan2(z.im, z.re);\n  return fromPolar({\n    angle: angle / 2,\n    radius: Math.sqrt(abs(z))\n  })\n}\n\nexport function sinh(z: Complex): Complex {\n  return divReal(subt(exp(z), exp(neg(z))), 2)\n}\n","import { COLORSCHEMES, ALLFRACTALS } from './fractals'\n\nexport const methodName = 'F_MdJl'\nexport const colorSchemeName = 'Rainbow'\nexport const pixelCount = 90000\nexport const captureSize = {\n  w: 1920,\n  h: 1080,\n}\n\nexport const canvasSize = {\n  w: 600,\n  h: 500,\n}\n\nexport const method = ALLFRACTALS[methodName]\nexport const colorScheme = COLORSCHEMES[colorSchemeName]","import { Vector, Transform } from './types';\n\nexport const rotate = (rad: number): Transform => {\n  const co = Math.cos(rad), si = Math.sin(rad);\n  return [co, si, -si, co];\n}\nexport const rotateDeg = (deg: number): Transform => rotate(deg * Math.PI / 180);\nexport const scale = (k: number): Transform => [k, 0, 0, k];\nexport const scaleX = (k: number): Transform => [k, 0, 0, 1];\nexport const scaleY = (k: number): Transform => [1, 0, 0, k];\n\nexport function invert(t: Transform): Transform | undefined {\n  const [a, b, c, d] = t;\n  const det = a*d - b*c;\n  if (det === 0) {\n    console.error('cannot invert matrix - determinant is zero: [' + t.join(',') + ']');\n  } else {\n    return [d, -b, -c, a].map(n => n/det) as Transform\n  }\n}\n\nexport function apply(t: Transform, pt: Vector): Vector {\n  return [\n    t[0] * pt[0] + t[2] * pt[1],\n    t[1] * pt[0] + t[3] * pt[1],\n  ];\n}\n\nexport function multiply(t1: Transform, t2: Transform): Transform {\n  return [\n    t1[0]*t2[0] + t1[2]*t2[1],\n    t1[1]*t2[0] + t1[3]*t2[1],\n    t1[0]*t2[2] + t1[2]*t2[3],\n    t1[1]*t2[2] + t1[3]*t2[3],\n  ]\n}\n\nexport function transformed(\n  f: (x: number, y: number) => number, \n  t: Transform | undefined, \n  cx: number=0, \n  cy: number=0,\n): (x: number, y: number) => number {\n  if (t) {\n    const [a, b, c, d] = t;\n    return (x: number, y: number) => f(\n      (x-cx)*a + (y-cy)*c + cx,\n      (x-cx)*b + (y-cy)*d + cy,\n    );\n  }\n  return f;\n}","export interface ViewState {\n  cx: number\n  cy: number\n  w: number\n  h: number\n  ppu: number // units per pixel\n  pixelCount: number\n  t: [number,number,number,number] // transform matrix [a, b, c, d]\n}\n\nexport const UPDATE_VIEW = 'VIEW_UPDATE';\nexport const ZOOM_IN = 'VIEW_ZOOM_IN';\nexport const ZOOM_OUT = 'VIEW_ZOOM_OUT';\nexport const RECENTER = 'VIEW_RECENTER';\nexport const TRANSFORM = 'VIEW_TRANSFORM';\n\nexport type UpdateView = {\n  type: typeof UPDATE_VIEW,\n  payload: Partial<ViewState>,\n}\n\nexport type Recenter = {\n  type: typeof RECENTER,\n}\n\nexport type Transform = {\n  type: typeof TRANSFORM,\n  payload: [number, number, number, number]\n}\n\nexport type ZoomIn = {\n  type: typeof ZOOM_IN,\n  payload: number,\n}\n\nexport type ZoomOut = {\n  type: typeof ZOOM_OUT,\n  payload: number,\n}\n\nexport type ViewAction = UpdateView | ZoomIn | ZoomOut | Recenter | Transform;","import {\n  interpolateLab,\n  piecewise,\n  scalePow,\n  scaleLinear,\n} from 'd3';\nimport { Color } from './types';\n\n\nfunction colorScale(color: Color): (domain: [number,number]) => (n: number) => string {\n  const interpolator = Array.isArray(color.scheme)\n    ? piecewise(interpolateLab, color.scheme)\n    : color.scheme;\n  const range = color.reverse ? [1, 0] : [0, 1];\n  const exponent = 2**color.skew;\n  if (color.mirror) {\n    const scaleA = scaleLinear().domain([0,0.5]).range(range);\n    const scaleB = scaleLinear().domain([1,0.5]).range(range);\n    return (domain: [number,number]) => {\n      const scale1 = scalePow().domain(domain).range([0,1]).exponent(exponent);\n      const scale2 = (n: number) => {\n        if (n < 0.5) return scaleA(n);\n        else return scaleB(n);\n      }\n      return (n: number) => interpolator(scale2(scale1(n)));  \n    }\n  }\n  return (domain: [number,number]) => {\n    const scale = scalePow().domain(domain).range(range).exponent(exponent);\n    return (n: number) => interpolator(scale(n));  \n  }\n}\n\ntype ColorRGBA = [number, number, number, number] & Uint8ClampedArray\n\nfunction colorMap(color: Color): (domain: [number,number]) => ColorRGBA[] {\n  // discrete version\n  const cs = colorScale(color);\n  const ctx = document.createElement('canvas').getContext('2d') as CanvasRenderingContext2D;\n  return (domain: [number, number]) => {\n    if (domain[0] === 0) {\n      const scale = cs(domain);\n      const result: ColorRGBA[] = [];\n      for (let i = 0; i <= domain[1]; i++) {\n        ctx.fillStyle = scale(i);\n        ctx.fillRect(0,0,1,1);\n        const rgba = ctx.getImageData(0,0,1,1).data as ColorRGBA;\n        result.push(rgba)\n      }\n      return result;\n    } else {\n      const d0 = domain[0]\n      const dd = domain[1] - d0;\n      const scale = cs([0, dd]);\n      const result: ColorRGBA[] = [];\n      for (let i = 0; i <= dd; i++) {\n        ctx.fillStyle = scale(i % (dd+1));\n        ctx.fillRect(0,0,1,1);\n        const rgba = ctx.getImageData(0,0,1,1).data as ColorRGBA;\n        result.push(rgba);\n      }\n      return result;\n    }\n  }\n}\n\n\nexport { colorScale, colorMap }","import {\n  interpolateInferno as Inferno,\n  interpolateMagma as Magma,\n  interpolatePlasma as Plasma,\n  interpolateViridis as Viridis,\n  interpolateCool as Cool,\n  interpolateWarm as Warm,\n  interpolateGreys as Greys,\n  interpolateRainbow as Rainbow,\n  interpolateSinebow as Sinebow,\n  interpolateSpectral as Spectral,\n  interpolateCubehelixDefault as Cubehelix,\n\n  interpolateBlues as Blues,\n  interpolateBrBG as BrBG,\n  interpolateBuGn as BuGn,\n  interpolateBuPu as BuPu,\n  interpolateGnBu as GnBu,\n  interpolateGreens as Greens,\n  interpolateOrRd as OrRd,\n  interpolateOranges as Oranges,\n  interpolatePRGn as PRGn,\n  interpolatePiYG as PiYG,\n  interpolatePuBu as PuBu,\n  interpolatePuBuGn as PuBuGn,\n  interpolatePuOr as PuOr,\n  interpolatePuRd as PuRd,\n  interpolatePurples as Purples,\n  interpolateRdBu as RdBu,\n  interpolateRdGy as RdGy,\n  interpolateRdPu as RdPu,\n  interpolateRdYlBu as RdYlBu,\n  interpolateRdYlGn as RdYlGn,\n  interpolateReds as Reds,\n  interpolateYlGn as YlGn,\n  interpolateYlGnBu as YlGnBu,\n  interpolateYlOrBr as YlOrBr,\n  interpolateYlOrRd as YlOrRd,\n\n} from 'd3';\nimport { ColorScheme } from './types';\n\ntype SchemeDict = {[k: string]: ColorScheme}\n\nconst D3_SCHEMES_1: SchemeDict = {\n  Cool,\n  Cubehelix,\n  Greys,\n  Inferno,\n  Magma,\n  Plasma,\n  Rainbow,\n  Sinebow,\n  Spectral,\n  Viridis,\n  Warm,\n}\n\nconst D3_SCHEMES_2: SchemeDict = {\n  Blues,\n  BrBG,\n  BuGn,\n  BuPu,\n  GnBu,\n  Greens,\n  OrRd,\n  Oranges,\n  PRGn,\n  PiYG,\n  PuBu,\n  PuBuGn,\n  PuOr,\n  PuRd,\n  Purples,\n  RdBu,\n  RdGy,\n  RdPu,\n  RdYlBu,\n  RdYlGn,\n  Reds,\n  YlGn,\n  YlGnBu,\n  YlOrBr,\n  YlOrRd,\n}\n\nconst OTHER_SCHEMES: SchemeDict = {\n  Paint: [\"#3db5ec\", \"#73c2b0\", \"#b9e375\", \"#f4bb44\", \"#eb591b\"],\n  Ink: ['#000000', '#FFDD8C'],\n}\n\nconst ALL_SCHEMES: SchemeDict = {\n  ...D3_SCHEMES_1,\n  ...D3_SCHEMES_2,\n  ...OTHER_SCHEMES,\n}\n\nexport default ALL_SCHEMES\n","import { colorScale, colorMap } from './colorScale';\nimport COLORSCHEMES from './schemes';\n\n\nexport {\n  colorScale,\n  colorMap,\n  COLORSCHEMES,\n}","import { JsonState } from '../../fractals/json'\nexport const ADD_TO_GALLERY = 'GALLERY_ADD'\nexport const MASS_ADD_TO_GALLERY = 'MASS_ADD_TO_GALLERY'\nexport const DELETE_IMAGE = 'GALLERY_DELETE'\n\nexport interface GalleryImage {\n  url: string\n  data: JsonState\n  title: string\n}\n\nexport type GalleryState = GalleryImage[]\n\nexport type AddToGallery = {\n  type: typeof ADD_TO_GALLERY\n  payload: GalleryImage\n}\n\nexport type MassAddToGallery = {\n  type: typeof MASS_ADD_TO_GALLERY\n  payload: GalleryImage[]\n}\n\nexport type DeleteImage = {\n  type: typeof DELETE_IMAGE\n  payload: string\n}\n\nexport type GalleryAction = AddToGallery | DeleteImage | MassAddToGallery\n\n\n","import { DrawState } from './types';\n\nexport const SET_DRAW_STATE = 'FRACTAL_SET_DRAW'\nexport const FINISH_DRAWING = 'FRACTAL_FINISH_DRAW'\n\nexport type SetDrawState = {\n  type: typeof SET_DRAW_STATE\n  payload: DrawState\n}\n\nexport type FinishDrawing = {\n  type: typeof FINISH_DRAWING\n}\n\nexport type DrawAction = SetDrawState | FinishDrawing;\n\nexport function reducer(state: DrawState=DrawState.None, action: DrawAction) {\n  switch(action.type) {\n    case SET_DRAW_STATE:\n      return action.payload;\n    case FINISH_DRAWING:\n      return DrawState.None\n    default:\n      return state;\n  }\n}\n\nexport const redraw = (): SetDrawState => ({\n  type: SET_DRAW_STATE,\n  payload: DrawState.Draw,\n})\n\nexport const recolor = (): SetDrawState => ({\n  type: SET_DRAW_STATE,\n  payload: DrawState.Color,\n})\n\nexport const capture = (): SetDrawState => ({\n  type: SET_DRAW_STATE,\n  payload: DrawState.Capture,\n})\n\nexport const finish = (): FinishDrawing => ({\n  type: FINISH_DRAWING,\n})","import { ViewState } from '../../store/fractal/view/types';\nimport { FractalState } from '../../store/fractal/types';\nimport { FractalViewState, ViewRect } from './types';\nimport makeImage from './image';\nimport { colorMap } from '../color';\nimport { fixView } from './view';\nimport { ALLFRACTALS } from '../algorithm';\n\nexport const OPTS = ({\n  logDrawTime: false,\n});\n\ninterface Fractal extends Pick<FractalState,'algorithm'|'color'> {\n  view: FractalViewState | ViewState\n}\n\n\nfunction drawImage(fractal: Fractal): ImageData | undefined {\n  const method = ALLFRACTALS[fractal.algorithm.methodName];\n  if (method) {\n    const pixel = method.calc(fractal.algorithm.params);\n    const range = method.range(fractal.algorithm.params);\n    const t = fractal.view.t;\n    let view: ViewRect\n    if ('pixelCount' in fractal.view) {\n      const {t, pixelCount, ...rest} = fractal.view;\n      view = fixView(rest, pixelCount)\n    } else {\n      view = fixView(fractal.view);\n    }\n    const colors = colorMap(fractal.color)(fractal.color.count ? [0, fractal.color.count] : range);\n    return makeImage({\n      pixel,\n      colors,\n      view,\n      transform: t,\n    });\n  }\n}\n\nexport default function(fractal: Fractal): ImageData | undefined {\n  if (OPTS.logDrawTime) {\n    const t0 = performance.now();\n    const image = drawImage(fractal);\n    const t1 = performance.now();\n    console.log('draw time:', t1 - t0);\n    return image;\n  } else {\n    return drawImage(fractal);\n  }\n}","import { Fractal } from './types';\nimport {\n  linearScale,\n  fixView,\n} from './view';\nimport { transformed, invert } from './transform';\n\n\nexport default function(fractal: Fractal): ImageData {\n  const {cx, cy, w, h, xdom, ydom} = fixView(fractal.view);\n  const xscale = linearScale([0, w], xdom);\n  const yscale = linearScale([0, h], ydom);\n  const calc = transformed(fractal.pixel, fractal.transform ? invert(fractal.transform) : undefined, cx, cy);\n  const image = new ImageData(w, h);\n  for (let r = 0; r < h; r++) {\n    const y = yscale(r);\n    const hh = w * r;\n    for (let c = 0; c < w; c++) {\n      const x = xscale(c);\n      const i = 4*(c + hh);\n      const color = fractal.colors[calc(x, y) % fractal.colors.length]; \n      image.data[i] = color[0];\n      image.data[i+1] = color[1];\n      image.data[i+2] = color[2];\n      image.data[i+3] = color[3];\n    }\n  }\n  return image;\n}","import {\n  AlgorithmState,\n  AlgorithmAction,\n  SET_ALGORITHM,\n  UPDATE_ALGORITHM,\n  UPDATE_PARAMS,\n} from './types';\nimport { method, methodName } from '../../../defaults';\n\nconst initialState = {\n  methodName,\n  method,\n  params: method.newParams()\n}\n\nexport default function<T>(state: AlgorithmState<any>=initialState, action: AlgorithmAction<T>) {\n  switch (action.type) {\n    case UPDATE_ALGORITHM:\n      return {...state, ...action.payload}\n    case SET_ALGORITHM:\n      return {\n        methodName: action.payload.methodName,\n        method: action.payload.method, \n        params: action.payload.params ? action.payload.params : action.payload.method.newParams(),\n      } as AlgorithmState<T>\n    case UPDATE_PARAMS:\n      return {...state, params: {...state.params, ...action.payload}} as typeof state\n    default:\n      return state\n  }\n}","import { COLORSCHEMES } from '../../../fractals/color';\nimport {\n  ColorState,\n  ColorAction,\n  UPDATE_COLOR,\n} from './types';\nimport { colorSchemeName } from '../../../defaults';\n\nconst initialState: ColorState = {\n  schemeName: colorSchemeName,\n  scheme: COLORSCHEMES[colorSchemeName],\n  mirror: false,\n  reverse: false,\n  skew: 0,\n  count: 0,\n}\n\nexport default function(state: ColorState=initialState, action: ColorAction) {\n  switch(action.type) {\n    case UPDATE_COLOR:\n      return {...state, ...action.payload}\n    default:\n      return state;\n  }\n}","import algorithm from './algorithm/reducer';\nimport color from './color/reducer';\nimport view from './view/reducer';\nimport { reducer as drawState } from './drawState';\nimport {\n  FractalState,\n  FractalAction,\n  UPDATE_FRACTAL,\n} from './types';\nimport { combineReducers } from 'redux';\n\nconst reducer1 = combineReducers({\n  algorithm,\n  color,\n  view,\n  drawState,\n});\n\nexport default function(state: FractalState, action: FractalAction): FractalState {\n  if (action.type === UPDATE_FRACTAL) {\n    if (action.payload !== undefined) {\n      const vw = {...state.view, ...action.payload.view}\n      // fit without changing w:h ratio\n      const rw = vw.w / state.view.w;\n      const rh = vw.h / state.view.h;\n      if (rw > rh) {\n        vw.h = state.view.h * rw;\n      } else {\n        vw.w = state.view.w * rh;\n      }\n      return {\n        algorithm: {...state.algorithm, ...action.payload.algorithm},\n        color: {...state.color, ...action.payload.color},\n        view: vw,\n        drawState: state.drawState,\n      };\n    } else {\n      return state;\n    }\n  } else {\n    return reducer1(state, action);\n  }\n}\n","import {\n  UIState,\n  Nav,\n  Modal,\n  StretchMode,\n  SET_NAV,\n  SET_MODAL,\n  SET_STRETCH,\n  UPDATE_UI,\n  ADD_COLOR_SCHEME,\n} from './types';\nimport { Action } from '../types';\nimport { ADD_TO_GALLERY } from '../gallery/types';\nimport { ALLFRACTALS } from '../../fractals/algorithm';\nimport { COLORSCHEMES } from '../../fractals/color';\nimport { UPDATE_FRACTAL } from '../fractal/types';\nimport { FINISH_DRAWING } from '../fractal/drawState';\n\n\nconst initialState: UIState = ({\n  nav: Nav.Explore,\n  modal: Modal.None,\n  canvasStretch: StretchMode.Contain,\n  galleryBadge: 0,\n  methodList: ALLFRACTALS,\n  colorSchemeList: {...COLORSCHEMES},\n  waiting: false,\n});\n\n\nexport default function(state: UIState=initialState, action: Action) {\n  switch(action.type) {\n    case UPDATE_UI:\n      return {...state, ...action.payload};\n    case SET_NAV:\n      if (action.payload === Nav.Gallery) {\n        return {...state, nav: action.payload, galleryBadge: 0};\n      } else {\n        return {...state, nav: action.payload};\n      }\n    case SET_MODAL:\n      return {...state, modal: action.payload};\n    case SET_STRETCH:\n      return {...state, canvasStretch: action.payload};\n    case ADD_COLOR_SCHEME:\n      return {\n        ...state, \n        colorSchemeList: {\n          ...state.colorSchemeList,\n          [action.payload.name]: action.payload.scheme,\n        },\n      };\n    case ADD_TO_GALLERY:\n      return {...state, galleryBadge: state.galleryBadge+1};\n    case UPDATE_FRACTAL:\n      if (action.payload\n        && action.payload.color\n        && action.payload.color.schemeName \n        && !(state.colorSchemeList[action.payload!.color!.schemeName])) {\n        return {\n          ...state, \n          colorSchemeList: {\n            ...state.colorSchemeList,\n            [action.payload.color.schemeName]: action.payload.color.scheme,\n          },\n        };\n      }\n      return state;\n    case FINISH_DRAWING:\n      return {...state, waiting: false}\n    default:\n      return state;\n  }\n}","import {\n  GalleryState,\n  GalleryAction,\n  ADD_TO_GALLERY,\n  DELETE_IMAGE,\n  MASS_ADD_TO_GALLERY,\n} from './types'\n\nconst initialState: GalleryState = [];\n\nexport default function(state: GalleryState=initialState, action: GalleryAction) {\n  switch(action.type) {\n    case ADD_TO_GALLERY:\n      return [...state, action.payload];\n    case DELETE_IMAGE:\n      URL.revokeObjectURL(action.payload)\n      return state.filter(v => v.url !== action.payload);\n    case MASS_ADD_TO_GALLERY:\n      console.log(action);\n      return [...state, ...action.payload];\n    default:\n      return state\n  }\n}","import { combineReducers } from 'redux';\nimport fractal from './fractal/reducer';\nimport ui from './ui/reducer';\nimport gallery from './gallery/reducer';\n\nexport default combineReducers({\n  fractal,\n  ui,\n  gallery,\n});","import { createStore } from 'redux';\nimport reducer from './reducer';\n\nexport default createStore(reducer);","import {\n  View,\n  ViewRect,\n  isViewRect,\n} from './types';\n\nexport function linearScale(domain: [number, number], range: [number,number]) {\n  const m = (range[1] - range[0]) / (domain[1] - domain[0])\n  const b = range[0] - m*domain[0]\n  return (n: number) => m*n + b;\n}\n\nexport function scaleFactor(\n  w: number,\n  h: number,\n  pixelCount: number,\n) {\n  const pixels = w * h;\n  const factor = Math.sqrt(pixelCount / pixels)\n  return factor;\n  /*\n  return {\n    w: Math.round(w * factor),\n    h: Math.round(h * factor),\n    ppu: Math.round(ppu * factor),\n  };\n  */\n}\n\nexport function fixView(view: View, pixelCount?: number): ViewRect {\n  if (isViewRect(view)) {\n    if (pixelCount) {\n      const f = scaleFactor(view.w, view.h, pixelCount);\n      return {w: view.w*f, h: view.h*f, ...view}\n    }\n    return view;\n  }\n  else {\n    let {w, h, cx, cy, ppu} = view;\n    if (pixelCount) {\n      const f = scaleFactor(view.w, view.h, pixelCount);\n      w = Math.round(w*f);\n      h = Math.round(h*f);\n      ppu *= f;\n    }\n    const rx = w / 2 / ppu;\n    const ry = h / 2 / ppu;\n    return {\n      cx, cy,\n      w, h,\n      xdom: [cx-rx, cx+rx],\n      ydom: [cy-ry, cy+ry],\n    }\n  }\n}","\nexport type ColorRGBA = [number,number,number,number] & Uint8ClampedArray; // [r, g, b, a], 0-255\n\nexport type Vector = [number, number]\n\nexport type Transform = [number, number, number, number]; \n/**\n * transform matrix [a, b, c, d]\n * this should be the INVERSE transform, e.g. if the image is \n * rotated DEG degrees counter-clockwise:\n * RAD = DEG * pi / 180\n * [-cos(RAD), -sin(RAD), sin(RAD), -cos(RAD)]\n * \n * Or, with javascript: T = new DOMMatrix().rotate(DEG)\n * [T.a, T.b, T.c, T.d]\n */\n\ninterface VW {\n  cx: number // center x coordinate\n  cy: number // center y coordinate\n  w: number // pixels\n  h: number // pixels\n}\n\nexport interface ViewPPU extends VW {\n  ppu: number // pixels per unit\n}\n\nexport interface ViewRect extends VW {\n  xdom: [number, number] // x domain\n  ydom: [number, number] // y domain\n}\n\nexport type View = ViewPPU | ViewRect;\n\nexport interface WithTransform {\n  t?: Transform\n}\n\nexport function isViewRect(v: View): v is ViewRect {\n  return 'xdom' in v;\n}\n\nexport type FractalViewState = View & WithTransform\n\n\nexport interface Fractal {\n  pixel: (x: number, y: number) => number\n  transform?: Transform\n  colors: ColorRGBA[]\n  view: View\n}","import { Complex, Polar } from './types';\nimport * as Math from './real';\n\n\nexport function polar(angle: number, radius: number): Polar {\n  return {angle, radius};\n}\n\nexport function fromComplex({re, im}: Complex): Polar {\n  return {\n    angle: Math.atan2(im, re),\n    radius: Math.sqrt(re*re + im*im),\n  };\n}\n\nexport function toComplex(z: Polar): Complex {\n  return {\n    re: z.radius * Math.cos(z.angle),\n    im: z.radius * Math.sin(z.angle),\n  };\n}\n\nexport function neg(z: Polar): Polar {\n  return {\n    angle: z.angle,\n    radius: -z.radius,\n  };\n}\n\nexport function mult(a: Polar, b: Polar): Polar {\n  return {\n    angle: a.angle + b.angle,\n    radius: a.radius * b.radius,\n  };\n}\n\nexport function multReal(a: Polar, b: number): Polar {\n  return {angle: a.angle, radius: b* a.radius}\n}\n\nexport function div(a: Polar, b: Polar): Polar {\n  return {\n    angle: a.angle - b.angle,\n    radius: a.radius / b.radius,\n  };\n}\n\nexport function divReal(a: Polar, b: number): Polar {\n  return {angle: a.angle, radius: a.radius / b}\n}\n\nexport function powReal(z: Polar, k: number): Polar {\n  return {angle: z.angle * k, radius: Math.pow(z.radius, k)}\n}\n","import {\n  FractalInterface,\n} from '../../../fractals/algorithm/types';\n\nexport const UPDATE_ALGORITHM = 'ALGORITHM_UPDATE';\nexport const SET_ALGORITHM = 'ALGORITHM_SET';\nexport const UPDATE_PARAMS = 'ALGORITHM_UPDATE_PARAMS';\n\nexport type Method<T> = FractalInterface<T>\n\nexport interface AlgorithmState<T> {\n  methodName: string\n  method: Method<T>\n  params: T\n}\n\nexport type UpdateAlgorithm<T> = {\n  type: typeof UPDATE_ALGORITHM\n  payload: Partial<AlgorithmState<T>>\n}\n\nexport type SetAlgorithm<T> = {\n  type: typeof SET_ALGORITHM,\n  payload: {\n    methodName: string\n    method: Method<T>\n    params?: T\n  }\n}\n\nexport type UpdateParams<T> = {\n  type: typeof UPDATE_PARAMS,\n  payload: T\n}\n\nexport type AlgorithmAction<T> = UpdateAlgorithm<T> | SetAlgorithm<T> | UpdateParams<T>","import {\n  FractalInterface,\n  ControlProps,\n  StringWithMath,\n} from '../types'\n\n\n// create, settings, controls, random?\n\n\nexport default function<T>({\n  controls=[],\n  ...rest\n}: {\n  calc: (params: T) => (x: number, y: number) => number\n  newParams: () => T\n  label: StringWithMath\n  describe: (params: T) => StringWithMath\n  range: (params: T) => [number,number]\n  controls?: ControlProps[]\n}): FractalInterface<T> {\n  return {...rest, controls};\n}","import { Complex } from '../math/types';\nimport { abs2 } from '../math/complex';\n\n\nexport default function(bail: number, iterations: number) {\n  const b2 = bail * bail;\n  return (\n    f: (n: Complex) => Complex,\n    z0: Complex = {re: 0, im: 0}, \n  ) => {\n    let k = 0;\n    let z = z0;\n    while (k < iterations && abs2(z) < b2) {\n      k += 1;\n      z = f(z);\n    }\n    return k;\n  }\n}","import {\n  FractalInterface,\n  Complex,\n  ControlProps,\n  StringWithMath,\n  Params,\n} from '../types'\nimport { StringOrMath } from '../../../components/TypographyWithMath';\nimport { complex } from '../../math/complex';\nimport escapeTime from '../escapeTime';\nimport { num } from '../../formatting';\nimport baseFractalInterface from './base';\n\n\nexport interface EscapeParams extends Params {\n  bail: number\n  iter: number\n}\n\nexport const DefaultEscapeParams: EscapeParams ={\n  bail: 10,\n  iter: 20,\n}\n\nexport function newParams<T>(x: () => T): () => (T & EscapeParams) {\n  return () => ({...DefaultEscapeParams, ...x()});\n}\n\nfunction calculate<T>(\n    f: (p: T) => (c: Complex) => (z: Complex) => Complex,\n    z0: 0 | 'c' | ((p: T) => (c: Complex) => Complex)=0,\n): (params: T & EscapeParams) => (x: number, y: number) => number {\n  if (z0 === 0) {\n    return (p: T & EscapeParams) => {\n      const func = f(p)\n      return (x: number, y: number) => {\n        return escapeTime(p.bail, p.iter)(func(complex(x, y)))\n      };\n    };\n  }\n  if (z0 === 'c') {\n    return (p: T & EscapeParams) => {\n      const func = f(p)\n      return (x: number, y: number) => {\n        return escapeTime(p.bail, p.iter)(func(complex(x, y)), complex(x, y))\n      };\n    };\n  }\n  return (p: T & EscapeParams) => {\n    const func = f(p)\n    const zz = z0(p)\n    return (x: number, y: number) => {\n      return escapeTime(p.bail, p.iter)(func(complex(x, y)), zz(complex(x, y)))\n    };\n  };\n}\n\nfunction describe<T>(\n    f: (p: T & EscapeParams) => string,\n    z0: 0 | 'c' | ((p: T & EscapeParams) => string)=0,\n): (params: T & EscapeParams) => StringWithMath {\n  return (p: T & EscapeParams) => describeEscapeFunction(\n    f(p),\n    z0 === 0 ? '0' : z0 === 'c' ? 'x+yi' : z0(p),\n    p.bail,\n    p.iter,\n  );\n}\n\ninterface CommonEscapeProps<T> {\n  label: StringWithMath\n  f: (p: T) => (c: Complex) => (z: Complex) => Complex\n  z0?: 0 | 'c' | ((p: T) => (c: Complex) => Complex)\n  newParams: () => T\n  controls?: ControlProps[]\n}\n\ninterface EscapePropsA<T> extends CommonEscapeProps<T> {\n  latexF: (p: T & EscapeParams) => string\n  latexZ0?: 0 | 'c' | ((p: T) => string)\n}\n\ninterface EscapePropsB<T> extends CommonEscapeProps<T> {\n  describe: (p: T & EscapeParams) => StringWithMath\n}\n\ntype EscapeProps<T> = EscapePropsA<T> | EscapePropsB<T>\n\nfunction isTypeA<T>(p: EscapeProps<T>): p is EscapePropsA<T> {\n  return !('describe' in p);\n}\n\nexport default function escape<T>(props: EscapeProps<T>): FractalInterface<T & EscapeParams> {\n  if (isTypeA(props)) {\n    const lz0 =\n      props.latexZ0 === undefined && (props.z0 === 0 || props.z0 === 'c')\n      ? props.z0 : props.latexZ0;\n    return baseFractalInterface<T & EscapeParams>({\n      label: props.label,\n      calc: calculate(props.f, props.z0),\n      range: (params: EscapeParams) => [0, params.iter],\n      describe: describe(props.latexF, lz0),\n      newParams: newParams(props.newParams),\n      controls: props.controls,\n    })\n  } else {\n    return baseFractalInterface<T & EscapeParams>({\n      label: props.label,\n      calc: calculate(props.f, props.z0),\n      range: (params: T & EscapeParams) => [0, params.iter],\n      describe: props.describe,\n      newParams: newParams(props.newParams),\n      controls: props.controls,\n    })\n  }\n}\n\n\nexport function describeEscapeFunction(\n  f: string, \n  z0: string, \n  bail: number, \n  iter: number,\n): StringOrMath[] {\n\n  const fmla = (\n    '\\\\begin{aligned}'\n    + 'z_0 &= ' + z0\n    + '\\\\\\\\' \n    + 'z_{n+1} &= ' + (f.indexOf('z_') === -1 ? f.replace(/z/g, 'z_n') : f)\n    + '\\\\end{aligned}'\n  );\n\n  return [\n    {math: fmla, displayMode: true},\n    \"The color of the pixel located at \", {math: \"(x, y)\"},\n    \" corresponds to \", {math: \"k\"}, \", where \", {math: \"z_k\"},\n    \" is the first term of the above sequence such that \",\n    {math: `|z_k| > ${num(bail)}`},\n    \". If this does not occur in the first \", {math: num(iter)},\n    \" terms of the sequence, then \", {math: \"k = \" + num(iter)}, '.',\n  ]\n}","import {\n  FractalInterface,\n  Complex,\n  ControlProps,\n  StringWithMath,\n} from '../types'\nimport baseFractalInterface from './base';\nimport escapeTime from '../escapeTime';\nimport { EscapeParams, describeEscapeFunction, newParams } from './escape';\nimport { complex } from '../../math/complex';\n\n\nfunction juliaLabel(f: StringWithMath): StringWithMath {\n  if (Array.isArray(f)) {\n    return ['Julia: ', ...f]\n  } else {\n    return ['Julia: ', f]\n  }\n}\n\nfunction juliaCalc<T>(\n  f: (p: T) => (z: Complex) => Complex,\n) {\n  return (p: T & EscapeParams) => {\n    const func = f(p)\n    const esc = escapeTime(p.bail, p.iter)\n    return (x: number, y: number) => {\n      return esc(func, complex(x, y))\n    };\n  };\n}\n\nexport default function julia<T>({f, label, latexF, ...props}: {\n  f: (p: T) => (z: Complex) => Complex,\n  label: StringWithMath,\n  latexF: (p: T & EscapeParams) => string,\n  newParams: () => T,\n  controls?: ControlProps[],\n}): FractalInterface<T & EscapeParams> {\n\n  return baseFractalInterface<T & EscapeParams>({\n    label: juliaLabel(label),\n    calc: juliaCalc(f),\n    range: (params: EscapeParams) => [0, params.iter],\n    describe: (params: T & EscapeParams) => describeEscapeFunction(\n      latexF(params),\n      'x+yi',\n      params.bail,\n      params.iter,\n    ),\n    newParams: newParams(props.newParams),\n    controls: props.controls,\n  })\n}\n\nexport function noParam(props: {\n  f: (z: Complex) => Complex,\n  latexF: string,\n  newParams?: () => Partial<EscapeParams>\n}): FractalInterface<EscapeParams> {\n  return julia({\n    f: () => props.f,\n    label: props.latexF,\n    latexF: () => props.latexF,\n    newParams: props.newParams ? props.newParams : () => ({}),\n  });\n}","import {\n  ControlCall,\n  ControlType,\n  ControlNumber,\n  ControlComplex,\n} from '../types'\n\n\nexport function number(param: string, {step=1, ...rest}: {\n  min?: number\n  max?: number\n  label?: string\n  step?: number\n}={}): ControlNumber {\n  return {\n    type: ControlType.Number,\n    param,\n    label: rest.label ? rest.label : param,\n    step,\n    ...rest,\n  }\n}\n\n\nexport function complex(param: string, {stepRadius=0.02, stepAngle=Math.PI/60, ...rest}: {\n  label?: string\n  stepRadius?: number\n  stepAngle?: number\n}={}): ControlComplex {\n  return {\n    type: ControlType.Complex,\n    param,\n    label: rest.label ? rest.label : param,\n    stepRadius,\n    stepAngle,\n    ...rest,\n  }\n}\n\n\nexport function getRandomC(): [number,number] {\n  let angle = Math.PI -2 * Math.asin(Math.pow(Math.random(), 0.9));\n  if (Math.random() < 0.5) angle = 2*Math.PI-angle;\n  const radius = 0.3 + Math.sin(angle / 2) * 0.6 * (Math.random() * 0.4 + 0.8);\n  return [\n    Math.round(radius * Math.cos(angle) * 1000) / 1000,\n    Math.round(radius * Math.sin(angle) * 1000) / 1000,\n  ] as [number, number]\n}\n\nexport function randomC(param: string): ControlCall {\n  return {\n    type: ControlType.Call,\n    icon: 'Random',\n    onCall: () => ({[param]: getRandomC()}),\n  }\n}","\nexport function isInt(n: number) {\n  return n % 1 === 0;\n}\n","import { Complex, Coeffs } from './types';\nimport { add, powInt, multReal, toPolar, addPolar } from './complex';\nimport * as P from './polar';\nimport { isInt } from './util';\n\n\n/**\n * { exponent: coefficient }\n * can be object \n *  {2: 3, 5: 1} => 3z^2 + z^5\n * or array\n *  [1, 0, -3, 5] => z^0 - 3z^2 + 5z^3\n */\n\n\nfunction allAreInts(coeffs: Coeffs): boolean {\n  for (const k in coeffs) {\n    if (!isInt(+k) || +k < 0) return false;\n  }\n  return true;\n}\n\n\nexport default function(coeffs: Coeffs): (z: Complex) => Complex {\n  if (allAreInts(coeffs)) {\n    return (z: Complex) => {\n      let result: Complex = {re: 0, im: 0};\n      for (const k in coeffs) {\n        result = add(result, multReal(powInt(z, +k), coeffs[k]))\n      }\n      return result\n    }\n  } else {\n    return (z: Complex) => {\n      const p = toPolar(z);\n      let result: Complex = {re: 0, im: 0};\n      for (const k in coeffs) {\n        result = addPolar(result, P.multReal(P.powReal(p, +k), coeffs[k]))\n      }\n      return result\n    }\n  } \n}","// Fractal-specific functions\nimport { Complex } from './types';\nimport {\n  complex,\n  abs2,\n  add,\n  mult,\n  multReal,\n  powN,\n} from './complex';\nimport * as Math from './real';\n\n\n\n// Burning Ship\n\nconst BS = (z: Complex) => complex(Math.abs(z.re), Math.abs(z.im))\n\nexport function burningship(k: number=1, c?: [number,number]): (z: Complex) => Complex {\n  if (c) {\n    const bs = burningship(k);\n    const cc = complex(c[0], c[1])\n    return (z: Complex) => add(bs(z), cc)\n  }\n  if (k === 1) return BS\n  else {\n    const p = powN(k)\n    return (z: Complex) => p(complex(Math.abs(z.re), Math.abs(z.im)))\n  }\n}\n\n\n// Mandelbox\n\nexport function mandelboxA(v: number=1) {\n  const w = v*2;\n  const f = (n: number) =>  {\n    if (n > v) return w - n;\n    else if (n < -v) return -w - n;\n    else return n;\n  }\n  return (z: Complex) => complex(f(z.re), f(z.im));\n}\n\nexport function mandelboxB(v: number=2) {\n  const v2 = v*v;\n  const recip = 1/v2;\n  return (z: Complex) => {\n    const ab2 = abs2(z);\n    if (ab2 < recip) {\n      return multReal(z, v2)\n    } else if (ab2 < 1) {\n      return multReal(z, 1/ab2)\n    } else {\n      return z\n    }\n  }\n}\n\nexport function mandelbox(a: number=1, b: number=2, c: number=2) {\n  const aa = a*2;\n  const f1 = (n: number) =>  {\n    if (n > a) return aa - n;\n    else if (n < -a) return -aa - n;\n    else return n;\n  }\n  const b2 = b*b;\n  const recip = 1/b2;\n  const f2 = (z: Complex) => {\n    const ab2 = abs2(z);\n    if (ab2 < recip) {\n      return multReal(z, c*b2)\n    } else if (ab2 < 1) {\n      return multReal(z, c/ab2)\n    } else {\n      return multReal(z, c)\n    }\n  }\n  return (z: Complex) => f2(complex(f1(z.re), f1(z.im)));\n}\n\n\n// Phoenix\n\n\nexport function lookback(f: (z: Complex, zprev: Complex) => Complex, z0: Complex=complex(0,0)) {\n  let zp = z0;\n  return (z: Complex) => {\n    const z1 = f(z, zp)\n    zp = z;\n    return z1;\n  }\n}\n\n\nexport function phoenix(p: number | Complex=-0.5, k: number=2, c?: Complex) {\n  const po = powN(k)\n  const multiplier =\n    typeof p === 'number'\n    ? (zz: Complex) => multReal(zz, p)\n    : (zz: Complex) => mult(zz, p);\n  if (c) {\n    return (z: Complex, zp: Complex) => add(add(po(z), c), multiplier(zp));\n  } else {\n    return (z: Complex, zp: Complex) => add(po(z), multiplier(zp));\n  }\n}","import { Complex, ControlType, ControlProps } from './types';\nimport * as mix from './mixers';\nimport {\n  complex,\n  add,\n  multReal,\n  powInt,\n  powFloat,\n} from '../math/complex';\nimport { R as Math } from '../math';\nimport { mandelbox } from '../math/fractals';\nimport { isInt } from '../math/util';\nimport { num } from '../formatting'\nimport { MandelboxParams } from './mandelbox';\nimport * as ctrl from './mixers/controls';\n\n\nexport interface BurningShipParams { k: number }\n\nfunction absabs(z: Complex) {\n  return {re: Math.abs(z.re), im: Math.abs(z.im)};\n}\n\nconst BurningShip = mix.escape<BurningShipParams>({\n  label: 'Burning Ship',\n  latexF: ({k}) => `\\\\left(|Re(z)|+|Im(z)|\\\\right)^{${num(k)}}+x-yi`,\n  f: ({k}) => {\n    if (isInt(k)) {\n      return (c: Complex) => {\n        const cc = {re: c.re, im: -c.im}\n        return (z: Complex) => add(powInt(absabs(z), k), cc);\n      }\n    } else {\n      return (c: Complex) => {\n        const cc = {re: c.re, im: -c.im}\n        return (z: Complex) => add(powFloat(absabs(z), k), cc);\n      }\n    }\n  },\n  newParams: () => ({k: 2}),\n  controls: [\n    {\n      type: ControlType.Number,\n      label: 'exponent (k)',\n      param: 'k',\n      step: 0.1,\n      min: 0,\n    }\n  ] as ControlProps[],\n})\n\n\n\n\ninterface BurningShipBoxParams extends BurningShipParams, MandelboxParams {}\n\nconst BurningShipMandelbox = mix.escape<BurningShipBoxParams>({\n  label: 'Burning Ship (Mandelbox Remix)',\n  \n  f: ({box1, box2, box3, k}) => {\n    const pow = isInt(k) && k > 0 ? powInt : powFloat\n    const mbox = mandelbox(box1, box2, box3);\n    return (x: Complex) => (z: Complex) => {\n      let z1 = multReal(pow(complex(Math.abs(z.re), -Math.abs(z.im)), k), 1/box3);\n      return add(mbox(z1), x);\n    }\n  },\n\n  z0: 0,\n\n  describe: ({box1, box2, box3, k, bail, iter}) => [\n    'This follows the same algorithm as the Mandelbox fractal, but first applies the function ',\n    {\n      math: `z \\\\mapsto \\\\left(|Re(z)|-|Im(z)|\\\\right)^{${num(k)}} \\\\div ${num(box3)}`,\n      displayMode: true,\n    }\n  ],\n\n  newParams: () => ({box1: 1, box2: 2, box3: 2.2, k: 2, bail: 50}),\n\n  controls: [\n    {\n      type: ControlType.Call,\n      icon: 'Random',\n      onCall: () => ({box3: Math.round(Math.random() * 100)/100 + 0.5})\n    },\n    ...['box1', 'box2', 'box3'].map(p => ctrl.number(p, {step:0.1})),\n    ctrl.number('k', {step: 0.1, min: 0}),\n    ctrl.number('bail', {step: 5, min: 0}),\n  ],\n});\n\nexport {\n  BurningShip,\n  BurningShipMandelbox,\n}","import { Complex } from './types';\nimport {controls, julia} from './mixers';\nimport {\n  complex,\n  add,\n  powReal,\n  exp,\n  sqrt,\n  sinh,\n} from '../math/complex';\nimport { burningship } from '../math/fractals';\nimport polynomial from '../math/polynomial';\nimport * as fmt from '../formatting'\n\n\ninterface JuliaParams {\n  k: number\n  c: [number, number]\n}\n\nexport type JPoly = {\n  a: number,\n  b: number,\n  m: number,\n  n: number,\n  c: [number,number],\n}\n\nconst Julia2Term = julia<JPoly>({\n  label: {math: 'az^m+bz^n+c'},\n\n  f: ({a, b, c, m, n}) => {\n    const poly = polynomial({[m]: a, [n]: b});\n    const cc = complex(c[0], c[1]);\n    return (z: Complex) => add(poly(z), cc);\n  },\n\n  latexF: ({a, b, c, m, n}) => {\n    return (\n      `${fmt.num(a)}z^{${fmt.num(m)}}`\n      + `${fmt.num(b,{sign:true})}z^{${fmt.num(n)}}`\n      + `${fmt.complex(c,{sign:true})}`\n    )\n  },\n\n  newParams: () => ({\n    a: -5, m: -2,\n    b: 1, n: 1,\n    c: [-0.5,0.5] as [number,number],\n  }),\n\n  controls: [\n    controls.complex('c'),\n    ...['a', 'm', 'b', 'n'].map(p => controls.number(p, {step: p === 'a' || p === 'b' ? 1 : 0.1})),\n  ],\n})\n\n\nconst JuliaExp = julia<JuliaParams>({\n  label: {math: 'e^{z^k}+c'},\n\n  newParams: () => ({k: 3, c: [-0.6,0]}),\n\n  latexF: ({k,c}: JuliaParams) => `e^{z^{${fmt.num(k)}}}${fmt.complex(c,{sign:true})}`,\n\n  f: ({k,c}: JuliaParams) => {\n    const cc = complex(c[0], c[1]);\n    return (z: Complex) => add(exp(powReal(z, k)), cc);\n  },\n\n  controls: [\n    controls.randomC('c'),\n    controls.complex('c'),\n    controls.number('k', {step: 0.5}),\n    controls.number('bail', {min: 0, step: 1}),\n  ]\n})\n\n\n\nconst JuliaSinh = julia<JuliaParams>({\n  label: {math: '\\\\sqrt{\\\\sinh(z^{k})}+c'},\n\n  newParams: () => ({k: 2, c: [0.06, 0.12]}),\n\n  latexF: ({k,c}: JuliaParams) => `\\\\sqrt{\\\\sinh(z^{${fmt.num(k)}})}${fmt.complex(c,{sign:true})}`,\n\n  f: ({k,c}: JuliaParams) => {\n    const cc = complex(c[0], c[1]);\n    return (z: Complex) => add(sqrt(sinh(powReal(z, k))), cc);\n  },\n\n  controls: [\n    controls.randomC('c'),\n    controls.complex('c'),\n    controls.number('k', {step: 0.5}),\n    controls.number('bail', {min: 0, step: 1}),\n  ]\n})\n\n\nconst JuliaBurningShip = julia<JuliaParams>({\n  label: 'Burning Ship',\n\n  newParams: () => ({k: 2, c: [-0.52, -1.1]}),\n\n  f: ({k, c}: JuliaParams) => {\n    const cc = complex(c[0], c[1])\n    const bs = burningship(k);\n    return (z: Complex) => add(bs(z), cc)\n  },\n\n  latexF: ({k,c}: JuliaParams) => `(|Re(z)|+|Im(z)|)^{${fmt.num(k)}}${fmt.complex(c,{sign:true})}`,\n\n  controls: [\n    controls.randomC('c'),\n    controls.complex('c'),\n    controls.number('k', {step: 0.5}),\n  ]\n\n});\n\nJuliaBurningShip.label = 'Burning Ship Julia'\n\n\nexport {\n  Julia2Term,\n  JuliaBurningShip,\n  JuliaExp,\n  JuliaSinh,\n}\n","import { Complex, ControlType } from './types';\nimport * as mix from './mixers';\nimport {\n  add,\n  powInt,\n  powFloat,\n  multReal,\n  addReal,\n  div,\n  mult,\n} from '../math/complex';\nimport { isInt } from '../math/util';\nimport * as fmt from '../formatting'\n\n\n\nexport interface MagnetParams {\n  k: number,\n}\n\nconst Magnet1 = mix.escape({\n  label: 'Magnet Type I',\n\n  f: ({k}: MagnetParams) => {\n    const pow = isInt(k) && k > 0 ? powInt : powFloat\n    return (c: Complex) => {\n      //const c = complex(x, y);\n      const a = addReal(c, -1);\n      const b = addReal(c, -2);\n      return (z: Complex) => pow(div(\n        add(powInt(z, 2), a),\n        add(multReal(z, 2), b)\n      ), k)\n    }\n  },\n\n  latexF: ({k}: MagnetParams) => '\\\\left(\\\\frac{z^2 + x+yi - 1}{2z + x+yi - 2}\\\\right)^{' + fmt.num(k) + '}',\n\n  newParams: () => ({k: 2}),\n\n  controls: [\n    {\n      type: ControlType.Number,\n      param: 'k',\n      label: 'exponent',\n      step: 0.5,\n    },\n    {\n      type: ControlType.Number,\n      param: 'bail',\n      label: 'bail',\n      step: 5,\n      min: 0,\n    },\n  ],\n})\n\nexport interface Magnet2Params {k: number}\n\nconst Magnet2 = mix.escape({\n  label: 'Magnet Type II',\n\n  newParams: () => ({k: 2}),\n\n  f: ({k}: Magnet2Params) => {\n    const pow = isInt(k) && k > 0 ? powInt : powFloat\n    return (c: Complex) => {\n      //const c = complex(x, y);\n      const a = addReal(c, -1);\n      const b = addReal(c, -2);\n      const a3 = multReal(a, 3);\n      const b3 = multReal(b, 3);\n      const ab = mult(a, b)\n      return (z: Complex) => pow(div(\n        add(add(powInt(z, 3), mult(a3, z)), ab),\n        add(add(multReal(powInt(z, 2), 3), mult(b3, z)), addReal(ab, 1))\n      ), k)\n    }\n  },\n\n  latexF: ({k}: Magnet2Params) => ('\\\\left(\\\\frac' \n  + '{z^3 + 3(x+yi-1)z + (x+yi-1)(x+yi-2)}' \n  + '{3z^2 + 3(x+yi-2)z + (x+yi-1)(x+yi-2) + 1}' \n  + '\\\\right)^{' + fmt.num(k) + '}'\n  ),\n\n  controls: [\n    {\n      type: ControlType.Number,\n      param: 'k',\n      label: 'exponent',\n      step: 0.5,\n    },\n    {\n      type: ControlType.Number,\n      param: 'bail',\n      label: 'bail',\n      step: 5,\n      min: 0,\n    },\n  ]\n})\n\n\nexport { Magnet1, Magnet2 }","import { FractalInterface, ControlType, ControlProps } from './types';\nimport { DefaultEscapeParams, describeEscapeFunction } from './mixers/escape';\nimport * as mix from './mixers';\nimport { R as Math } from '../math';\nimport * as fmt from '../formatting';\n\nfunction randomParams() {\n  return {box3: Math.round(Math.random() * 20)/10 + 2}\n}\n\nconst mandelboxFlatex = (v: number) => (\n  '\\\\left\\\\{\\\\begin{aligned}'\n  + `${fmt.num(2*v)} - n &, \\\\text{ if \\$n > ${fmt.num(v)}\\$}\\\\\\\\`\n  + `${fmt.num(-2*v)} - n &, \\\\text{ if \\$n < ${fmt.num(-v)}\\$}\\\\\\\\`\n  + 'n &, \\\\text{ otherwise}'\n  + '\\\\end{aligned}\\\\right.'\n);\n\nconst mandelboxAlatex = 'f(Re(z))+f(Im(z))i';\n\nconst mandelboxBlatex = (v: number) => (\n  '\\\\left\\\\{\\\\begin{aligned}'\n  + `${fmt.num(2*v)}z &, \\\\text{ if \\$|z|<${fmt.num(1/v)}\\$}\\\\\\\\`\n  + `z \\\\div |z|^2 &, \\\\text{ if \\$${fmt.num(1/v)} \\\\leq |z| < 1\\$}\\\\\\\\`\n  + 'z &, \\\\text{ otherwise}\\\\\\\\'\n  + '\\\\end{aligned}\\\\right.'\n)\n\nconst mandelboxClatex = (v: number) => fmt.num(v) + '\\\\cdot B(A(z)) + x + yi';\n\n\nexport function describeMandelbox(a: number, b: number, c: number, bail: number, iter: number) {\n  return [\n    {\n      math: 'f_{\\\\mathbb{R}\\\\mapsto\\\\mathbb{R}}(n) =' + mandelboxFlatex(a),\n      displayMode: true,\n    },\n    {\n      math: 'A_{\\\\mathbb{C}\\\\mapsto\\\\mathbb{C}}(z) =' + mandelboxAlatex,\n      displayMode: true,\n    },\n    {\n      math: 'B_{\\\\mathbb{C}\\\\mapsto\\\\mathbb{C}}(z) =' + mandelboxBlatex(b),\n      displayMode: true,\n    },\n    ...describeEscapeFunction(\n      mandelboxClatex(c),\n      '0',\n      bail,\n      iter,\n    )\n  ]\n}\n\n\nconst MandelboxRandom = ({\n  type: ControlType.Call,\n  icon: 'Random',\n  onCall: () => randomParams(),\n}) as ControlProps\n\n\nexport interface MandelboxParams {\n  box1: number,\n  box2: number,\n  box3: number,\n}\n\nexport const FastMandelbox: FractalInterface<{\n  box1: number\n  box2: number\n  box3: number\n  iter: number\n  bail: number\n}> = {\n  label: 'Mandelbox *',\n  newParams: () => ({box1: 1, box2: 2, box3: 2, ...DefaultEscapeParams}),\n  range: ({iter}) => [0,iter],\n  controls: [\n    MandelboxRandom,\n    mix.controls.number('box1', {step: 0.1}),\n    mix.controls.number('box2', {step: 0.1}),\n    mix.controls.number('box3', {step: 0.1}),\n    mix.controls.number('iter', {min: 0, step: 2}),\n    mix.controls.number('bail', {min: 0, step: 1}),\n  ],\n  describe: ({box1, box2, box3, iter, bail}) => describeMandelbox(box1, box2, box3, bail, iter),\n  calc: ({box1, box2, box3, iter, bail}) => {\n    const box1a = box1*2;\n    const box2a = box2*box2;\n    const box2b = 1/box2a;\n    const b2 = bail*bail;\n    const ma = box3*box2a;\n    const f1 = (n: number) =>  {\n      if (n > box1) return box1a - n;\n      else if (n < -box1) return -box1a - n;\n      else return n;\n    }\n    return (x0: number, y0: number) => {\n      let x = 0, y = 0;\n      let x2 = 0, y2 = 0;\n      let i = 0;\n      while (x2 + y2 < b2 && i < iter) {\n        x = f1(x);\n        y = f1(y);\n        const abso2 = x*x + y*y;\n        if (abso2 < box2b) {\n          x *= ma\n          y *= ma\n        } else if (abso2 < 1) {\n          x *= box3/abso2;\n          y *= box3/abso2;\n        } else {\n          x *= box3;\n          y *= box3;\n        }\n        x += x0;\n        y += y0;\n        x2 = x*x;\n        y2 = y*y;\n        i += 1;\n      }\n      return i;\n    }\n  }\n}\n\n\nexport const FastMandelcorner: FractalInterface<{\n  box1: number\n  box2: number\n  box3: number\n  iter: number\n  bail: number\n}> = {\n  label: 'Mandelcorner *',\n  newParams: () => ({box1: 1, box2: 2, box3: 2, ...DefaultEscapeParams}),\n  range: ({iter}) => [0,iter],\n  controls: [\n    MandelboxRandom,\n    mix.controls.number('box1', {step: 0.1}),\n    mix.controls.number('box2', {step: 0.1}),\n    mix.controls.number('box3', {step: 0.1}),\n    mix.controls.number('iter', {min: 0, step: 2}),\n    mix.controls.number('bail', {min: 0, step: 1}),\n  ],\n  describe: ({box1, box2, box3}) =>  ['Mandelbox(' + [box1, box2, box3].map(v => fmt.num(v)).join(',') + ') -> Burning Ship'],\n  calc: ({box1, box2, box3, iter, bail}) => {\n    const box1a = box1*2;\n    const box2a = box2*box2;\n    const box2b = 1/box2a;\n    const b2 = bail*bail;\n    const ma = box3*box2a;\n    const f1 = (n: number) =>  {\n      if (n > box1) return box1a - n;\n      else if (n < -box1) return -box1a - n;\n      else return n;\n    }\n    return (x0: number, y0: number) => {\n      let x = 0, y = 0;\n      let x2 = 0, y2 = 0;\n      let i = 0;\n      while (x2 + y2 < b2 && i < iter) {\n        x = f1(x);\n        y = f1(y);\n        const abso2 = x*x + y*y;\n        if (abso2 < box2b) {\n          x *= ma\n          y *= ma\n        } else if (abso2 < 1) {\n          x *= box3/abso2;\n          y *= box3/abso2;\n        } else {\n          x *= box3;\n          y *= box3;\n        }\n        x = Math.abs(x) + x0;\n        y = Math.abs(y) + y0;\n        x2 = x*x;\n        y2 = y*y;\n        i += 1;\n      }\n      return i;\n    }\n  }\n}","import { Complex } from './types';\nimport * as mix from './mixers';\nimport {\n  add,\n  complex,\n  powInt,\n  powN,\n  powFloat,\n} from '../math/complex';\nimport { isInt } from '../math/util';\nimport * as fmt from '../formatting'\n\n\n\nexport interface MandelbrotParams { k: number }\n\nexport const Mandelbrot = mix.escape({\n  label: ['Mandelbrot (', {math: 'z^k+c'},')'],\n  latexF: (p: MandelbrotParams) => `z^{${fmt.num(p.k)}}+x+yi`,\n  f: (p: MandelbrotParams) => {\n    const k = p.k;\n    if (isInt(k)) {\n      return (c: Complex) => (z: Complex) => add(powInt(z, k), c);\n    } else {\n      return (c: Complex) => (z: Complex) => add(powFloat(z, k), c);\n    }\n  },\n  newParams: () => ({k: 2}),\n  controls: [\n    mix.controls.number('k', {step: 1, min: 0}),\n  ],\n})\n\nexport const MandelbrotJulia = mix.julia<{\n  c: [number,number],\n  k: number,\n}>({\n  label: ['Mandelbrot (', {math: 'z^k+c'}, ')'],\n\n  f: ({k,c}) => {\n    const cc = complex(c[0], c[1])\n    const p = powN(k)\n    return (z: Complex) => add(p(z), cc);    \n  },\n\n  latexF: ({k,c}) => `z^{${fmt.num(k)}}${fmt.complex(c,{sign:true})}`,\n\n  newParams: () => ({k: 2, c: mix.controls.getRandomC()}),\n\n  controls: [\n    mix.controls.randomC('c'),\n    mix.controls.complex('c'),\n    mix.controls.number('k', {step: 0.5}),\n    mix.controls.number('bail', {step: 1, min: 0}),\n  ],\n});\n\nMandelbrotJulia.label = ['Mandelbrot Julia (', {math: 'z^k+c'}, ')'];","import { Complex } from './types';\nimport * as mix from './mixers';\nimport {\n  complex,\n} from '../math/complex';\nimport * as fmt from '../formatting'\nimport { burningship, phoenix, lookback } from '../math/fractals';\n\n\ninterface PhoenixParams {\n  p: [number,number]\n  k: number\n}\n\nconst Phoenix = mix.escape<PhoenixParams>({\n  label: 'Phoenix',\n\n  newParams: () => ({p: [-0.5, 0], k: 2}),\n\n  f: ({p, k}) => {\n    const pp = complex(p[0], p[1])\n    return (c: Complex) => lookback(phoenix(pp, k, c))\n  },\n\n  z0: 0,\n\n  latexZ0: 0,\n\n  latexF: ({p, k}) => `z_{n}^{${fmt.num(k)}}+(${fmt.complex(p)})z_{n-1}+x+yi`,\n\n  controls: [\n    mix.controls.complex('p'),\n    mix.controls.number('k', {step: 0.5}),\n  ]\n})\n\n\ninterface PhoenixJuliaParams extends PhoenixParams {\n  c: [number,number]\n}\n\nconst PhoenixJulia = mix.escape<PhoenixJuliaParams>({\n  label: \"Phoenix Julia\",\n\n  newParams: () => ({p: [-0.5,0], k: 2, c: [0.5667,0], iter: 40}),\n\n  f: ({p, k, c}) => {\n    const pp = complex(p[0], p[1])\n    const cc = complex(c[0], c[1])\n    return (_:Complex) => lookback(phoenix(pp, k, cc));\n  },\n\n  z0: () => (c: Complex) => complex(c.im, c.re),\n\n  latexZ0: () => 'y+xi',\n\n  latexF: ({p, k, c}) => {\n    return `z_{n}^{${fmt.num(k)}}+(${fmt.complex(p)})z_{n-1}${fmt.complex(c,{sign:true})}`\n  },\n\n  controls: [\n    mix.controls.complex('c'),\n    mix.controls.complex('p'),\n    mix.controls.number('k', {step: 0.5}),\n  ]\n})\n\n\n\nconst PhoenixJuliaBurningShip = mix.escape<PhoenixJuliaParams>({\n  label: \"Phoenix Julia/Burning Ship\",\n\n  newParams: () => ({p: [-0.5,0], k: 2, c: [0.6,0]}),\n\n  f: ({p, k, c}: PhoenixJuliaParams) => {\n    const pp = complex(p[0], p[1])\n    const cc = complex(c[0], c[1])\n    const bs = burningship(k)\n    const px = phoenix(pp, 1, cc);\n    const f = (z: Complex, zp: Complex) => px(bs(z), zp)\n    return (_: Complex) => lookback(f);\n  },\n\n  z0: () => (c: Complex) => complex(c.im, c.re),\n\n  latexZ0: () => 'y+xi',\n\n  latexF: ({p, k, c}: PhoenixJuliaParams) => {\n    return `\\\\left(|Re(z_{n})|+|Im(z_{n})|\\\\right)^{${fmt.num(k)}}+(${fmt.complex(p)})z_{n-1}${fmt.complex(c,{sign:true})}`\n  },\n\n  controls: [\n    mix.controls.complex('c'),\n    mix.controls.complex('p'),\n    mix.controls.number('k', {step: 0.5}),\n  ]\n})\n\n\nexport {\n  Phoenix,\n  PhoenixJulia,\n  PhoenixJuliaBurningShip,\n}","import { Complex, ControlType, FractalInterface } from './types';\nimport { EscapeParams, describeEscapeFunction } from './mixers/escape';\nimport { BurningShipParams } from './burningship';\nimport { MandelboxParams } from './mandelbox';\nimport * as mix from './mixers';\nimport {\n  complex,\n  add,\n  exp,\n  mult,\n  multReal,\n  abs2,\n  powInt,\n  powFloat,\n  powReal,\n} from '../math/complex';\nimport { R as Math } from '../math';\nimport { isInt } from '../math/util';\nimport * as fmt from '../formatting'\nimport { burningship, mandelbox, phoenix, lookback } from '../math/fractals';\nimport * as ctrl from './mixers/controls';\n\n\n\n\ninterface ExpoParams {\n  k: number\n}\n\nexport const Exponential = mix.escape<ExpoParams>({\n  label: {math: 'e^{z^k}+c'},\n\n  newParams: () => ({k: 3}),\n\n  latexF: ({k}: ExpoParams) => `e^{z^{${fmt.num(k)}}}+x+yi`,\n\n  f: ({k}: ExpoParams) => (c: Complex) => {\n    return (z: Complex) => add(exp(powReal(z, k)), c);\n  },\n\n  controls: [\n    {\n      type: ControlType.Number,\n      label: 'k',\n      param: 'k',\n      step: 0.5,\n    },\n    {\n      type: ControlType.Number,\n      label: 'bail',\n      param: 'bail',\n      min: 0,\n      step: 1,\n    },\n  ]\n})\n\n\ninterface P {\n  m1: number\n  m2: number\n  m3: number\n  k: number\n  p: [number, number]\n  c: [number, number]\n}\n\nexport const Test1 = mix.escape<P>({\n  label: 'Test',\n\n  newParams: () => ({p: [0.5,0], k: 2, m1: 2, m2: 2, m3: 2, c: [0.001, 0]}),\n\n  f: ({p, k, m1, m2, m3, c}) => {\n    const pp = complex(p[0], p[1])\n    const cc = complex(c[0], c[1])\n    const bs = burningship(k)\n    const bx = mandelbox(m1, m2, m3)\n    const px = phoenix(pp, 1, cc)\n    const f = (z: Complex, zp: Complex) => bx(px(bs(z), zp))\n    return (_: Complex) => lookback(f)\n  },\n\n  z0: () => (c: Complex) => c,\n\n  describe: () => [''],\n\n  controls: [\n    ctrl.complex('c'),\n    ctrl.number('k', {step: 0.5}),\n    ctrl.complex('p'),\n    ctrl.number('m1', {step: 0.1}),\n    ctrl.number('m2', {step: 0.5}),\n    ctrl.number('m3', {step: 0.1}),\n\n  ]\n})\n\n\n/*\nconst Accident = {\n  calc: ({c,iter,bail}) => {\n    const [cx,cy] = c;\n    const b2 = bail*bail;\n    return (x: number, y: number) => {\n      let i = 0;\n      let x2 = x*x, y2 = y*y;\n      while (x2+y2 < b2 && i < iter) {\n        y = 2 * x + y + cy;\n        x = x2 - y2 + cx;\n        x2 = x*x;\n        y2 = y*y;\n        i += 1;\n      }\n      return i;\n    }\n  }\n}\n*/","import { FractalInterface } from './types';\nimport { controls } from './mixers'\nimport { describeEscapeFunction, DefaultEscapeParams } from './mixers/escape';\nimport * as fmt from '../formatting';\n\nexport const FastBurningShip: FractalInterface<{iter: number, bail: number}> = {\n  label: 'Burning Ship *',\n  range: ({iter}) => [0, iter],\n  newParams: () => ({...DefaultEscapeParams}),\n  controls: [\n    controls.number('bail', {step: 1, min: 0}),\n    controls.number('iter', {min: 1, step: 2}),\n  ],\n  describe: ({iter, bail}) => describeEscapeFunction(\n    '\\\\(|Re(z)|+|Im(z)|\\\\right)^2+x-yi', \n    '0', \n    bail, \n    iter,\n  ),\n  calc: ({iter, bail}) => (x0: number, y0: number) => {\n    let x = 0;\n    let y = 0;\n    let x2 = 0;\n    let y2 = 0;\n    let i = 0;\n    let b2 = bail * bail;\n    while (x2 + y2 < b2 && i < iter) {\n      y = 2 * Math.abs(x * y) - y0;\n      x = x2 - y2 + x0;\n      x2 = x*x;\n      y2 = y*y;\n      i += 1;\n    }\n    return i\n  },\n}\n\nexport const FastBurningShipMandelbox: FractalInterface<{\n  box1: number\n  box2: number\n  box3: number\n  iter: number\n  bail: number\n}> = {\n  label: 'Burning Ship (Mandelbox Remix) *',\n  newParams: () => ({...DefaultEscapeParams, bail: 50, box1: 1, box2: 2, box3: 2.2}),\n  range: ({iter}) => [0,iter],\n  controls: [\n    controls.number('box1', {step: 0.1}),\n    controls.number('box2', {step: 0.1}),\n    controls.number('box3', {step: 0.1}),\n    controls.number('iter', {step: 2, min: 0}),\n    controls.number('bail', {step: 1, min: 0}),\n  ],\n  describe: ({box1, box2, box3, bail, iter}) => [\n    'This follows the same algorithm as the Mandelbox fractal, but first applies the function ',\n    {\n      math: `z \\\\mapsto \\\\left(|Re(z)|-|Im(z)|\\\\right)^{2} \\\\div ${fmt.num(box3)}`,\n      displayMode: true,\n    }\n  ],\n  calc: ({box1, box2, box3, bail, iter}) => {\n    const box1a = box1*2;\n    const box2a = box2*box2;\n    const box2b = 1/box2a;\n    const b2 = bail*bail;\n    const ma = box3*box2a;\n    const box3a = 1/box3;\n    const f1 = (n: number) =>  {\n      if (n > box1) return box1a - n;\n      else if (n < -box1) return -box1a - n;\n      else return n;\n    }\n    return (x0: number, y0: number) => {\n      let x = 0, y = 0;\n      let x2 = 0, y2 = 0;\n      let i = 0;\n      while (x2 + y2 < b2 && i < iter) {\n        y = f1(-2 * Math.abs(x*y) * box3a);\n        x = f1((x2 - y2) * box3a);\n        const abso2 = x*x + y*y;\n        if (abso2 < box2b) {\n          x *= ma\n          y *= ma\n        } else if (abso2 < 1) {\n          x *= box3/abso2;\n          y *= box3/abso2;\n        } else {\n          x *= box3;\n          y *= box3;\n        }\n        x += x0;\n        y += y0;\n        x2 = x*x;\n        y2 = y*y;\n        i += 1;\n      }\n      return i;\n    }\n  }\n}\n\nexport const FastJuliaMandelbrot: FractalInterface<{\n  c: [number,number],\n  iter: number,\n  bail: number,\n}> = {\n  label: ['Mandelbrot Julia (', {math: 'z^2+c'}, ') *'],\n  newParams: () => ({c: controls.getRandomC(), ...DefaultEscapeParams}),\n  range: ({iter}) => [0,iter],\n  controls: [\n    controls.randomC('c'),\n    controls.complex('c'),\n    controls.number('iter', {min: 1, step: 2}),\n  ],\n  describe: ({c,iter,bail}) => describeEscapeFunction(\n    `z^{2}${fmt.complex(c,{sign:true})}`,\n    fmt.complex(c),\n    bail,\n    iter,\n  ),\n  calc: ({c,iter,bail}) => {\n    const [cx,cy] = c;\n    const b2 = bail*bail;\n    return (x: number, y: number) => {\n      let i = 0;\n      let x2 = x*x, y2 = y*y;\n      while (x2+y2 < b2 && i < iter) {\n        y = 2 * x * y + cy;\n        x = x2 - y2 + cx;\n        x2 = x*x;\n        y2 = y*y;\n        i += 1;\n      }\n      return i;\n    }\n  }\n}\n\n\nexport const FastMandelbrot: FractalInterface<{\n  iter: number,\n  bail: number,\n}> = {\n  label: ['Mandelbrot (', {math: 'z^2+c'},') *'],\n  newParams: () => ({...DefaultEscapeParams}),\n  range: ({iter}) => [0,iter],\n  controls: [\n    controls.number('iter', {min: 1, step: 2}),\n  ],\n  describe: ({iter,bail}) => describeEscapeFunction(\n    `z^{2}+x+yi`,\n    '0',\n    bail,\n    iter,\n  ),\n  calc: ({iter,bail}) => {\n    const b2 = bail*bail;\n    return (x0: number, y0: number) => {\n      let i = 0;\n      let x = 0, y = 0;\n      let x2 = 0, y2 = 0;\n      while (x2+y2 < b2 && i < iter) {\n        y = 2 * x * y + y0;\n        x = x2 - y2 + x0;\n        x2 = x*x;\n        y2 = y*y;\n        i += 1;\n      }\n      return i;\n    }\n  }\n}\n\n\nexport const FastPhoenix: FractalInterface<{\n  p: [number,number],\n  bail: number,\n  iter: number\n}> = {\n  label: 'Phoenix *',\n  newParams: () => ({p: [-0.5,0], ...DefaultEscapeParams}),\n  range: ({iter}) => [0,iter],\n  controls: [\n    controls.complex('p'),\n    controls.number('bail', {step: 1, min: 0}),\n    controls.number('iter', {min: 1, step: 2}),\n  ],\n  describe: ({p,iter,bail}) => describeEscapeFunction(\n    `z^{2}+(${fmt.complex(p)})z_{n-1}+x+yi`,\n    '0',\n    bail,\n    iter,\n  ),\n  calc: ({p,bail,iter}) => {\n    const [px, py] = p;\n    const b2 = bail*bail;\n    return (x0: number, y0: number) => {\n      let x = x0, y = y0;\n      let x_ = 0, y_ = 0;\n      let x2 = x*x, y2 = y*y;\n      let i = 0;\n      while (x2 + y2 < b2 && i < iter) {\n        const xn = x2 - y2 + x0 + px*x_ - py*y_;\n        const yn = 2 * x * y + y0 + px*y_ + py*x_;\n        x_ = x;\n        y_ = y;\n        y = yn;\n        x = xn;\n        x2 = x*x;\n        y2 = y*y;\n        i += 1;\n      }\n      return i;\n    }\n  },\n}\n\nexport const FastPhoenixJulia: FractalInterface<{\n  p: [number,number],\n  c: [number,number],\n  bail: number,\n  iter: number\n}> = {\n  label: 'Phoenix Julia *',\n  newParams: () => ({p: [-0.5,0], c: [0.6,0], ...DefaultEscapeParams}),\n  range: ({iter}) => [0,iter],\n  controls: [\n    controls.complex('p'),\n    controls.complex('c'),\n    controls.number('bail', {step: 1, min: 0}),\n    controls.number('iter', {min: 1, step: 2}),\n  ],\n  describe: ({p,c,iter,bail}) => describeEscapeFunction(\n    `z^{2}+(${fmt.complex(p)})z_{n-1}${fmt.complex(c,{sign:true})}`,\n    'y+xi',\n    bail,\n    iter,\n  ),\n  calc: ({p,c,bail,iter}) => {\n    const [cx, cy] = c;\n    const [px, py] = p;\n    const b2 = bail*bail;\n    return (y0: number, x0: number) => {\n      let x = x0, y = y0;\n      let x_ = 0, y_ = 0;\n      let x2 = x*x, y2 = y*y;\n      let i = 0;\n      while (x2 + y2 < b2 && i < iter) {\n        const yn = 2 * x * y + cy + px*y_ + py*x_;\n        const xn = x2 - y2 + cx + px*x_ - py*y_;\n        x_ = x;\n        y_ = y;\n        y = yn;\n        x = xn;\n        x2 = x*x;\n        y2 = y*y;\n        i += 1;\n      }\n      return i;\n    }\n  },\n}\n\n\nexport const FastPhoenixBurningShip: FractalInterface<{\n  p: [number,number], \n  bail: number,\n  iter: number,\n}> = {\n  label: 'Phoenix/Burning Ship *',\n  range: ({iter}) => [0,iter],\n  newParams: () => ({p: [-0.5,0], ...DefaultEscapeParams}),\n  controls: [\n    controls.complex('p'),\n    controls.number('bail', {step: 1, min: 0}),\n    controls.number('iter', {min: 1, step: 2}),\n  ],\n  describe: ({p,iter,bail}) => describeEscapeFunction(\n    `\\\\left(|Re(z_{n})|+|Im(z_{n})|\\\\right)^{2}+(${fmt.complex(p)})z_{n-1}+x-yi`,\n    '0',\n    bail,\n    iter,\n  ),\n  calc: ({p,bail,iter}) => {\n    const [px, py] = p;\n    const b2 = bail*bail;\n    return (x0: number, y0: number) => {\n      let x = 0, y = 0;\n      let x_ = 0, y_ = 0;\n      let x2 = x*x, y2 = y*y;\n      let i = 0;\n      while (x2 + y2 < b2 && i < iter) {\n        const yn = 2 * Math.abs(x * y) - y0 + px*y_ + py*x_;\n        const xn = x2 - y2 + x0 + px*x_ - py*y_;\n        x_ = x;\n        y_ = y;\n        y = yn;\n        x = xn;\n        x2 = x*x;\n        y2 = y*y;\n        i += 1;\n      }\n      return i;\n    }\n  },\n}\n\nexport const FastPhoenixJuliaBurningShip: FractalInterface<{\n  p: [number,number], \n  c: [number,number],\n  bail: number,\n  iter: number,\n}> = {\n  label: 'Phoenix Julia/Burning Ship *',\n  range: ({iter}) => [0,iter],\n  newParams: () => ({p: [-0.5,0], c: [0.6,0], ...DefaultEscapeParams}),\n  controls: [\n    controls.complex('p'),\n    controls.complex('c'),\n    controls.number('bail', {step: 1, min: 0}),\n    controls.number('iter', {min: 1, step: 2}),\n  ],\n  describe: ({p,c,iter,bail}) => describeEscapeFunction(\n    `\\\\left(|Re(z_{n})|+|Im(z_{n})|\\\\right)^{2}${fmt.complex(c,{sign:true})}+(${fmt.complex(p)})z_{n-1}`,\n    'y+xi',\n    bail,\n    iter,\n  ),\n  calc: ({p,c,bail,iter}) => {\n    const [cx, cy] = c;\n    const [px, py] = p;\n    const b2 = bail*bail;\n    return (y0: number, x0: number) => {\n      let x = x0, y = y0;\n      let x_ = 0, y_ = 0;\n      let x2 = x*x, y2 = y*y;\n      let i = 0;\n      while (x2 + y2 < b2 && i < iter) {\n        const yn = 2 * Math.abs(x * y) + cy + px*y_ + py*x_;\n        const xn = x2 - y2 + cx + px*x_ - py*y_;\n        x_ = x;\n        y_ = y;\n        y = yn;\n        x = xn;\n        x2 = x*x;\n        y2 = y*y;\n        i += 1;\n      }\n      return i;\n    }\n  },\n}","import { FractalInterface } from './types';\nimport {\n  BurningShip,\n  BurningShipMandelbox,\n} from './burningship';\nimport {\n  Julia2Term,\n  JuliaBurningShip,\n  JuliaExp,\n  JuliaSinh,\n} from './julias';\nimport {\n  Magnet1,\n  Magnet2,\n} from './magnet';\nimport {\n  FastMandelbox,\n  FastMandelcorner,\n} from './mandelbox';\nimport {\n  MandelbrotJulia,\n  Mandelbrot,\n} from './mandelbrot';\nimport {\n  Phoenix,\n  PhoenixJulia,\n  PhoenixJuliaBurningShip,\n} from './phoenix';\nimport {\n  Test1\n} from './testing';\nimport {\n  FastBurningShip,\n  FastBurningShipMandelbox,\n  FastJuliaMandelbrot,\n  FastMandelbrot,\n  FastPhoenixJuliaBurningShip,\n  FastPhoenixBurningShip,\n  FastPhoenixJulia,\n  FastPhoenix,\n} from './fast';\n\nexport const ALLFRACTALS: {[k: string]: FractalInterface<any>} = ({\n  F_Bs: FastBurningShip,\n  F_BsMbx: FastBurningShipMandelbox,\n  Mbx: FastMandelbox,\n  F_Md: FastMandelbrot,\n  F_MdJl: FastJuliaMandelbrot,\n  MbxBs: FastMandelcorner,\n  F_Ph: FastPhoenix,\n  F_PhJl: FastPhoenixJulia,\n  F_PhBs: FastPhoenixBurningShip,\n  F_PhJlBs: FastPhoenixJuliaBurningShip,\n  Bs: BurningShip,\n  BsJl: JuliaBurningShip,\n  BsMbx: BurningShipMandelbox,\n  Jl2: Julia2Term,\n  JlExp: JuliaExp,\n  JlSinh: JuliaSinh,\n  Mg1: Magnet1,\n  Mg2: Magnet2,\n  Md: Mandelbrot,\n  MdJl: MandelbrotJulia,\n  Ph: Phoenix,\n  PhJl: PhoenixJulia,\n  PhJlBs: PhoenixJuliaBurningShip,\n  Test1,\n});","import {\n  UIState,\n  SetStretch,\n  StretchMode,\n  SET_STRETCH,\n  SetModal,\n  SET_MODAL,\n  SetNav,\n  SET_NAV,\n  Modal,\n  Nav,\n  AddColorScheme,\n  ADD_COLOR_SCHEME,\n  ColorScheme,\n  UpdateUI,\n  UPDATE_UI,\n} from './types'\n\nexport const updateUI = (x: Partial<UIState>): UpdateUI => ({\n  type: UPDATE_UI,\n  payload: x\n})\n\nexport const setStretch = (stretch: StretchMode): SetStretch => ({\n  type: SET_STRETCH,\n  payload: stretch\n})\n\nexport const setModal = (modal: Modal): SetModal => ({\n  type: SET_MODAL,\n  payload: modal\n})\n\nexport const setNav = (nav: Nav): SetNav => ({\n  type: SET_NAV,\n  payload: nav\n})\n\nexport const startWaiting = (): UpdateUI => ({\n  type: UPDATE_UI,\n  payload: {waiting: true},\n})\n\nexport const stopWaiting = (): UpdateUI => ({\n  type: UPDATE_UI,\n  payload: {waiting: false}\n})\n\nexport const addColorScheme = (name: string, scheme: ColorScheme): AddColorScheme => ({\n  type: ADD_COLOR_SCHEME,\n  payload: {name, scheme}\n})\n\n\n\n\n","import { JsonState } from '../../fractals/json';\nimport {\n  AddToGallery,\n  ADD_TO_GALLERY,\n  DeleteImage,\n  DELETE_IMAGE,\n  MassAddToGallery,\n  MASS_ADD_TO_GALLERY,\n} from './types';\n\n\nexport const addToGallery = (url: string, data: JsonState, title: string): AddToGallery => ({\n  type: ADD_TO_GALLERY,\n  payload: {url, data, title}\n})\n\nexport const massAddToGallery = (imgs: {url: string, data: JsonState, title: string}[]): MassAddToGallery => ({\n  type: MASS_ADD_TO_GALLERY,\n  payload: imgs\n})\n\nexport const deleteImage = (url: string): DeleteImage => ({\n  type: DELETE_IMAGE,\n  payload: url,\n})\n","export {\n  updateAlgorithm,\n  setAlgorithm,\n  updateParams,\n  updateColor,\n  updateView,\n  recenter,\n  setCenter,\n  zoomIn,\n  zoomOut,\n  redraw,\n  recolor,\n  rotateDeg,\n  capture,\n  finish,\n  uploadData,\n  uploadJson,\n  uploadUrl,\n} from './fractal/actions';\n\nexport {\n  setNav,\n  setModal,\n  setStretch,\n  startWaiting,\n  stopWaiting,\n  updateUI,\n  addColorScheme,\n} from './ui/actions';\n\nexport {\n  addToGallery,\n  massAddToGallery,\n  deleteImage,\n} from './gallery/actions';\n\n\n\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Outer\":\"Canvas_Outer__3GTjf\",\"Canvas\":\"Canvas_Canvas__1ejHE\",\"Stretch\":\"Canvas_Stretch__x2lNh\"};","import { ColorScheme as CS } from '../../../fractals/color/types';\n\nexport const UPDATE_COLOR = 'COLOR_UPDATE';\n\nexport type ColorScheme = CS\n\nexport interface ColorState {\n  schemeName: string\n  scheme: ColorScheme\n  mirror: boolean\n  reverse: boolean\n  skew: number\n  count: number\n}\n\nexport type UpdateColor = {\n  type: typeof UPDATE_COLOR,\n  payload: Partial<ColorState>,\n}\n\nexport type ColorAction = UpdateColor","import {\n  ViewState,\n  ViewAction,\n  UPDATE_VIEW,\n  RECENTER,\n  TRANSFORM,\n  ZOOM_IN,\n  ZOOM_OUT,\n} from './types';\nimport { pixelCount, canvasSize } from '../../../defaults';\nimport { multiply } from '../../../fractals/drawer/transform';\n\nconst initialState: ViewState = {\n  ...canvasSize,\n  cx: 0, \n  cy: 0,\n  ppu: 256,\n  pixelCount,\n  t: [1, 0, 0, -1],\n}\n\nexport function recenterPPU({w, h}: {w: number, h: number}) {\n  return Math.round(Math.min(h,w)/5);\n}\n\nexport default function(state: ViewState={...initialState, ppu: recenterPPU(initialState)}, action: ViewAction) {\n  switch(action.type) {\n    case UPDATE_VIEW:\n      return {...state, ...action.payload};\n    case RECENTER:\n      return {...state, cx: 0, cy: 0, t: [1,0,0,-1], ppu: recenterPPU(state)} as ViewState\n    case TRANSFORM:\n      return {...state, t: multiply(state.t, action.payload)};\n    case ZOOM_IN:\n      return {...state, ppu: state.ppu * action.payload};\n    case ZOOM_OUT:\n      return {...state, ppu: Math.round(state.ppu / action.payload)};\n    default:\n      return state;\n  }\n}"],"sourceRoot":""}